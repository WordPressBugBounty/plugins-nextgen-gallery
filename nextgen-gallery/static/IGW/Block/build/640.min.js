/*! For license information please see 640.min.js.LICENSE.txt */
"use strict";(self.webpackChunk_envira_imagely_admin_app=self.webpackChunk_envira_imagely_admin_app||[]).push([[640],{640:(e,t,n)=>{n.r(t),n.d(t,{default:()=>Ye});var r=n(5458),a=n(3453),l=n(4980),i=n(6106),o=n(7723),c=n(1609),s=n.n(c),u=n(4848);const m=function(e){var t=e.value,n=e.onChange,r=e.onSearch,l=e.placeholder,m=e.dropdownItems,d=(0,c.useState)(!1),g=(0,a.A)(d,2),p=g[0],b=g[1],f=function(){return b(!p)};return s().createElement("div",{className:"relative w-full sm:w-64"},m&&s().createElement(u.m,{isOpen:p,onClose:function(){return b(!1)},onToggle:f,trigger:s().createElement("button",{type:"button",className:"h-full px-3 flex items-center border-r border-input-border",onClick:f},s().createElement(i.D3,{className:"h-4 w-4"})),className:"absolute left-0 top-full mt-1 bg-white border border-input-border rounded-md shadow-lg z-50"},m),s().createElement("span",{className:"pointer-events-none absolute inset-y-0 left-3 flex items-center text-gray-400"},s().createElement(i.WI,{className:"w-5 h-5"})),s().createElement("input",{type:"text",value:t,onChange:function(e){return n(e.target.value)},onKeyDown:function(e){"Enter"===e.key&&r&&r()},placeholder:l||(0,o.__)("Search","nggallery"),className:"w-full border border-input-border rounded-md pl-10 pr-3 py-2 text-sm text-gray-700 placeholder:text-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500"}))};function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach(function(t){(0,l.A)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}const p=function(e){var t=e.title,n=e.searchTerm,r=e.setSearchTerm,d=e.onSearch,p=e.visibleColumns,b=e.setVisibleColumns,f=e.selectedItems,y=e.items,_=e.columns,h=e.searchPlaceholder,v=e.onDelete,x=e.onSetWatermark,E=e.onCreateThumbnails,w=e.onResizeImages,N=e.onImportMetadata,C=e.onRecoverFromBackup,k=(0,c.useState)(!1),A=(0,a.A)(k,2),S=A[0],O=A[1],T=(0,c.useState)(!1),j=(0,a.A)(T,2),P=j[0],I=j[1];(0,c.useEffect)(function(){0===f.size&&O(!1)},[f.size]);var F,D=function(){O(!1)};return s().createElement("div",{className:"bg-white rounded-t-lg shadow-sm p-3 sm:p-4"},s().createElement("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},t&&s().createElement("div",{className:"flex-shrink-0"},s().createElement("h2",{className:"text-lg font-semibold text-gray-900"},t)),s().createElement("div",{className:"flex items-center gap-2 sm:gap-3 flex-wrap sm:ml-auto"},f.size>0&&s().createElement(u.m,{isOpen:S,onClose:function(){return O(!1)},onToggle:function(){return O(!S)},trigger:(F=(0,o.__)("Bulk Edit","nggallery"),s().createElement("button",{type:"button",className:"border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 px-3 sm:px-4 py-2 h-9 sm:h-10 rounded-md text-xs sm:text-sm font-medium flex items-center gap-1 sm:gap-2"},s().createElement("span",{className:"hidden sm:inline"},F),s().createElement("span",{className:"sm:hidden"},F.split(" ")[0]),s().createElement(i.D3,{className:"h-3 w-3 sm:h-4 sm:w-4"}))),activeClasses:"border border-gray-300 bg-gray-50 text-gray-700 px-4 py-2 h-10 rounded-md text-sm font-medium flex items-center gap-2"},s().createElement("div",{className:"py-1"},s().createElement("button",{className:"block w-full text-left px-4 py-2 text-sm text-red-700 hover:bg-red-100",onClick:function(){D();var e=y.filter(function(e){return f.has(e.id)});v(e)}},(0,o.__)("Delete Selected","nggallery")),x&&s().createElement("button",{className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",onClick:function(){D();var e=y.filter(function(e){return f.has(e.id)});x&&x(e)}},(0,o.__)("Set Watermark","nggallery")),E&&s().createElement("button",{className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",onClick:function(){D();var e=y.filter(function(e){return f.has(e.id)});E&&E(e)}},(0,o.__)("Create New Thumbnails","nggallery")),w&&s().createElement("button",{className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",onClick:function(){D();var e=y.filter(function(e){return f.has(e.id)});w&&w(e)}},(0,o.__)("Resize Images","nggallery")),N&&s().createElement("button",{className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",onClick:function(){D();var e=y.filter(function(e){return f.has(e.id)});N&&N(e)}},(0,o.__)("Import Metadata","nggallery")),C&&s().createElement("button",{className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",onClick:function(){D();var e=y.filter(function(e){return f.has(e.id)});C&&C(e)}},(0,o.__)("Recover from Backup","nggallery")))),s().createElement(m,{value:n,onChange:r,onSearch:d,placeholder:(0,o.__)(h)}),s().createElement(u.m,{isOpen:P,onClose:function(){return I(!1)},onToggle:function(){return I(!P)},trigger:s().createElement("button",{type:"button",className:"border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 px-3 sm:px-4 py-2 h-9 sm:h-10 rounded-md text-xs sm:text-sm font-medium flex items-center gap-1 sm:gap-2"},s().createElement(i.YG,{width:"16",height:"18",viewBox:"0 0 18 20",className:"sm:w-[18px] sm:h-[20px]"})),activeClasses:"border border-gray-300 bg-gray-50 text-gray-700 px-4 py-2 h-10 rounded-md text-sm font-medium flex items-center gap-2"},s().createElement("div",{className:"py-1"},_.filter(function(e){return!e.locked}).map(function(e){var t=e.key,n=e.label;return s().createElement("button",{key:t,className:"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",onClick:function(){var e;e=t,b(function(t){return g(g({},t),{},(0,l.A)({},e,!t[e]))})}},s().createElement("div",{className:"flex items-center justify-center w-5 h-5 mr-2"},p[t]&&s().createElement(i.Nr,{className:"h-5 w-5 text-green-500"})),n)}))))))};var b=n(2935),f=n(3155),y=n(7374),_=n(2329),h=n(2549),v=n(7143),x=function(){return[{key:"id",label:(0,o.__)("ID","nggallery"),filterable:!0,visibleByDefault:!0,sortType:"backend",locked:!0},{key:"albumTitle",label:(0,o.__)("Album Title","nggallery"),filterable:!0,visibleByDefault:!0,sortType:"backend",locked:!0},{key:"thumbnail",label:(0,o.__)("Thumbnail","nggallery"),filterable:!1,visibleByDefault:!0,sortType:!1,locked:!0},{key:"shortcode",label:(0,o.__)("Shortcode","nggallery"),filterable:!1,visibleByDefault:!0,sortType:!1,locked:!0},{key:"count",label:(0,o.__)("Galleries","nggallery"),filterable:!0,visibleByDefault:!0,sortType:!1},{key:"created",label:(0,o.__)("Created Date","nggallery"),filterable:!0,visibleByDefault:!1,sortType:"backend"},{key:"modified",label:(0,o.__)("Modified Date","nggallery"),filterable:!0,visibleByDefault:!1,sortType:"backend"},{key:"displayType",label:(0,o.__)("Display Type","nggallery"),filterable:!0,visibleByDefault:!1,sortType:"backend"}]},E=Object.fromEntries(x().map(function(e){return[e.key,e.visibleByDefault]})),w=n(5760),N=n(9292);const C=function(e){var t=e.onNext,n=e.onCancel,r=e.nextButtonText,l=void 0===r?(0,o.__)("Next step","nggallery"):r,i=e.showNextButton,u=void 0===i||i,m=e.showCancelButton,d=void 0===m||m,g=e.isFirstTab,p=void 0===g||g,b=(0,_.X)(),f=(null==b?void 0:b.isEmbed)||!1,y=(0,c.useState)(160),h=(0,a.A)(y,2),v=h[0],x=h[1];return(0,c.useEffect)(function(){if(!f){var e=function(){var e=document.body,t=window.innerWidth;t<=782?x(0):t<=960||e.classList.contains("folded")?x(36):x(160)};e(),window.addEventListener("resize",e);var t=new MutationObserver(e);return t.observe(document.body,{attributes:!0,attributeFilter:["class"]}),function(){window.removeEventListener("resize",e),t.disconnect()}}x(0)},[f]),s().createElement("div",{className:"fixed bottom-0 right-0 bg-white border-t border-gray-200 z-10",style:{left:"".concat(v,"px")}},s().createElement("div",{className:"px-4 py-3 sm:px-6"},s().createElement("div",{className:"flex justify-end items-center space-x-3"},d&&s().createElement("button",{onClick:n,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"},p?(0,o.__)("Cancel","nggallery"):(0,o.__)("Back","nggallery")),u&&s().createElement("button",{onClick:t,className:"px-4 py-2 text-sm font-medium text-white bg-green-500 border border-green-500 rounded-md hover:bg-green-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition-colors"},l))))};var k=[{id:"galleries",label:(0,o.__)("Galleries","nggallery"),description:(0,o.__)("Select & Organize","nggallery")},{id:"settings",label:(0,o.__)("Settings","nggallery"),description:(0,o.__)("Album Display","nggallery")}];const A=function(e){var t=e.activeTab,n=e.onTabChange,r=function(e){return k.findIndex(function(t){return t.id===e})};return s().createElement("div",{className:"px-4 sm:px-6 lg:px-8"},s().createElement("div",{className:"flex flex-col sm:flex-row w-full h-auto sm:h-[70px] relative rounded-lg border border-gray-200 overflow-hidden"},k.map(function(e,a){var l,o=(l=e.id,t===l),c=function(e){var n=r(t);return r(e)<n}(e.id),u=a===k.length-1,m=String(a+1).padStart(2,"0");return s().createElement("div",{key:e.id,className:"relative flex-1",style:{zIndex:k.length-a}},s().createElement("button",{onClick:function(){return n(e.id)},className:"mobile-step-button relative w-full h-full flex items-center px-4 sm:px-6 lg:px-8 py-4 sm:py-5 transition-all duration-300 border-b sm:border-b-0 sm:border-r border-gray-100 last:border-b-0 sm:last:border-r-0 ".concat(o?"text-green-800 bg-green-100":c?"text-gray-700 hover:text-green-700 bg-gray-50":"text-gray-500 hover:text-gray-700 bg-white hover:bg-gray-50"),style:{clipPath:u?"polygon(0 0, 100% 0, 100% 100%, 0 100%, 12px 50%)":0===a?"polygon(0 0, calc(100% - 12px) 0, 100% 50%, calc(100% - 12px) 100%, 0 100%)":"polygon(0 0, calc(100% - 12px) 0, 100% 50%, calc(100% - 12px) 100%, 0 100%, 12px 50%)",marginLeft:0===a?"":"-".concat(11*a,"px"),width:u?"calc( 100% + ".concat(11*a*2,"px )"):""}},s().createElement("div",{className:"flex items-center space-x-2 sm:space-x-3 w-full"},s().createElement("div",{className:"w-6 h-6 sm:w-8 sm:h-8 rounded-full flex items-center justify-center text-xs sm:text-sm font-bold transition-all duration-300 flex-shrink-0 ".concat(o?"bg-white text-green-700 border border-green-700":"text-gray-400 border border-gray-200")},c&&!o?s().createElement(i.Nr,{className:"w-3 h-3 sm:w-4 sm:h-4"}):m),s().createElement("div",{className:"flex flex-col items-start min-w-0 flex-1"},s().createElement("div",{className:"text-xs sm:text-sm font-semibold truncate w-full text-left"},e.label),s().createElement("div",{className:"text-xs opacity-75 text-left"},e.description)))))})))};var S=n(467),O=n(3375),T=n(3627),j=n(7196),P=n(7899),I=n(3597),F=n(5909),D=n(3930),G=n(1455),M=n.n(G);function z(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function l(n,r,a,l){var c=r&&r.prototype instanceof o?r:o,s=Object.create(c.prototype);return L(s,"_invoke",function(n,r,a){var l,o,c,s=0,u=a||[],m=!1,d={p:0,n:0,v:e,a:g,f:g.bind(e,4),d:function(t,n){return l=t,o=0,c=e,d.n=n,i}};function g(n,r){for(o=n,c=r,t=0;!m&&s&&!a&&t<u.length;t++){var a,l=u[t],g=d.p,p=l[2];n>3?(a=p===r)&&(c=l[(o=l[4])?5:(o=3,3)],l[4]=l[5]=e):l[0]<=g&&((a=n<2&&g<l[1])?(o=0,d.v=r,d.n=l[1]):g<p&&(a=n<3||l[0]>r||r>p)&&(l[4]=n,l[5]=r,d.n=p,o=0))}if(a||n>1)return i;throw m=!0,r}return function(a,u,p){if(s>1)throw TypeError("Generator is already running");for(m&&1===u&&g(u,p),o=u,c=p;(t=o<2?e:c)||!m;){l||(o?o<3?(o>1&&(d.n=-1),g(o,c)):d.n=c:d.v=c);try{if(s=2,l){if(o||(a="next"),t=l[a]){if(!(t=t.call(l,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,o<2&&(o=0)}else 1===o&&(t=l.return)&&t.call(l),o<2&&(c=TypeError("The iterator does not provide a '"+a+"' method"),o=1);l=e}else if((t=(m=d.n<0)?c:n.call(r,d))!==i)break}catch(t){l=e,o=1,c=t}finally{s=1}}return{value:t,done:m}}}(n,a,l),!0),s}var i={};function o(){}function c(){}function s(){}t=Object.getPrototypeOf;var u=[][r]?t(t([][r]())):(L(t={},r,function(){return this}),t),m=s.prototype=o.prototype=Object.create(u);function d(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,L(e,a,"GeneratorFunction")),e.prototype=Object.create(m),e}return c.prototype=s,L(m,"constructor",s),L(s,"constructor",c),c.displayName="GeneratorFunction",L(s,a,"GeneratorFunction"),L(m),L(m,a,"Generator"),L(m,r,function(){return this}),L(m,"toString",function(){return"[object Generator]"}),(z=function(){return{w:l,m:d}})()}function L(e,t,n,r){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}L=function(e,t,n,r){function l(t,n){L(e,t,function(e){return this._invoke(t,n,e)})}t?a?a(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(l("next",0),l("throw",1),l("return",2))},L(e,t,n,r)}function B(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function R(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?B(Object(n),!0).forEach(function(t){(0,l.A)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):B(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}const W=function(e){var t,n=e.isOpen,r=e.onClose,l=e.onSave,i=e.initialData,u=(0,c.useState)(i),m=(0,a.A)(u,2),d=m[0],g=m[1];(0,c.useEffect)(function(){n&&g(i)},[n,i]);var p,b=(0,D.I)({queryKey:["wordpress-pages"],queryFn:(p=(0,S.A)(z().m(function e(){var t,n;return z().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,M()({path:"/wp/v2/pages?per_page=100&status=publish",method:"GET"});case 1:return t=e.v,e.a(2,t);case 2:return e.p=2,n=e.v,console.error("Failed to fetch WordPress pages:",n),e.a(2,[])}},e,null,[[0,2]])})),function(){return p.apply(this,arguments)}),staleTime:3e5,gcTime:6e5}),f=b.data,y=b.isLoading,_=(0,c.useMemo)(function(){return f&&Array.isArray(f)?f.map(function(e){return{value:e.id.toString(),label:e.title.rendered||"Page ".concat(e.id)}}):[]},[f]);return s().createElement(j.A,{isOpen:n,onClose:r,title:(0,o.__)("Edit Album","nggallery")},s().createElement("div",{className:"space-y-4"},s().createElement(F.A,{type:"text",name:"name",value:d.name,onChange:function(e){return g(R(R({},d),{},{name:e.target.value}))},label:(0,o.__)("Album Name","nggallery"),placeholder:(0,o.__)("Enter album name...","nggallery")}),s().createElement(I.A,{name:"description",value:d.description,onChange:function(e){return g(R(R({},d),{},{description:e.target.value}))},label:(0,o.__)("Album Description","nggallery"),placeholder:(0,o.__)("Enter album description...","nggallery"),rows:3}),s().createElement(P.A,{id:"pageid",name:"pageid",value:(null===(t=d.pageid)||void 0===t?void 0:t.toString())||"",onChange:function(e){return g(R(R({},d),{},{pageid:e.target.value?parseInt(e.target.value):null}))},label:(0,o.__)("Page Link to","nggallery")},y?s().createElement("option",{value:""},(0,o.__)("Loading pages...","nggallery")):s().createElement(s().Fragment,null,s().createElement("option",{value:""},(0,o.__)("Not linked","nggallery")),_.map(function(e){return s().createElement("option",{key:e.value,value:e.value},e.label)}))),s().createElement("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-200"},s().createElement("button",{onClick:r,className:"px-4 py-2 text-sm font-medium text-gray-700 hover:text-gray-500"},(0,o.__)("Cancel","nggallery")),s().createElement("button",{onClick:function(){l(d),r()},className:"px-4 py-2 bg-green-600 text-white text-sm font-medium rounded-md hover:bg-green-700"},(0,o.__)("Save Changes","nggallery")))))};var X=n(2284);function U(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError((0,X.A)(e)+" is not iterable")}function q(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function l(n,r,a,l){var c=r&&r.prototype instanceof o?r:o,s=Object.create(c.prototype);return H(s,"_invoke",function(n,r,a){var l,o,c,s=0,u=a||[],m=!1,d={p:0,n:0,v:e,a:g,f:g.bind(e,4),d:function(t,n){return l=t,o=0,c=e,d.n=n,i}};function g(n,r){for(o=n,c=r,t=0;!m&&s&&!a&&t<u.length;t++){var a,l=u[t],g=d.p,p=l[2];n>3?(a=p===r)&&(c=l[(o=l[4])?5:(o=3,3)],l[4]=l[5]=e):l[0]<=g&&((a=n<2&&g<l[1])?(o=0,d.v=r,d.n=l[1]):g<p&&(a=n<3||l[0]>r||r>p)&&(l[4]=n,l[5]=r,d.n=p,o=0))}if(a||n>1)return i;throw m=!0,r}return function(a,u,p){if(s>1)throw TypeError("Generator is already running");for(m&&1===u&&g(u,p),o=u,c=p;(t=o<2?e:c)||!m;){l||(o?o<3?(o>1&&(d.n=-1),g(o,c)):d.n=c:d.v=c);try{if(s=2,l){if(o||(a="next"),t=l[a]){if(!(t=t.call(l,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,o<2&&(o=0)}else 1===o&&(t=l.return)&&t.call(l),o<2&&(c=TypeError("The iterator does not provide a '"+a+"' method"),o=1);l=e}else if((t=(m=d.n<0)?c:n.call(r,d))!==i)break}catch(t){l=e,o=1,c=t}finally{s=1}}return{value:t,done:m}}}(n,a,l),!0),s}var i={};function o(){}function c(){}function s(){}t=Object.getPrototypeOf;var u=[][r]?t(t([][r]())):(H(t={},r,function(){return this}),t),m=s.prototype=o.prototype=Object.create(u);function d(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,H(e,a,"GeneratorFunction")),e.prototype=Object.create(m),e}return c.prototype=s,H(m,"constructor",s),H(s,"constructor",c),c.displayName="GeneratorFunction",H(s,a,"GeneratorFunction"),H(m),H(m,a,"Generator"),H(m,r,function(){return this}),H(m,"toString",function(){return"[object Generator]"}),(q=function(){return{w:l,m:d}})()}function H(e,t,n,r){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}H=function(e,t,n,r){function l(t,n){H(e,t,function(e){return this._invoke(t,n,e)})}t?a?a(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(l("next",0),l("throw",1),l("return",2))},H(e,t,n,r)}function V(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return K(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?K(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,i=!0,o=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){o=!0,l=e},f:function(){try{i||null==n.return||n.return()}finally{if(o)throw l}}}}function K(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}const Y=function(e){var t=e.isOpen,n=e.onClose,r=e.onSelect,l=e.albumSortorder,i=e.currentImageId,u=(0,c.useState)([]),m=(0,a.A)(u,2),d=m[0],g=m[1],p=(0,c.useState)(!1),b=(0,a.A)(p,2),f=b[0],y=b[1],_=(0,c.useState)(i),h=(0,a.A)(_,2),v=h[0],x=h[1];(0,c.useEffect)(function(){x(i)},[i]),(0,c.useEffect)(function(){t&&l.length>0&&E()},[t,l]);var E=function(){var e=(0,S.A)(q().m(function e(){var t,n,r,a,i,o;return q().w(function(e){for(;;)switch(e.n){case 0:return y(!0),n=[],r=new Set,a=null===(t=window.imagelyApp)||void 0===t?void 0:t.nonce,i=function(){var e=(0,S.A)(q().m(function e(t){var l,o,c,s,u,m=arguments;return q().w(function(e){for(;;)switch(e.p=e.n){case 0:if(!((l=m.length>1&&void 0!==m[1]?m[1]:0)>10)){e.n=1;break}return e.a(2);case 1:o=V(t),e.p=2,s=q().m(function e(){var t,o,s,u,m,d,g,p,b,f;return q().w(function(e){for(;;)switch(e.p=e.n){case 0:if("string"!=typeof(t=c.value)||!t.startsWith("a")){e.n=7;break}if(o=parseInt(t.substring(1)),!r.has(o)){e.n=1;break}return e.a(2,1);case 1:return r.add(o),e.p=2,e.n=3,M()({path:"/imagely/v1/albums/".concat(o),method:"GET",headers:{"X-WP-Nonce":a}});case 3:if(null==(s=e.v)||!s.sortorder||!Array.isArray(s.sortorder)){e.n=4;break}return e.n=4,i(s.sortorder,l+1);case 4:e.n=6;break;case 5:e.p=5,p=e.v,console.error("Failed to fetch nested album ".concat(o,":"),p);case 6:e.n=15;break;case 7:return u=t,e.p=8,e.n=9,M()({path:"/imagely/v1/images?gallery_id=".concat(u,"&per_page=-1"),method:"GET",headers:{"X-WP-Nonce":a}});case 9:return m=e.v,d="Gallery ".concat(u),g=null,e.p=10,e.n=11,M()({path:"/imagely/v1/galleries/".concat(u),method:"GET",headers:{"X-WP-Nonce":a}});case 11:g=e.v,d=g.title||g.name||d,e.n=13;break;case 12:e.p=12,b=e.v,console.warn("Failed to fetch gallery ".concat(u," info:"),b);case 13:Array.isArray(m)&&m.length>0&&m.forEach(function(e){n.push({pid:e.pid,filename:e.filename||e.alttext||"Untitled",alttext:e.alttext,thumbUrl:e.thumb_url||"",galleryName:d})}),e.n=15;break;case 14:e.p=14,f=e.v,console.error("Failed to fetch images for gallery ".concat(u,":"),f);case 15:return e.a(2)}},e,null,[[10,12],[8,14],[2,5]])}),o.s();case 3:if((c=o.n()).done){e.n=6;break}return e.d(U(s()),4);case 4:if(!e.v){e.n=5;break}return e.a(3,5);case 5:e.n=3;break;case 6:e.n=8;break;case 7:e.p=7,u=e.v,o.e(u);case 8:return e.p=8,o.f(),e.f(8);case 9:return e.a(2)}},e,null,[[2,7,8,9]])}));return function(t){return e.apply(this,arguments)}}(),e.n=1,i(l);case 1:o=Array.from(new Map(n.map(function(e){return[e.pid,e]})).values()),g(o),y(!1);case 2:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}();return s().createElement(j.A,{isOpen:t,onClose:n,title:(0,o.__)("Select Preview Image","nggallery")},s().createElement("div",{className:"space-y-4"},f?s().createElement("div",{className:"flex items-center justify-center py-12"},s().createElement("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600"}),s().createElement("span",{className:"ml-3 text-gray-600"},(0,o.__)("Loading images...","nggallery"))):0===d.length?s().createElement("div",{className:"text-center py-12"},s().createElement("p",{className:"text-gray-500"},(0,o.__)("No images available in this album.","nggallery"))):s().createElement(s().Fragment,null,s().createElement("div",{className:"text-sm text-gray-600 mb-4"},(0,o.__)("Click an image to select it as the album preview.","nggallery")),s().createElement("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 lg:grid-cols-6 gap-3 max-h-[500px] overflow-y-auto"},d.map(function(e){return s().createElement("div",{key:e.pid,onClick:function(){return t=e.pid,void x(t);var t},className:"relative cursor-pointer rounded-lg overflow-hidden border-2 transition-all hover:shadow-lg ".concat(v===e.pid?"border-green-500 ring-2 ring-green-200":"border-gray-200 hover:border-gray-300")},s().createElement("div",{className:"aspect-square"},s().createElement("img",{src:e.thumbUrl,alt:e.filename,className:"w-full h-full object-cover",loading:"lazy"})),v===e.pid&&s().createElement("div",{className:"absolute inset-0 bg-green-500 bg-opacity-20 flex items-center justify-center"},s().createElement("svg",{className:"w-8 h-8 text-green-600",fill:"currentColor",viewBox:"0 0 20 20"},s().createElement("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"}))),s().createElement("div",{className:"absolute bottom-0 left-0 right-0 bg-black bg-opacity-60 text-white text-xs p-1 truncate"},e.filename))}))),s().createElement("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-200"},s().createElement("button",{onClick:n,className:"px-4 py-2 text-sm font-medium text-gray-700 hover:text-gray-500"},(0,o.__)("Cancel","nggallery")),s().createElement("button",{onClick:function(){v&&r(v),n()},disabled:!v,className:"px-4 py-2 bg-green-600 text-white text-sm font-medium rounded-md hover:bg-green-700 disabled:bg-gray-300 disabled:cursor-not-allowed"},(0,o.__)("Set as Preview","nggallery")))))};var J=n(2724),$=n(2416);const Z=function(e){var t=e.isOpen,n=e.onClose,r=e.excludeGalleryIds,l=void 0===r?[]:r,i=e.excludeAlbumIds,u=void 0===i?[]:i,m=e.onConfirm,d=(0,c.useState)("galleries"),g=(0,a.A)(d,2),p=g[0],b=g[1],y=(0,c.useState)(new Set),_=(0,a.A)(y,2),h=_[0],v=_[1],x=(0,c.useState)(new Set),E=(0,a.A)(x,2),w=E[0],C=E[1],k=(0,c.useState)(""),A=(0,a.A)(k,2),S=A[0],O=A[1],T=(0,c.useState)(""),P=(0,a.A)(T,2),I=P[0],F=P[1],D=(0,J.yr)({get_all:!0}),G=D.data,M=D.isLoading,z=(0,f.uI)({get_all:!0}),L=z.data,B=z.isLoading,R=(0,$.E)(),W=(R.showSuccess,R.showError),X=(0,c.useMemo)(function(){var e=((null==G?void 0:G.galleries)||[]).filter(function(e){return!l.includes(e.id)});return S?e.filter(function(e){return e.galleryTitle.toLowerCase().includes(S.toLowerCase())}):e},[null==G?void 0:G.galleries,l,S]),U=(0,c.useMemo)(function(){var e=((null==L?void 0:L.albums)||[]).filter(function(e){return!u.includes(e.id)});return I?e.filter(function(e){return e.albumTitle.toLowerCase().includes(I.toLowerCase())}):e},[null==L?void 0:L.albums,u,I]),q=function(){v(new Set),C(new Set),O(""),F(""),n()};return s().createElement(j.A,{isOpen:t,onClose:q,title:(0,o.__)("Add Items to Album","nggallery")},s().createElement("div",{className:"space-y-4"},s().createElement("div",{className:"flex border-b border-gray-200"},s().createElement("button",{onClick:function(){return b("galleries")},className:"flex-1 py-2 px-4 text-sm font-medium transition-colors ".concat("galleries"===p?"border-b-2 border-green-500 text-green-600":"text-gray-500 hover:text-gray-700")},(0,o.__)("Galleries","nggallery")," ",h.size>0&&"(".concat(h.size,")")),s().createElement("button",{onClick:function(){return b("albums")},className:"flex-1 py-2 px-4 text-sm font-medium transition-colors ".concat("albums"===p?"border-b-2 border-green-500 text-green-600":"text-gray-500 hover:text-gray-700")},(0,o.__)("Albums","nggallery")," ",w.size>0&&"(".concat(w.size,")"))),s().createElement("div",{className:"min-h-[400px]"},"galleries"===p?s().createElement(s().Fragment,null,s().createElement("div",{className:"mb-4"},s().createElement("input",{type:"text",placeholder:(0,o.__)("Search galleries...","nggallery"),value:S,onChange:function(e){return O(e.target.value)},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500"})),X.length>0&&s().createElement("div",{className:"mb-3 flex items-center justify-between"},s().createElement("span",{className:"text-sm text-gray-600"},(0,o.sprintf)((0,o.__)("%d galleries available","nggallery"),X.length)),s().createElement("button",{onClick:function(){h.size===X.length?v(new Set):v(new Set(X.map(function(e){return e.id})))},className:"text-sm text-green-600 hover:text-green-700 font-medium"},h.size===X.length?(0,o.__)("Deselect All","nggallery"):(0,o.__)("Select All","nggallery"))),M&&s().createElement("div",{className:"flex items-center justify-center py-12"},s().createElement(N.A,null)),!M&&0===X.length&&s().createElement("div",{className:"text-center py-12"},s().createElement("p",{className:"text-gray-500"},S?(0,o.__)("No galleries found matching your search","nggallery"):(0,o.__)("No galleries available to add","nggallery"))),!M&&X.length>0&&s().createElement("div",{className:"border border-gray-200 rounded-lg p-4 max-h-96 overflow-y-auto"},s().createElement("div",{className:"grid grid-cols-2 gap-3"},X.map(function(e){return s().createElement("label",{key:e.id,className:"flex items-center p-3 border rounded-lg cursor-pointer transition-colors ".concat(h.has(e.id)?"border-green-500 bg-green-50":"border-gray-200 hover:border-gray-300")},s().createElement("input",{type:"checkbox",checked:h.has(e.id),onChange:function(){return t=e.id,void v(function(e){var n=new Set(e);return n.has(t)?n.delete(t):n.add(t),n});var t},className:"h-4 w-4 text-green-600 focus:ring-green-500 border-gray-300 rounded mr-3"}),s().createElement("div",{className:"flex-1 min-w-0"},s().createElement("div",{className:"flex items-center space-x-3"},e.thumbnail?s().createElement("img",{src:e.thumbnail,alt:e.galleryTitle,className:"w-12 h-12 object-cover rounded"}):s().createElement("div",{className:"w-12 h-12 bg-gray-100 rounded flex items-center justify-center"},s().createElement("svg",{className:"h-6 w-6 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},s().createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"}))),s().createElement("div",{className:"flex-1 min-w-0"},s().createElement("div",{className:"text-sm font-medium text-gray-900 truncate"},e.galleryTitle),s().createElement("div",{className:"text-xs text-gray-500"},(0,o.sprintf)((0,o.__)("%d images","nggallery"),parseInt(e.count)||0))))))})))):s().createElement(s().Fragment,null,s().createElement("div",{className:"mb-4"},s().createElement("input",{type:"text",placeholder:(0,o.__)("Search albums...","nggallery"),value:I,onChange:function(e){return F(e.target.value)},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500"})),U.length>0&&s().createElement("div",{className:"mb-3 flex items-center justify-between"},s().createElement("span",{className:"text-sm text-gray-600"},(0,o.sprintf)((0,o.__)("%d albums available","nggallery"),U.length)),s().createElement("button",{onClick:function(){w.size===U.length?C(new Set):C(new Set(U.map(function(e){return e.id})))},className:"text-sm text-green-600 hover:text-green-700 font-medium"},w.size===U.length?(0,o.__)("Deselect All","nggallery"):(0,o.__)("Select All","nggallery"))),B&&s().createElement("div",{className:"flex items-center justify-center py-12"},s().createElement(N.A,null)),!B&&0===U.length&&s().createElement("div",{className:"text-center py-12"},s().createElement("p",{className:"text-gray-500"},I?(0,o.__)("No albums found matching your search","nggallery"):(0,o.__)("No albums available to add","nggallery"))),!B&&U.length>0&&s().createElement("div",{className:"border border-gray-200 rounded-lg p-4 max-h-96 overflow-y-auto"},s().createElement("div",{className:"grid grid-cols-2 gap-3"},U.map(function(e){return s().createElement("label",{key:e.id,className:"flex items-center p-3 border-2 rounded-lg cursor-pointer transition-colors ".concat(w.has(e.id)?"border-purple-600 bg-purple-50":"border-purple-300 hover:border-purple-400")},s().createElement("input",{type:"checkbox",checked:w.has(e.id),onChange:function(){return t=e.id,void C(function(e){var n=new Set(e);return n.has(t)?n.delete(t):n.add(t),n});var t},className:"h-4 w-4 text-purple-600 focus:ring-purple-500 border-gray-300 rounded mr-3"}),s().createElement("div",{className:"flex-1 min-w-0"},s().createElement("div",{className:"flex items-center space-x-3"},e.thumbnail?s().createElement("img",{src:e.thumbnail,alt:e.albumTitle,className:"w-12 h-12 object-cover rounded"}):s().createElement("div",{className:"w-12 h-12 bg-gray-100 rounded flex items-center justify-center"},s().createElement("svg",{className:"h-6 w-6 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},s().createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"}))),s().createElement("div",{className:"flex-1 min-w-0"},s().createElement("div",{className:"text-sm font-medium text-gray-900 truncate"},e.albumTitle),s().createElement("div",{className:"text-xs text-gray-500"},(0,o.sprintf)((0,o.__)("%d items","nggallery"),parseInt(e.count)||0))))))}))))),s().createElement("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-200"},s().createElement("button",{onClick:q,className:"px-4 py-2 text-sm font-medium text-gray-700 hover:text-gray-500"},(0,o.__)("Cancel","nggallery")),s().createElement("button",{onClick:function(){var e=Array.from(h),t=Array.from(w);0!==e.length||0!==t.length?(m&&m(e,t),v(new Set),C(new Set),O(""),F(""),n()):W((0,o.__)("Please select at least one item","nggallery"))},disabled:0===h.size&&0===w.size,className:"px-4 py-2 bg-green-500 text-white text-sm font-medium rounded-md hover:bg-green-600 disabled:bg-green-300 disabled:cursor-not-allowed"},(0,o.__)("Add Items","nggallery")," (",h.size+w.size,")"))))};var Q=n(5300);const ee=function(e){var t=e.albumName,n=e.previewImageUrl,r=e.itemCount,a=e.onEditClick,l=e.onImageClick,i=t&&t.length>50?t.slice(0,50)+"...":t||(0,o.__)("Untitled Album","nggallery");return s().createElement("div",{className:"flex items-center space-x-3 sm:space-x-4 pb-6 border-b border-gray-200"},s().createElement("img",{src:n||(0,Q.B)({text:"NO IMAGE"}),alt:i,onClick:l,className:"w-10 h-10 sm:w-12 sm:h-12 object-cover rounded flex-shrink-0 cursor-pointer hover:opacity-80 transition-opacity",title:(0,o.__)("Click to select preview image","nggallery")}),s().createElement("div",{className:"flex flex-col min-w-0 flex-1"},s().createElement("div",{className:"flex flex-col sm:flex-row sm:items-center space-y-1 sm:space-y-0 sm:space-x-2"},s().createElement("h1",{className:"text-lg sm:text-xl font-semibold truncate"},i," (",r,")"),s().createElement("button",{className:"px-2 py-1 bg-gray-100 rounded hover:bg-gray-200 text-xs sm:text-sm flex items-center self-start sm:self-auto",onClick:a},s().createElement("svg",{width:"8",height:"8",viewBox:"0 0 10 10",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"mr-1 sm:w-2.5 sm:h-2.5"},s().createElement("path",{d:"M7.5 0.500151C7.63132 0.368829 7.78722 0.264659 7.9588 0.193588C8.13038 0.122517 8.31428 0.0859375 8.5 0.0859375C8.68572 0.0859375 8.86962 0.122517 9.0412 0.193588C9.21278 0.264659 9.36868 0.36883 9.5 0.500151C9.63132 0.631473 9.73549 0.787375 9.80656 0.958955C9.87763 1.13054 9.91421 1.31443 9.91421 1.50015C9.91421 1.68587 9.87763 1.86977 9.80656 2.04135C9.73549 2.21293 9.63132 2.36883 9.5 2.50015L2.75 9.25015L0 10.0002L0.75 7.25015L7.5 0.500151Z",fill:"currentColor"})),(0,o.__)("Edit Details","nggallery")))))};var te=n(8168),ne=n(4979),re=(0,c.memo)(function(e){var t=e.item,n=e.isSelected,r=e.onSelect,l=(0,c.useState)(!1),u=(0,a.A)(l,2),m=u[0],d=u[1],g=(null==t?void 0:t.id)||0,p=(0,T.gl)({id:g,transition:{duration:150,easing:"cubic-bezier(0.25, 1, 0.5, 1)"}}),b=p.attributes,f=p.listeners,y=p.setNodeRef,_=p.transform,h=p.transition,v=p.isDragging;if(!t||null==t||!t.id)return null;var x={transform:ne.Ks.Transform.toString(_),transition:h,opacity:v?.5:1,touchAction:"none",willChange:"transform, opacity"},E=m||n,w="album"===t.type;return s().createElement("div",{className:"relative w-[160px]"},s().createElement("div",{ref:y,style:x,className:"relative bg-white rounded-lg will-change-transform ".concat(v?"z-10 shadow-xl ring-2 ring-blue-500":""," ").concat(n?"ring-2 ring-blue-500":""),"data-testid":"sortable-item-".concat(t.id),onMouseEnter:function(){return d(!0)},onMouseLeave:function(){return d(!1)}},s().createElement("div",{className:"absolute top-2 left-2 z-20"},s().createElement("input",{title:(0,o.__)("Select item","nggallery"),type:"checkbox",checked:n,onChange:function(e){e.stopPropagation(),r(t.id)},onClick:function(e){return e.stopPropagation()},className:"rounded border-gray-300 cursor-pointer"})),w&&s().createElement("div",{className:"absolute top-2 right-2 bg-purple-500 text-white px-2 py-1 rounded text-xs font-medium z-20"},(0,o.__)("Album","nggallery")),s().createElement("div",{className:"overflow-hidden rounded-lg bg-gray-100 flex items-center justify-center relative",style:{width:160,height:110}},t.thumbnail?s().createElement("img",{src:t.thumbnail,alt:t.title,className:"object-cover rounded-lg",loading:"lazy",width:160,height:110,draggable:!1,style:{width:160,height:110}}):s().createElement("div",{className:"flex flex-col items-center justify-center text-gray-400"},s().createElement(s().Fragment,null,s().createElement(i.RY,{className:"w-8 h-8 mb-2"}),s().createElement("span",{className:"text-xs"},(0,o.__)("No Preview","nggallery")))),E&&s().createElement("div",{className:"absolute inset-0 bg-black bg-opacity-30 transition-opacity rounded-lg"})),s().createElement("div",{className:"p-3"},s().createElement("div",{className:"flex items-center justify-between"},s().createElement("div",{className:"flex-1 min-w-0"},s().createElement("p",{className:"text-sm font-medium text-gray-900 truncate",title:t.title},t.title),s().createElement("p",{className:"text-xs text-gray-500 mt-1"},t.count," ",w?(0,o.__)("items","nggallery"):(0,o.__)("images","nggallery"))),s().createElement("button",(0,te.A)({},b,f,{className:"flex-shrink-0 text-gray-400 hover:text-gray-600 p-1 rounded cursor-move ml-2",title:(0,o.__)("Drag to reorder","nggallery")}),s().createElement(i.GG,{className:"text-gray-500"}))))))});re.displayName="SortableItem";const ae=re;function le(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function l(n,r,a,l){var c=r&&r.prototype instanceof o?r:o,s=Object.create(c.prototype);return ie(s,"_invoke",function(n,r,a){var l,o,c,s=0,u=a||[],m=!1,d={p:0,n:0,v:e,a:g,f:g.bind(e,4),d:function(t,n){return l=t,o=0,c=e,d.n=n,i}};function g(n,r){for(o=n,c=r,t=0;!m&&s&&!a&&t<u.length;t++){var a,l=u[t],g=d.p,p=l[2];n>3?(a=p===r)&&(c=l[(o=l[4])?5:(o=3,3)],l[4]=l[5]=e):l[0]<=g&&((a=n<2&&g<l[1])?(o=0,d.v=r,d.n=l[1]):g<p&&(a=n<3||l[0]>r||r>p)&&(l[4]=n,l[5]=r,d.n=p,o=0))}if(a||n>1)return i;throw m=!0,r}return function(a,u,p){if(s>1)throw TypeError("Generator is already running");for(m&&1===u&&g(u,p),o=u,c=p;(t=o<2?e:c)||!m;){l||(o?o<3?(o>1&&(d.n=-1),g(o,c)):d.n=c:d.v=c);try{if(s=2,l){if(o||(a="next"),t=l[a]){if(!(t=t.call(l,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,o<2&&(o=0)}else 1===o&&(t=l.return)&&t.call(l),o<2&&(c=TypeError("The iterator does not provide a '"+a+"' method"),o=1);l=e}else if((t=(m=d.n<0)?c:n.call(r,d))!==i)break}catch(t){l=e,o=1,c=t}finally{s=1}}return{value:t,done:m}}}(n,a,l),!0),s}var i={};function o(){}function c(){}function s(){}t=Object.getPrototypeOf;var u=[][r]?t(t([][r]())):(ie(t={},r,function(){return this}),t),m=s.prototype=o.prototype=Object.create(u);function d(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,ie(e,a,"GeneratorFunction")),e.prototype=Object.create(m),e}return c.prototype=s,ie(m,"constructor",s),ie(s,"constructor",c),c.displayName="GeneratorFunction",ie(s,a,"GeneratorFunction"),ie(m),ie(m,a,"Generator"),ie(m,r,function(){return this}),ie(m,"toString",function(){return"[object Generator]"}),(le=function(){return{w:l,m:d}})()}function ie(e,t,n,r){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}ie=function(e,t,n,r){function l(t,n){ie(e,t,function(e){return this._invoke(t,n,e)})}t?a?a(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(l("next",0),l("throw",1),l("return",2))},ie(e,t,n,r)}function oe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function ce(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?oe(Object(n),!0).forEach(function(t){(0,l.A)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):oe(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var se=(0,c.createContext)(void 0),ue="photocrati-nextgen_basic_compact_album",me=function(e){if(!e)return ue;if(e.startsWith("photocrati-")||e.startsWith("imagely-"))return e;switch(e){case"basic_compact_album":return"photocrati-nextgen_basic_compact_album";case"basic_extended_album":return"photocrati-nextgen_basic_extended_album";case"pro_grid_album":return"photocrati-nextgen_pro_grid_album";case"pro_list_album":return"photocrati-nextgen_pro_list_album";case"pro_search":return"imagely-pro-search";default:return ue}},de=function(e){return"photocrati-nextgen_basic_compact_album"===e||"photocrati-nextgen_basic_extended_album"===e?{open_gallery_in_lightbox:!1,gallery_display_type:"photocrati-nextgen_basic_thumbnails",galleries_per_page:20,enable_breadcrumbs:!0,enable_descriptions:!1,display_view:"default",template:"default",override_thumbnail_settings:1,thumbnail_width:240,thumbnail_height:160,thumbnail_crop:1,animate_images_enable:!1,animate_images_style:"wobble",animate_images_duration:1500,animate_images_delay:250,animate_pagination_enable:!1,animate_pagination_style:"flipInX",animate_pagination_duration:1500,animate_pagination_delay:250,is_ecommerce_enabled:0}:{}},ge=function(e,t){var n=de(e),r=t&&"object"===(0,X.A)(t)?t:{};return ce(ce({},n),r)},pe=function(e){var t=e.children,n=e.initialAlbum,r=(0,c.useState)(n),i=(0,a.A)(r,2),o=i[0],u=i[1],m=(0,c.useState)(!1),d=(0,a.A)(m,2),g=d[0],p=d[1],b=(0,f.sR)(),y=(0,c.useState)(function(){var e=me(null==n?void 0:n.display_type),t=(null==n?void 0:n.display_type_settings)||{},r=ce(ce({},t),{},(0,l.A)({},e,ge(e,t[e])));return n?{name:n.name||"",description:n.description||"",display_type:e,display_type_settings:r,sortorder:n.sortorder||[],preview_image_id:n.preview_image_id||null,pageid:n.pageid||null}:{name:"",description:"",display_type:e,display_type_settings:(0,l.A)({},e,de(e)),sortorder:[],preview_image_id:null,pageid:null}}),_=(0,a.A)(y,2),h=_[0],v=_[1];(0,c.useEffect)(function(){if(n&&n!==o){var e=me(n.display_type),t=n.display_type_settings||{},r=ce(ce({},t),{},(0,l.A)({},e,ge(e,t[e])));if(u(n),g)return;v({name:n.name||"",description:n.description||"",display_type:e,display_type_settings:r,sortorder:n.sortorder||[],preview_image_id:n.preview_image_id||null,pageid:n.pageid||null})}},[n,o,g]);var x=(0,c.useCallback)(function(e,t){v(function(n){return ce(ce({},n),{},(0,l.A)({},e,t))}),p(!0)},[]),E=(0,c.useCallback)(function(e,t){v(function(n){return ce(ce({},n),{},{display_type_settings:ce(ce({},n.display_type_settings),{},(0,l.A)({},e,t))})}),p(!0)},[]),w=(0,c.useCallback)((0,S.A)(le().m(function e(){var t,n;return le().w(function(e){for(;;)switch(e.p=e.n){case 0:if(null!=o&&o.id&&g){e.n=1;break}return e.a(2);case 1:return e.p=1,e.n=2,b.mutateAsync({id:o.id,data:h});case 2:t=e.v,u(t),p(!1),e.n=4;break;case 3:throw e.p=3,n=e.v,console.error("Failed to save album:",n),n;case 4:return e.a(2)}},e,null,[[1,3]])})),[null==o?void 0:o.id,h,g,b]),N=(0,c.useCallback)(function(){if(o){var e=me(o.display_type),t=o.display_type_settings||{},n=ce(ce({},t),{},(0,l.A)({},e,ge(e,t[e])));v({name:o.name||"",description:o.description||"",display_type:e,display_type_settings:n,sortorder:o.sortorder||[],preview_image_id:o.preview_image_id||null,pageid:o.pageid||null}),p(!1)}},[o]),C={album:o,formData:h,isLoading:b.isPending,isDirty:g,updateField:x,updateDisplayTypeSetting:E,saveForm:w,resetForm:N};return s().createElement(se.Provider,{value:C},t)},be=function(){var e=(0,c.useContext)(se);if(void 0===e)throw new Error("useAlbumForm must be used within an AlbumFormProvider");return e};function fe(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function l(n,r,a,l){var c=r&&r.prototype instanceof o?r:o,s=Object.create(c.prototype);return ye(s,"_invoke",function(n,r,a){var l,o,c,s=0,u=a||[],m=!1,d={p:0,n:0,v:e,a:g,f:g.bind(e,4),d:function(t,n){return l=t,o=0,c=e,d.n=n,i}};function g(n,r){for(o=n,c=r,t=0;!m&&s&&!a&&t<u.length;t++){var a,l=u[t],g=d.p,p=l[2];n>3?(a=p===r)&&(c=l[(o=l[4])?5:(o=3,3)],l[4]=l[5]=e):l[0]<=g&&((a=n<2&&g<l[1])?(o=0,d.v=r,d.n=l[1]):g<p&&(a=n<3||l[0]>r||r>p)&&(l[4]=n,l[5]=r,d.n=p,o=0))}if(a||n>1)return i;throw m=!0,r}return function(a,u,p){if(s>1)throw TypeError("Generator is already running");for(m&&1===u&&g(u,p),o=u,c=p;(t=o<2?e:c)||!m;){l||(o?o<3?(o>1&&(d.n=-1),g(o,c)):d.n=c:d.v=c);try{if(s=2,l){if(o||(a="next"),t=l[a]){if(!(t=t.call(l,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,o<2&&(o=0)}else 1===o&&(t=l.return)&&t.call(l),o<2&&(c=TypeError("The iterator does not provide a '"+a+"' method"),o=1);l=e}else if((t=(m=d.n<0)?c:n.call(r,d))!==i)break}catch(t){l=e,o=1,c=t}finally{s=1}}return{value:t,done:m}}}(n,a,l),!0),s}var i={};function o(){}function c(){}function s(){}t=Object.getPrototypeOf;var u=[][r]?t(t([][r]())):(ye(t={},r,function(){return this}),t),m=s.prototype=o.prototype=Object.create(u);function d(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,ye(e,a,"GeneratorFunction")),e.prototype=Object.create(m),e}return c.prototype=s,ye(m,"constructor",s),ye(s,"constructor",c),c.displayName="GeneratorFunction",ye(s,a,"GeneratorFunction"),ye(m),ye(m,a,"Generator"),ye(m,r,function(){return this}),ye(m,"toString",function(){return"[object Generator]"}),(fe=function(){return{w:l,m:d}})()}function ye(e,t,n,r){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}ye=function(e,t,n,r){function l(t,n){ye(e,t,function(e){return this._invoke(t,n,e)})}t?a?a(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(l("next",0),l("throw",1),l("return",2))},ye(e,t,n,r)}const _e=function(e){var t=e.albumId,n=be(),l=n.formData,u=n.updateField,m=(0,$.E)(),d=m.showSuccess,g=m.showError,p=(0,f.sR)(),_=(0,f.$U)(t).data,h=(0,y.UG)().data,v=(null==h?void 0:h.item_details_per_page)||50,x=(0,c.useState)([]),E=(0,a.A)(x,2),w=E[0],C=E[1],k=(0,c.useState)(new Set),A=(0,a.A)(k,2),j=A[0],P=A[1],I=(0,c.useState)(null),F=(0,a.A)(I,2),D=F[0],G=F[1],z=(0,c.useState)(!1),L=(0,a.A)(z,2),B=L[0],R=L[1],X=(0,c.useState)(!1),U=(0,a.A)(X,2),q=U[0],H=U[1],V=(0,c.useState)(!1),K=(0,a.A)(V,2),Q=K[0],te=K[1],ne=(0,c.useState)(1),re=(0,a.A)(ne,2),le=re[0],ie=re[1],oe=(0,c.useRef)(!1),ce=(0,c.useRef)([]),se=(0,c.useMemo)(function(){return(l.sortorder||[]).filter(function(e){return"number"==typeof e})},[l.sortorder]),ue=(0,c.useMemo)(function(){return(l.sortorder||[]).filter(function(e){return"string"==typeof e&&e.startsWith("a")}).map(function(e){return parseInt(e.substring(1))})},[l.sortorder]),me=(0,J.qZ)(se,{enabled:se.length>0}),de=me.data,ge=void 0===de?[]:de,pe=me.isLoading,ye=(0,f.uI)({get_all:!0}),_e=ye.data,he=ye.isLoading,ve=(null==_e?void 0:_e.albums)||[],xe=(0,c.useMemo)(function(){return ve.filter(function(e){return ue.includes(e.id)})},[ve,ue]),Ee=(0,c.useMemo)(function(){return ge.map(function(e){var t;return{id:e.gid,galleryTitle:e.title||e.name||"",count:(null===(t=e.images)||void 0===t||null===(t=t.length)||void 0===t?void 0:t.toString())||"0",thumbnail:e.previewpic_url||"",shortcode:'[imagely id="'.concat(e.gid,'"]'),eCommerce:"1"===e.is_ecommerce_enabled,is_private:e.is_private,created:e.date_created,modified:e.date_modified,displayType:e.display_type}})},[ge]),we=(0,c.useMemo)(function(){if(pe||he)return!0;if(l.sortorder&&l.sortorder.length>0){var e=Ee.length>0||!l.sortorder.some(function(e){return"number"==typeof e}),t=xe.length>0||!l.sortorder.some(function(e){return"string"==typeof e&&e.startsWith("a")});if(!e||!t)return 0===w.length}return!1},[pe,he,Ee.length,xe.length,l.sortorder,w.length]),Ne=(0,O.FR)((0,O.MS)(O.AN,{activationConstraint:{distance:8,delay:100,tolerance:10}}),(0,O.MS)(O.uN,{coordinateGetter:T.JR}));(0,c.useEffect)(function(){if(!oe.current)if((Ee.length>0||xe.length>0)&&l.sortorder&&l.sortorder.length>0){var e=l.sortorder.map(function(e){if("string"==typeof e&&e.startsWith("a")){var t=parseInt(e.substring(1)),n=xe.find(function(e){return e.id===t});if(n)return{id:e,type:"album",title:n.albumTitle,count:n.count.toString(),thumbnail:n.thumbnail,shortcode:n.shortcode,created:n.created,modified:n.modified,displayType:n.displayType}}else{var r=Ee.find(function(t){return t.id===e});if(r)return{id:r.id,type:"gallery",title:r.galleryTitle,count:r.count,thumbnail:r.thumbnail,shortcode:r.shortcode,eCommerce:r.eCommerce,is_private:r.is_private,created:r.created,modified:r.modified,displayType:r.displayType}}return null}).filter(Boolean);C(e)}else l.sortorder&&0===l.sortorder.length&&C([])},[Ee.length,xe.length,l.sortorder]),(0,c.useEffect)(function(){ce.current=w},[w]);var Ce=(0,c.useCallback)(function(){var e=(0,S.A)(fe().m(function e(n){var r,a,l,i,c,s,m,b;return fe().w(function(e){for(;;)switch(e.p=e.n){case 0:if(r=n.active,a=n.over,G(null),!a||r.id===a.id){e.n=5;break}return l=ce.current,i=l.findIndex(function(e){return e.id===r.id}),c=l.findIndex(function(e){return e.id===a.id}),s=(0,T.be)(l,i,c),m=s.map(function(e){return e.id}),C(s),u("sortorder",m),e.p=1,e.n=2,p.mutateAsync({id:t,data:{sortorder:m}});case 2:d((0,o.__)("Album order updated!","nggallery")),e.n=4;break;case 3:e.p=3,b=e.v,g((0,o.__)("Failed to save album order: "+b,"nggallery"));case 4:window.navigator.vibrate&&window.navigator.vibrate([50,50,50]);case 5:setTimeout(function(){oe.current=!1},100);case 6:return e.a(2)}},e,null,[[1,3]])}));return function(t){return e.apply(this,arguments)}}(),[u,t,p,d,g]),ke=(0,c.useCallback)(function(e){P(function(t){var n=new Set(t);return n.has(e)?n.delete(e):n.add(e),n})},[]),Ae=(0,c.useCallback)(function(){var e=(0,S.A)(fe().m(function e(n,a){var i,c,s,m;return fe().w(function(e){for(;;)switch(e.p=e.n){case 0:return i=[].concat((0,r.A)(n),(0,r.A)(a.map(function(e){return"a".concat(e)}))),c=[].concat((0,r.A)(l.sortorder),(0,r.A)(i)),u("sortorder",c),e.p=1,e.n=2,p.mutateAsync({id:t,data:{sortorder:c}});case 2:s=n.length+a.length,d((0,o.sprintf)((0,o.__)("%d item(s) added to album!","nggallery"),s)),e.n=4;break;case 3:e.p=3,m=e.v,g((0,o.__)("Failed to add items to album: "+m,"nggallery"));case 4:return e.a(2)}},e,null,[[1,3]])}));return function(t,n){return e.apply(this,arguments)}}(),[l.sortorder,u,t,p,d,g]),Se=function(){var e=(0,S.A)(fe().m(function e(){var n,r,a,i,c;return fe().w(function(e){for(;;)switch(e.p=e.n){case 0:return r=Array.from(j),a=(null===(n=l.sortorder)||void 0===n?void 0:n.filter(function(e){return!r.includes(e)}))||[],u("sortorder",a),C(function(e){return e.filter(function(e){return!r.includes(e.id)})}),P(new Set),e.p=1,e.n=2,p.mutateAsync({id:t,data:{sortorder:a}});case 2:i=r.length,d(1===i?(0,o.__)("Item removed from album!","nggallery"):(0,o.sprintf)((0,o.__)("%d items removed from album!","nggallery"),i)),e.n=4;break;case 3:e.p=3,c=e.v,g((0,o.__)("Failed to update album: "+c,"nggallery"));case 4:return e.a(2)}},e,null,[[1,3]])}));return function(){return e.apply(this,arguments)}}(),Oe=w.length,Te=Math.ceil(Oe/v),je=(le-1)*v,Pe=je+v,Ie=w.slice(je,Pe),Fe=(0,c.useCallback)(function(e){ie(e),P(new Set)},[]);(0,c.useEffect)(function(){le>Te&&Te>0&&ie(1)},[Te,le]);var De=(0,c.useMemo)(function(){return Ie.map(function(e){return e.id})},[Ie]),Ge=D?w.find(function(e){return e.id===D}):null,Me=(0,c.useMemo)(function(){return w.filter(function(e){return"gallery"===e.type}).map(function(e){return e.id})},[w]),ze=(0,c.useMemo)(function(){return w.filter(function(e){return"album"===e.type}).map(function(e){return parseInt(e.id.substring(1))})},[w]),Le=(0,c.useMemo)(function(){return(null==_?void 0:_.previewpic_url)||null},[_]),Be=(0,c.useCallback)(function(){var e=(0,S.A)(fe().m(function e(t,n){var r,a,l,i,c,s,u,m,d,p,b;return fe().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,l=null===(r=window.imagelyApp)||void 0===r?void 0:r.nonce,e.n=1,M()({path:"/wp/v2/pages/".concat(t,"?context=edit"),method:"GET",headers:{"X-WP-Nonce":l}});case 1:if(i=e.v,c=(null===(a=i.content)||void 0===a?void 0:a.raw)||"",s=new RegExp("\\[imagely[^\\]]*album=[\"']?".concat(n,"[\"']?[^\\]]*\\]"),"i"),u=new RegExp("\\[ngg[^\\]]*album=[\"']?".concat(n,"[\"']?[^\\]]*\\]"),"i"),!s.test(c)&&!u.test(c)){e.n=2;break}return e.a(2);case 2:return m='[imagely album="'.concat(n,'"]'),d=""===c.trim()?m:"".concat(c,"\n\n").concat(m),e.n=3,M()({path:"/wp/v2/pages/".concat(t),method:"POST",data:{content:d},headers:{"X-WP-Nonce":l}});case 3:e.n=5;break;case 4:e.p=4,b=e.v,console.error("Failed to insert album shortcode into page:",b),p=(null==b?void 0:b.message)||(0,o.__)("Unknown error occurred","nggallery"),g((0,o.__)("Failed to insert album shortcode into page: ","nggallery")+p);case 5:return e.a(2)}},e,null,[[0,4]])}));return function(t,n){return e.apply(this,arguments)}}(),[g]),Re=(0,c.useCallback)(function(){var e=(0,S.A)(fe().m(function e(n){var r,a;return fe().w(function(e){for(;;)switch(e.p=e.n){case 0:return r=l.pageid,e.p=1,e.n=2,p.mutateAsync({id:t,data:{name:n.name,description:n.description,pageid:n.pageid}});case 2:if(u("name",n.name),u("description",n.description),u("pageid",n.pageid),!n.pageid||n.pageid===r){e.n=3;break}return e.n=3,Be(n.pageid,t);case 3:d((0,o.__)("Album updated successfully!","nggallery")),e.n=5;break;case 4:e.p=4,a=e.v,g((0,o.__)("Failed to update album: "+a,"nggallery"));case 5:return e.a(2)}},e,null,[[1,4]])}));return function(t){return e.apply(this,arguments)}}(),[t,l.pageid,p,u,Be,d,g]),We=(0,c.useCallback)(function(){var e=(0,S.A)(fe().m(function e(n){var r;return fe().w(function(e){for(;;)switch(e.p=e.n){case 0:return u("preview_image_id",n),e.p=1,e.n=2,p.mutateAsync({id:t,data:{preview_image_id:n}});case 2:d((0,o.__)("Preview image updated!","nggallery")),e.n=4;break;case 3:e.p=3,r=e.v,console.error("Failed to update preview image:",r);case 4:return e.a(2)}},e,null,[[1,3]])}));return function(t){return e.apply(this,arguments)}}(),[t,u,p,d]);return s().createElement("div",{className:"space-y-6 px-6 py-6 lg:px-8 lg:py-8"},s().createElement(ee,{albumName:l.name||"",previewImageUrl:Le,itemCount:w.length,onEditClick:function(){return H(!0)},onImageClick:function(){return te(!0)}}),s().createElement("div",null,s().createElement("div",{className:"flex items-center justify-between mb-4"},s().createElement("h4",{className:"text-sm font-medium text-gray-900"},(0,o.__)("Selected Items","nggallery")," (",Oe,")"),s().createElement("div",{className:"flex items-center space-x-2"},j.size>0&&s().createElement("button",{onClick:Se,className:"px-3 py-1 bg-red-600 text-white rounded-md hover:bg-red-700 text-sm"},(0,o.__)("Remove Selected","nggallery")," (",j.size,")"),Ie.length>1&&s().createElement("button",{onClick:function(){j.size===Ie.length?P(new Set):P(new Set(Ie.map(function(e){return e.id})))},className:"px-3 py-1 bg-blue-100 text-blue-700 rounded-md hover:bg-blue-200 text-sm"},j.size===Ie.length?(0,o.__)("Deselect All","nggallery"):(0,o.__)("Select All","nggallery")))),we?s().createElement("div",{className:"p-12 flex justify-center"},s().createElement(N.A,{size:"lg",text:(0,o.__)("Loading album content...","nggallery")})):Oe>0?s().createElement("div",{className:"space-y-6"},s().createElement(O.Mp,{sensors:Ne,collisionDetection:O.fp,onDragStart:function(e){oe.current=!0,G(e.active.id),window.navigator.vibrate&&window.navigator.vibrate(50)},onDragEnd:Ce,measuring:{droppable:{strategy:O.Pf.Always}}},s().createElement(T.gB,{items:De,strategy:T.kL},s().createElement("div",{className:"grid gap-6 grid-cols-[repeat(auto-fill,_160px)]"},s().createElement("div",{className:"w-40 h-32 border-2 border-dashed border-green-300 rounded-lg flex flex-col items-center justify-center cursor-pointer hover:border-green-400 hover:bg-green-50 transition-colors group",onClick:function(){return R(!0)}},s().createElement("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center mb-2 group-hover:bg-green-200 transition-colors"},s().createElement(i.c1,{className:"w-5 h-5 text-green-500 group-hover:text-green-600"})),s().createElement("span",{className:"text-sm text-green-500 group-hover:text-green-600 font-medium"},(0,o.__)("Add Item","nggallery"))),Ie.map(function(e){return s().createElement(ae,{key:e.id,item:e,isSelected:j.has(e.id),onSelect:ke})}))),s().createElement(O.Hd,null,Ge&&s().createElement("div",{className:"transform scale-105 opacity-90 pointer-events-none"},s().createElement(ae,{item:Ge,isSelected:j.has(Ge.id),onSelect:ke})))),!we&&Te>1&&s().createElement(b.A,{currentPage:le,totalPages:Te,perPage:v,total:Oe,onPageChange:Fe,itemLabel:(0,o.__)("Items","nggallery")})):s().createElement("div",null,s().createElement("div",{className:"mb-4"},s().createElement("div",{className:"w-32 h-24 border-2 border-dashed border-green-300 rounded-lg flex flex-col items-center justify-center cursor-pointer hover:border-green-400 hover:bg-green-50 transition-colors group inline-flex",onClick:function(){return R(!0)}},s().createElement("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center mb-1 group-hover:bg-green-200 transition-colors"},s().createElement(i.c1,{className:"w-5 h-5 text-green-500 group-hover:text-green-600"})),s().createElement("span",{className:"text-sm text-green-500 group-hover:text-green-600 font-medium"},(0,o.__)("Add Item","nggallery")))),s().createElement("p",{className:"text-gray-500 text-sm"},(0,o.__)("No content in this album yet. Click the button above to add galleries or albums.","nggallery")))),s().createElement(Z,{isOpen:B,onClose:function(){return R(!1)},excludeGalleryIds:Me,excludeAlbumIds:[t].concat((0,r.A)(ze)),onConfirm:Ae}),s().createElement(W,{isOpen:q,onClose:function(){return H(!1)},onSave:Re,initialData:{name:l.name||"",description:l.description||"",pageid:l.pageid||null}}),s().createElement(Y,{isOpen:Q,onClose:function(){return te(!1)},onSelect:We,albumSortorder:l.sortorder||[],currentImageId:l.preview_image_id||null}))};var he=n(1966),ve=n(5316),xe=n(6629),Ee=n(1552),we=n(4707),Ne=n(6415),Ce=n(1548),ke=n(5258);function Ae(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function l(n,r,a,l){var c=r&&r.prototype instanceof o?r:o,s=Object.create(c.prototype);return Se(s,"_invoke",function(n,r,a){var l,o,c,s=0,u=a||[],m=!1,d={p:0,n:0,v:e,a:g,f:g.bind(e,4),d:function(t,n){return l=t,o=0,c=e,d.n=n,i}};function g(n,r){for(o=n,c=r,t=0;!m&&s&&!a&&t<u.length;t++){var a,l=u[t],g=d.p,p=l[2];n>3?(a=p===r)&&(c=l[(o=l[4])?5:(o=3,3)],l[4]=l[5]=e):l[0]<=g&&((a=n<2&&g<l[1])?(o=0,d.v=r,d.n=l[1]):g<p&&(a=n<3||l[0]>r||r>p)&&(l[4]=n,l[5]=r,d.n=p,o=0))}if(a||n>1)return i;throw m=!0,r}return function(a,u,p){if(s>1)throw TypeError("Generator is already running");for(m&&1===u&&g(u,p),o=u,c=p;(t=o<2?e:c)||!m;){l||(o?o<3?(o>1&&(d.n=-1),g(o,c)):d.n=c:d.v=c);try{if(s=2,l){if(o||(a="next"),t=l[a]){if(!(t=t.call(l,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,o<2&&(o=0)}else 1===o&&(t=l.return)&&t.call(l),o<2&&(c=TypeError("The iterator does not provide a '"+a+"' method"),o=1);l=e}else if((t=(m=d.n<0)?c:n.call(r,d))!==i)break}catch(t){l=e,o=1,c=t}finally{s=1}}return{value:t,done:m}}}(n,a,l),!0),s}var i={};function o(){}function c(){}function s(){}t=Object.getPrototypeOf;var u=[][r]?t(t([][r]())):(Se(t={},r,function(){return this}),t),m=s.prototype=o.prototype=Object.create(u);function d(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,Se(e,a,"GeneratorFunction")),e.prototype=Object.create(m),e}return c.prototype=s,Se(m,"constructor",s),Se(s,"constructor",c),c.displayName="GeneratorFunction",Se(s,a,"GeneratorFunction"),Se(m),Se(m,a,"Generator"),Se(m,r,function(){return this}),Se(m,"toString",function(){return"[object Generator]"}),(Ae=function(){return{w:l,m:d}})()}function Se(e,t,n,r){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}Se=function(e,t,n,r){function l(t,n){Se(e,t,function(e){return this._invoke(t,n,e)})}t?a?a(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(l("next",0),l("throw",1),l("return",2))},Se(e,t,n,r)}var Oe=n(9667);function Te(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function je(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Te(Object(n),!0).forEach(function(t){(0,l.A)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Te(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Pe(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function l(n,r,a,l){var c=r&&r.prototype instanceof o?r:o,s=Object.create(c.prototype);return Ie(s,"_invoke",function(n,r,a){var l,o,c,s=0,u=a||[],m=!1,d={p:0,n:0,v:e,a:g,f:g.bind(e,4),d:function(t,n){return l=t,o=0,c=e,d.n=n,i}};function g(n,r){for(o=n,c=r,t=0;!m&&s&&!a&&t<u.length;t++){var a,l=u[t],g=d.p,p=l[2];n>3?(a=p===r)&&(c=l[(o=l[4])?5:(o=3,3)],l[4]=l[5]=e):l[0]<=g&&((a=n<2&&g<l[1])?(o=0,d.v=r,d.n=l[1]):g<p&&(a=n<3||l[0]>r||r>p)&&(l[4]=n,l[5]=r,d.n=p,o=0))}if(a||n>1)return i;throw m=!0,r}return function(a,u,p){if(s>1)throw TypeError("Generator is already running");for(m&&1===u&&g(u,p),o=u,c=p;(t=o<2?e:c)||!m;){l||(o?o<3?(o>1&&(d.n=-1),g(o,c)):d.n=c:d.v=c);try{if(s=2,l){if(o||(a="next"),t=l[a]){if(!(t=t.call(l,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,o<2&&(o=0)}else 1===o&&(t=l.return)&&t.call(l),o<2&&(c=TypeError("The iterator does not provide a '"+a+"' method"),o=1);l=e}else if((t=(m=d.n<0)?c:n.call(r,d))!==i)break}catch(t){l=e,o=1,c=t}finally{s=1}}return{value:t,done:m}}}(n,a,l),!0),s}var i={};function o(){}function c(){}function s(){}t=Object.getPrototypeOf;var u=[][r]?t(t([][r]())):(Ie(t={},r,function(){return this}),t),m=s.prototype=o.prototype=Object.create(u);function d(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,Ie(e,a,"GeneratorFunction")),e.prototype=Object.create(m),e}return c.prototype=s,Ie(m,"constructor",s),Ie(s,"constructor",c),c.displayName="GeneratorFunction",Ie(s,a,"GeneratorFunction"),Ie(m),Ie(m,a,"Generator"),Ie(m,r,function(){return this}),Ie(m,"toString",function(){return"[object Generator]"}),(Pe=function(){return{w:l,m:d}})()}function Ie(e,t,n,r){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}Ie=function(e,t,n,r){function l(t,n){Ie(e,t,function(e){return this._invoke(t,n,e)})}t?a?a(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(l("next",0),l("throw",1),l("return",2))},Ie(e,t,n,r)}var Fe=[{id:"photocrati-nextgen_basic_compact_album",name:(0,o.__)("Compact Album","nggallery"),icon:s().createElement("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-full h-full",viewBox:"0 0 120 98"},s().createElement("rect",{x:"8",y:"12",width:"32",height:"22",fill:"currentColor"}),s().createElement("rect",{x:"44",y:"12",width:"32",height:"22",fill:"currentColor"}),s().createElement("rect",{x:"80",y:"12",width:"32",height:"22",fill:"currentColor"}),s().createElement("rect",{x:"8",y:"38",width:"32",height:"22",fill:"currentColor"}),s().createElement("rect",{x:"44",y:"38",width:"32",height:"22",fill:"currentColor"}),s().createElement("rect",{x:"80",y:"38",width:"32",height:"22",fill:"currentColor"}),s().createElement("rect",{x:"8",y:"64",width:"32",height:"22",fill:"currentColor"}),s().createElement("rect",{x:"44",y:"64",width:"32",height:"22",fill:"currentColor"}),s().createElement("rect",{x:"80",y:"64",width:"32",height:"22",fill:"currentColor"}))},{id:"photocrati-nextgen_basic_extended_album",name:(0,o.__)("Extended Album","nggallery"),icon:s().createElement("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-full h-full",viewBox:"0 0 120 98"},s().createElement("rect",{x:"8",y:"12",width:"104",height:"20",fill:"currentColor"}),s().createElement("rect",{x:"8",y:"38",width:"104",height:"20",fill:"currentColor"}),s().createElement("rect",{x:"8",y:"64",width:"104",height:"20",fill:"currentColor"}))},{id:"photocrati-nextgen_pro_grid_album",name:(0,o.__)("Grid Album","nggallery"),icon:s().createElement("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-full h-full",viewBox:"0 0 120 98",fill:"currentColor"},s().createElement("rect",{x:"8",y:"12",width:"32",height:"22"}),s().createElement("rect",{x:"44",y:"12",width:"32",height:"22"}),s().createElement("rect",{x:"80",y:"12",width:"32",height:"22"}),s().createElement("rect",{x:"8",y:"38",width:"32",height:"22"}),s().createElement("rect",{x:"44",y:"38",width:"32",height:"22"}),s().createElement("rect",{x:"80",y:"38",width:"32",height:"22"}),s().createElement("rect",{x:"8",y:"64",width:"32",height:"22"}),s().createElement("rect",{x:"44",y:"64",width:"32",height:"22"}),s().createElement("rect",{x:"80",y:"64",width:"32",height:"22"}),s().createElement("circle",{cx:"14",cy:"18",r:"2",fill:"white"}),s().createElement("circle",{cx:"50",cy:"18",r:"2",fill:"white"}),s().createElement("circle",{cx:"86",cy:"18",r:"2",fill:"white"}))},{id:"photocrati-nextgen_pro_list_album",name:(0,o.__)("List Album","nggallery"),icon:s().createElement("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-full h-full",viewBox:"0 0 120 98",fill:"currentColor"},s().createElement("rect",{x:"8",y:"16",width:"20",height:"15"}),s().createElement("rect",{x:"32",y:"16",width:"80",height:"4"}),s().createElement("rect",{x:"32",y:"23",width:"60",height:"3"}),s().createElement("rect",{x:"8",y:"41",width:"20",height:"15"}),s().createElement("rect",{x:"32",y:"41",width:"80",height:"4"}),s().createElement("rect",{x:"32",y:"48",width:"60",height:"3"}),s().createElement("rect",{x:"8",y:"66",width:"20",height:"15"}),s().createElement("rect",{x:"32",y:"66",width:"80",height:"4"}),s().createElement("rect",{x:"32",y:"73",width:"60",height:"3"}))},{id:"imagely-pro-search",name:(0,o.__)("Search","nggallery"),icon:s().createElement("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-full h-full",viewBox:"0 0 120 98",fill:"currentColor"},s().createElement("rect",{x:"8",y:"12",width:"85",height:"6",rx:"3"}),s().createElement("circle",{cx:"102",cy:"15",r:"6"}),s().createElement("path",{d:"m104 17 6 6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}),s().createElement("rect",{x:"8",y:"28",width:"32",height:"22"}),s().createElement("rect",{x:"44",y:"28",width:"32",height:"22"}),s().createElement("rect",{x:"80",y:"28",width:"32",height:"22"}),s().createElement("rect",{x:"8",y:"54",width:"32",height:"22"}),s().createElement("rect",{x:"44",y:"54",width:"32",height:"22"}),s().createElement("rect",{x:"80",y:"54",width:"32",height:"22"}))}];const De=function(e){var t,n=e.albumId,r=e.previewMode,i=e.onPreviewModeChange,u=be(),m=u.formData,d=u.updateField,g=u.saveForm,p=u.isDirty,b=u.album,f=(0,v.useDispatch)(h.E),y=(0,c.useState)(null),_=(0,a.A)(y,2),x=_[0],E=_[1],w=(null===(t=window.imagelyApp)||void 0===t?void 0:t.proTypeInstalled)||"lite",N=function(e){var t=["photocrati-nextgen_basic_compact_album","photocrati-nextgen_basic_extended_album"],n=[].concat(t,["photocrati-nextgen_pro_grid_album","photocrati-nextgen_pro_list_album","imagely-pro-search"]);switch(e){case"pro":case"plus":return n;default:return t}}(w);(0,c.useEffect)(function(){m.display_type||d("display_type","photocrati-nextgen_basic_compact_album")},[m.display_type,d]);var C,k=(0,c.useCallback)(function(e){switch(e){case"photocrati-nextgen_basic_compact_album":return{open_gallery_in_lightbox:!1,gallery_display_type:"photocrati-nextgen_basic_thumbnails",galleries_per_page:20,enable_breadcrumbs:!0,enable_descriptions:!1,display_view:"default",template:"default",override_thumbnail_settings:1,thumbnail_width:240,thumbnail_height:160,thumbnail_crop:1,animate_images_enable:!1,animate_images_style:"wobble",animate_images_duration:1500,animate_images_delay:250,animate_pagination_enable:!1,animate_pagination_style:"flipInX",animate_pagination_duration:1500,animate_pagination_delay:250,is_ecommerce_enabled:0};case"photocrati-nextgen_basic_extended_album":return{open_gallery_in_lightbox:!1,gallery_display_type:"photocrati-nextgen_basic_thumbnails",galleries_per_page:20,enable_breadcrumbs:!0,enable_descriptions:!1,display_view:"default",template:"default",override_thumbnail_settings:1,thumbnail_width:300,thumbnail_height:200,thumbnail_crop:1,animate_images_enable:!1,animate_images_style:"wobble",animate_images_duration:1500,animate_images_delay:250,animate_pagination_enable:!1,animate_pagination_style:"flipInX",animate_pagination_duration:1500,animate_pagination_delay:250,is_ecommerce_enabled:0};case"photocrati-nextgen_pro_grid_album":return{gallery_display_type:"photocrati-nextgen_pro_thumbnail_grid",background_color:"#FFFFFF",border_color:"#CCCCCC",border_size:1,caption_color:"#333333",caption_size:13,display_type_view:"default",enable_breadcrumbs:!0,enable_descriptions:!1,padding:20,spacing:10,open_gallery_in_lightbox:0,override_thumbnail_settings:0,thumbnail_crop:1,thumbnail_height:160,thumbnail_quality:100,thumbnail_watermark:0,thumbnail_width:240,animate_images_enable:!1,animate_images_style:"wobble",animate_images_duration:1500,animate_images_delay:250,animate_pagination_enable:!1,animate_pagination_style:"flipInX",animate_pagination_duration:"1500",animate_pagination_delay:"250",is_ecommerce_enabled:0};case"photocrati-nextgen_pro_list_album":return{gallery_display_type:"photocrati-nextgen_pro_thumbnail_grid",background_color:"#FFFFFF",border_color:"#CCCCCC",border_size:1,caption_color:"#333333",caption_size:18,description_color:"#333333",description_size:13,display_type_view:"default",enable_breadcrumbs:!0,enable_descriptions:!1,padding:20,spacing:10,open_gallery_in_lightbox:0,override_thumbnail_settings:0,thumbnail_crop:1,thumbnail_height:160,thumbnail_quality:100,thumbnail_watermark:0,thumbnail_width:240,animate_images_enable:!1,animate_images_style:"wobble",animate_images_duration:1500,animate_images_delay:250,animate_pagination_enable:!1,animate_pagination_style:"flipInX",animate_pagination_duration:"1500",animate_pagination_delay:"250",is_ecommerce_enabled:0};case"imagely-pro-search":return{search_mode:"natural",enable_tag_filter:!0,search_alttext:!0,search_description:!0,search_tags:!0,limit:0,order_by:"pid",order_direction:"ASC",order_by_relevance:!0,minimum_relevance:1,gallery_display_type:"photocrati-nextgen_basic_thumbnails"};default:return{gallery_display_type:"photocrati-nextgen_basic_thumbnails",enable_breadcrumbs:!0,enable_descriptions:!1,use_lightbox_effect:!0}}},[]),A=(0,D.I)({queryKey:["display-types"],queryFn:(C=(0,S.A)(Ae().m(function e(){var t,n;return Ae().w(function(e){for(;;)switch(e.n){case 0:return n=null===(t=window.imagelyApp)||void 0===t?void 0:t.nonce,e.n=1,M()({path:"/imagely/v1/display-types",method:"GET",headers:{"X-WP-Nonce":n}});case 1:return e.a(2,e.v)}},e)})),function(){return C.apply(this,arguments)}),staleTime:3e5,gcTime:6e5}),O=(0,c.useMemo)(function(){var e=A.data;return e?Object.values(e).filter(function(e){return Array.isArray(e.entity_types)&&e.entity_types.includes("image")}).filter(function(e){return"photocrati-nextgen_basic_singlepic"!==e.name}).map(function(e){return{value:e.name,label:(e.title||"").replace(/NextGEN\s*/gi,"").trim()}}):[]},[A.data]),T=(0,c.useMemo)(function(){var e=A.data;return e?Object.values(e).filter(function(e){return Array.isArray(e.entity_types)&&e.entity_types.includes("image")}).map(function(e){return{value:e.name,label:(e.title||"").replace(/NextGEN\s*/gi,"").trim()}}):[]},[A.data]),j=(0,c.useCallback)((0,S.A)(Pe().m(function e(){var t;return Pe().w(function(e){for(;;)switch(e.p=e.n){case 0:if(!p||!n){e.n=4;break}return e.p=1,e.n=2,g();case 2:e.n=4;break;case 3:e.p=3,t=e.v,console.error("Auto-save failed:",t);case 4:return e.a(2)}},e,null,[[1,3]])})),[p,n,g]);(0,c.useEffect)(function(){if(p){var e=setTimeout(j,1e3);return function(){return clearTimeout(e)}}},[m,j,p]);var I=(0,c.useMemo)(function(){return null!=b&&b.sortorder&&0!==b.sortorder.length?b.sortorder.join("-"):"empty"},[null==b?void 0:b.sortorder]),G=(0,c.useMemo)(function(){var e;if(!b)return b;var t=b.display_type||"photocrati-nextgen_pro_grid_album",n=k(t),r=(null===(e=b.display_type_settings)||void 0===e?void 0:e[t])||{},a=je(je({},n),r);return je(je({},b),{},{display_type_settings:je(je({},b.display_type_settings),{},(0,l.A)({},t,a))})},[b,k]),z=(0,Oe.b)({type:"album",item:G,itemId:n,cacheKey:I}),L=function(e,t){var n,r=m.display_type,a=je(je({},m.display_type_settings),{},(0,l.A)({},r,je(je({},(null===(n=m.display_type_settings)||void 0===n?void 0:n[r])||{}),{},(0,l.A)({},e,t))));d("display_type_settings",a)},B=x&&!N.includes(x);return s().createElement("div",{className:"bg-white rounded-lg shadow lg:grid lg:grid-cols-2 lg:items-start"},s().createElement("div",{className:"px-4 py-4 border-b lg:border-b-0 lg:border-r"},s().createElement("div",{className:"space-y-4"},s().createElement("h1",{className:"text-lg font-medium"},(0,o.__)("Album Settings","nggallery")),s().createElement(he.A,{title:(0,o.__)("Choose Layout","nggallery"),defaultExpanded:!0,className:"mb-4"},s().createElement("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-5 gap-2 sm:gap-4"},Fe.map(function(e){var t=N.includes(e.id),n=(x||m.display_type)===e.id;return s().createElement("div",{key:e.id,className:"flex flex-col items-center text-center"},s().createElement("div",{className:"relative p-1 border rounded-md cursor-pointer transition-all duration-200 w-full ".concat(n?"border-green-500":t?"border-gray-600 hover:border-green-500":"border-gray-200 hover:border-green-500"),onClick:function(){return t=e.id,E(t),void(N.includes(t)&&d("display_type",t));var t}},s().createElement("div",{className:"flex items-center justify-center ".concat(n?"text-gray-600":"text-gray-200 hover:text-gray-600")},s().createElement("div",{className:"w-12 h-8 sm:w-16 sm:h-12 flex items-center justify-center"},e.icon))),s().createElement("h3",{className:"text-xs font-medium mt-1 sm:mt-2 ".concat(t?"text-gray-300":"text-gray-400")},e.name))}))),s().createElement("div",{className:B?"opacity-50 pointer-events-none":""},s().createElement(he.A,{title:(0,o.__)("Customize Album Look","nggallery"),defaultExpanded:!0,className:"mb-4"},function(){var e,t,n,r,a,l,i,c,u,d,g,p,b=(null===(e=m.display_type_settings)||void 0===e?void 0:e[m.display_type])||{};switch(m.display_type){case"photocrati-nextgen_basic_compact_album":case"photocrati-nextgen_basic_extended_album":default:return t=b,s().createElement("div",{className:"space-y-4"},"pro"===h.W||"plus"===h.W?s().createElement(Ne.A,{id:"open-gallery-in-pro-lightbox",name:"open_gallery_in_lightbox",checked:!!t.open_gallery_in_lightbox,onChange:function(e){return L("open_gallery_in_lightbox",e.target.checked)},label:(0,o.__)("Open gallery in Pro Lightbox","nggallery"),help:(0,o.__)("Open child galleries directly in Pro Lightbox instead of navigating.","nggallery")}):null,!t.open_gallery_in_lightbox&&s().createElement(P.A,{id:"gallery-display-type",name:"gallery_display_type",value:t.gallery_display_type||"photocrati-nextgen_basic_thumbnails",onChange:function(e){return L("gallery_display_type",e.target.value)},label:(0,o.__)("Display galleries as","nggallery"),help:(0,o.__)("How would you like galleries to be displayed?","nggallery")},O.map(function(e){return s().createElement("option",{key:e.value,value:e.value},e.label)})),s().createElement(F.A,{type:"number",name:"galleries_per_page",value:String(null!==(n=t.galleries_per_page)&&void 0!==n?n:20),onChange:function(e){return L("galleries_per_page",parseInt(e.target.value))},label:(0,o.__)("Items per page","nggallery"),help:(0,o.__)("Maximum number of galleries or sub-albums to appear on a single page","nggallery"),min:0,max:200}),s().createElement(Ne.A,{id:"enable-breadcrumbs",name:"enable_breadcrumbs",checked:!1!==t.enable_breadcrumbs,onChange:function(e){return L("enable_breadcrumbs",e.target.checked)},label:(0,o.__)("Enable breadcrumbs","nggallery")}),s().createElement("input",{type:"hidden",name:"display_view",value:"default"}),s().createElement(Ee.A,{prefix:"album",value:null!==(r=t.template)&&void 0!==r?r:"default",onChange:function(e){return L("template",e.target.value)}}),s().createElement(Ne.A,{id:"enable-descriptions",name:"enable_descriptions",checked:!!t.enable_descriptions,onChange:function(e){return L("enable_descriptions",e.target.checked)},label:(0,o.__)("Display descriptions","nggallery")}),s().createElement(Ne.A,{id:"override_thumbnail_settings",name:"override_thumbnail_settings",checked:!!t.override_thumbnail_settings,onChange:function(e){return L("override_thumbnail_settings",e.target.checked)},label:(0,o.__)("Override thumbnail settings","nggallery"),help:(0,o.__)("This does not affect existing thumbnails; overriding the thumbnail settings will create an additional set of thumbnails. To change the size of existing thumbnails please visit 'Manage Galleries' and choose 'Create new thumbnails' for all images in the gallery.","nggallery")}),t.override_thumbnail_settings?s().createElement("div",{className:"ml-6 space-y-4"},s().createElement(xe.A,{htmlFor:"thumbnail_dimensions",help:(0,o.__)("These are maximum values","nggallery")},(0,o.__)("Thumbnail dimensions","nggallery")),s().createElement("div",{className:"flex gap-4"},s().createElement(F.A,{type:"number",name:"thumbnail_width",value:String(null!==(a=t.thumbnail_width)&&void 0!==a?a:240),onChange:function(e){return L("thumbnail_width",parseInt(e.target.value))}}),s().createElement(F.A,{type:"number",name:"thumbnail_height",value:String(null!==(l=t.thumbnail_height)&&void 0!==l?l:160),onChange:function(e){return L("thumbnail_height",parseInt(e.target.value))}})),s().createElement(Ne.A,{id:"thumbnail_crop",name:"thumbnail_crop",checked:!!t.thumbnail_crop,onChange:function(e){return L("thumbnail_crop",e.target.checked)},label:(0,o.__)("Thumbnail crop","nggallery")})):null,s().createElement(Ce.Y,{formState:{animate_images_enable:!!t.animate_images_enable,animate_images_style:null!==(i=t.animate_images_style)&&void 0!==i?i:"wobble",animate_images_duration:String(null!==(c=t.animate_images_duration)&&void 0!==c?c:1500),animate_images_delay:String(null!==(u=t.animate_images_delay)&&void 0!==u?u:250),animate_pagination_enable:!!t.animate_pagination_enable,animate_pagination_style:null!==(d=t.animate_pagination_style)&&void 0!==d?d:"flipInX",animate_pagination_duration:String(null!==(g=t.animate_pagination_duration)&&void 0!==g?g:1500),animate_pagination_delay:String(null!==(p=t.animate_pagination_delay)&&void 0!==p?p:250)},handleInputChange:function(e){var t,n=(e.target||{}).name,r=e.target&&"checked"in e.target?e.target.checked:null===(t=e.target)||void 0===t?void 0:t.value;/duration|delay/.test(n)&&(r=parseInt(r)),L(n,r)}}),"pro"===w?s().createElement(Ne.A,{id:"enable-ecommerce",name:"is_ecommerce_enabled",checked:!!t.is_ecommerce_enabled,onChange:function(e){return L("is_ecommerce_enabled",e.target.checked)},label:(0,o.__)("Enable eCommerce","nggallery")}):s().createElement("div",{className:"relative"},s().createElement("div",{className:"opacity-50 pointer-events-none"},s().createElement(Ne.A,{id:"enable-ecommerce",name:"is_ecommerce_enabled",checked:!1,onChange:function(){},label:(0,o.__)("Enable eCommerce","nggallery")})),s().createElement("div",{className:"absolute inset-0 cursor-pointer",onClick:function(){return f.setActiveModal("upgrade",{feature:"eCommerce features"})},title:(0,o.__)("Requires NextGEN Gallery Pro","nggallery")})));case"photocrati-nextgen_pro_grid_album":return function(e){var t,n,r,a,l,i,c,u,m,d,g,p,b,y,_,h;return s().createElement("div",{className:"space-y-4"},s().createElement(Ne.A,{id:"open_gallery_in_lightbox_grid",name:"open_gallery_in_lightbox",checked:!!e.open_gallery_in_lightbox,onChange:function(e){return L("open_gallery_in_lightbox",e.target.checked?1:0)},label:(0,o.__)("Open gallery in Pro Lightbox","nggallery"),help:(0,o.__)("Open child galleries directly in Pro Lightbox instead of navigating.","nggallery")}),!e.open_gallery_in_lightbox&&s().createElement(P.A,{id:"gallery-display-type-grid",name:"gallery_display_type",value:e.gallery_display_type||(null===(t=O[0])||void 0===t?void 0:t.value)||"",onChange:function(e){return L("gallery_display_type",e.target.value)},label:(0,o.__)("Display galleries as","nggallery"),help:(0,o.__)("How would you like galleries to be displayed?","nggallery")},O.map(function(e){return s().createElement("option",{key:e.value,value:e.value},e.label)})),s().createElement("div",{className:"grid grid-cols-2 gap-4"},s().createElement(F.A,{type:"number",name:"spacing",value:String(null!==(n=e.spacing)&&void 0!==n?n:10),onChange:function(e){return L("spacing",parseInt(e.target.value))},label:(0,o.__)("Spacing","nggallery"),min:0,max:50}),s().createElement(F.A,{type:"number",name:"padding",value:String(null!==(r=e.padding)&&void 0!==r?r:20),onChange:function(e){return L("padding",parseInt(e.target.value))},label:(0,o.__)("Padding","nggallery"),min:0,max:100})),s().createElement(F.A,{type:"number",name:"border_size",value:String(null!==(a=e.border_size)&&void 0!==a?a:1),onChange:function(e){return L("border_size",parseInt(e.target.value))},label:(0,o.__)("Border size","nggallery")}),s().createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},(0,o.__)("Border color","nggallery")),s().createElement(ve.e,{color:null!==(l=e.border_color)&&void 0!==l?l:"#CCCCCC",onChange:function(e){return L("border_color",e)}}),s().createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},(0,o.__)("Background color","nggallery")),s().createElement(ve.e,{color:null!==(i=e.background_color)&&void 0!==i?i:"#FFFFFF",onChange:function(e){return L("background_color",e)}}),s().createElement(F.A,{type:"number",name:"caption_size",value:String(null!==(c=e.caption_size)&&void 0!==c?c:13),onChange:function(e){return L("caption_size",parseInt(e.target.value))},label:(0,o.__)("Caption size","nggallery")}),s().createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},(0,o.__)("Caption color","nggallery")),s().createElement(ve.e,{color:null!==(u=e.caption_color)&&void 0!==u?u:"#333333",onChange:function(e){return L("caption_color",e)}}),s().createElement("input",{type:"hidden",name:"display_type_view",value:"default"}),s().createElement(Ne.A,{id:"override_thumbnail_settings_grid",name:"override_thumbnail_settings",checked:!!e.override_thumbnail_settings,onChange:function(e){return L("override_thumbnail_settings",e.target.checked?1:0)},label:(0,o.__)("Override thumbnail settings","nggallery"),help:(0,o.__)("This does not affect existing thumbnails; overriding the thumbnail settings will create an additional set of thumbnails.","nggallery")}),e.override_thumbnail_settings?s().createElement("div",{className:"ml-6 space-y-4"},s().createElement(xe.A,{htmlFor:"thumbnail_dimensions",help:(0,o.__)("These are maximum values","nggallery")},(0,o.__)("Thumbnail dimensions","nggallery")),s().createElement("div",{className:"flex gap-4"},s().createElement(F.A,{type:"number",name:"thumbnail_width",value:String(null!==(m=e.thumbnail_width)&&void 0!==m?m:240),onChange:function(e){return L("thumbnail_width",parseInt(e.target.value))}}),s().createElement(F.A,{type:"number",name:"thumbnail_height",value:String(null!==(d=e.thumbnail_height)&&void 0!==d?d:160),onChange:function(e){return L("thumbnail_height",parseInt(e.target.value))}})),s().createElement(Ne.A,{id:"thumbnail_crop_grid",name:"thumbnail_crop",checked:!!e.thumbnail_crop,onChange:function(e){return L("thumbnail_crop",e.target.checked?1:0)},label:(0,o.__)("Thumbnail crop","nggallery")})):null,s().createElement(Ne.A,{id:"enable_breadcrumbs_grid",name:"enable_breadcrumbs",checked:!1!==e.enable_breadcrumbs,onChange:function(e){return L("enable_breadcrumbs",e.target.checked)},label:(0,o.__)("Enable breadcrumbs","nggallery")}),"pro"===w?s().createElement(Ne.A,{id:"enable-ecommerce-grid",name:"is_ecommerce_enabled",checked:!!e.is_ecommerce_enabled,onChange:function(e){return L("is_ecommerce_enabled",e.target.checked?1:0)},label:(0,o.__)("Enable eCommerce","nggallery")}):s().createElement("div",{className:"relative"},s().createElement("div",{className:"opacity-50 pointer-events-none"},s().createElement(Ne.A,{id:"enable-ecommerce-grid",name:"is_ecommerce_enabled",checked:!1,onChange:function(){},label:(0,o.__)("Enable eCommerce","nggallery")})),s().createElement("div",{className:"absolute inset-0 cursor-pointer",onClick:function(){return f.setActiveModal("upgrade",{feature:"eCommerce features"})},title:(0,o.__)("Requires NextGEN Gallery Pro","nggallery")})),s().createElement(Ce.Y,{formState:{animate_images_enable:!!e.animate_images_enable,animate_images_style:null!==(g=e.animate_images_style)&&void 0!==g?g:"wobble",animate_images_duration:String(null!==(p=e.animate_images_duration)&&void 0!==p?p:1500),animate_images_delay:String(null!==(b=e.animate_images_delay)&&void 0!==b?b:250),animate_pagination_enable:!!e.animate_pagination_enable,animate_pagination_style:null!==(y=e.animate_pagination_style)&&void 0!==y?y:"flipInX",animate_pagination_duration:String(null!==(_=e.animate_pagination_duration)&&void 0!==_?_:1500),animate_pagination_delay:String(null!==(h=e.animate_pagination_delay)&&void 0!==h?h:250)},handleInputChange:function(e){var t,n=(e.target||{}).name,r=e.target&&"checked"in e.target?e.target.checked:null===(t=e.target)||void 0===t?void 0:t.value;/duration|delay/.test(n)&&(r=parseInt(r)),L(n,r)},hidePagination:!0}))}(b);case"photocrati-nextgen_pro_list_album":return function(e){var t,n,r,a,l,i,c,u,m,d,g,p,b,y,_,h,v,x;return s().createElement("div",{className:"space-y-4"},s().createElement(Ne.A,{id:"open_gallery_in_lightbox_list",name:"open_gallery_in_lightbox",checked:!!e.open_gallery_in_lightbox,onChange:function(e){return L("open_gallery_in_lightbox",e.target.checked?1:0)},label:(0,o.__)("Open gallery in Pro Lightbox","nggallery"),help:(0,o.__)("Open child galleries directly in Pro Lightbox instead of navigating.","nggallery")}),!e.open_gallery_in_lightbox&&s().createElement(P.A,{id:"gallery-display-type-list",name:"gallery_display_type",value:e.gallery_display_type||(null===(t=O[0])||void 0===t?void 0:t.value)||"",onChange:function(e){return L("gallery_display_type",e.target.value)},label:(0,o.__)("Display galleries as","nggallery"),help:(0,o.__)("How would you like galleries to be displayed?","nggallery")},O.map(function(e){return s().createElement("option",{key:e.value,value:e.value},e.label)})),s().createElement("div",{className:"grid grid-cols-2 gap-4"},s().createElement(F.A,{type:"number",name:"spacing",value:String(null!==(n=e.spacing)&&void 0!==n?n:10),onChange:function(e){return L("spacing",parseInt(e.target.value))},label:(0,o.__)("Spacing","nggallery"),min:0,max:50}),s().createElement(F.A,{type:"number",name:"padding",value:String(null!==(r=e.padding)&&void 0!==r?r:20),onChange:function(e){return L("padding",parseInt(e.target.value))},label:(0,o.__)("Padding","nggallery"),min:0,max:100})),s().createElement(F.A,{type:"number",name:"border_size",value:String(null!==(a=e.border_size)&&void 0!==a?a:1),onChange:function(e){return L("border_size",parseInt(e.target.value))},label:(0,o.__)("Border size","nggallery")}),s().createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},(0,o.__)("Border color","nggallery")),s().createElement(ve.e,{color:null!==(l=e.border_color)&&void 0!==l?l:"#CCCCCC",onChange:function(e){return L("border_color",e)}}),s().createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},(0,o.__)("Background color","nggallery")),s().createElement(ve.e,{color:null!==(i=e.background_color)&&void 0!==i?i:"#FFFFFF",onChange:function(e){return L("background_color",e)}}),s().createElement("div",{className:"grid grid-cols-2 gap-4"},s().createElement(F.A,{type:"number",name:"caption_size",value:String(null!==(c=e.caption_size)&&void 0!==c?c:18),onChange:function(e){return L("caption_size",parseInt(e.target.value))},label:(0,o.__)("Caption size","nggallery"),min:10,max:30}),s().createElement(F.A,{type:"number",name:"description_size",value:String(null!==(u=e.description_size)&&void 0!==u?u:13),onChange:function(e){return L("description_size",parseInt(e.target.value))},label:(0,o.__)("Description size","nggallery"),min:10,max:24})),s().createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},(0,o.__)("Caption color","nggallery")),s().createElement(ve.e,{color:null!==(m=e.caption_color)&&void 0!==m?m:"#333333",onChange:function(e){return L("caption_color",e)}}),s().createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},(0,o.__)("Description color","nggallery")),s().createElement(ve.e,{color:null!==(d=e.description_color)&&void 0!==d?d:"#333333",onChange:function(e){return L("description_color",e)}}),s().createElement("input",{type:"hidden",name:"display_type_view",value:"default"}),s().createElement(Ne.A,{id:"override_thumbnail_settings_list",name:"override_thumbnail_settings",checked:!!e.override_thumbnail_settings,onChange:function(e){return L("override_thumbnail_settings",e.target.checked?1:0)},label:(0,o.__)("Override thumbnail settings","nggallery"),help:(0,o.__)("This does not affect existing thumbnails; overriding the thumbnail settings will create an additional set of thumbnails.","nggallery")}),e.override_thumbnail_settings?s().createElement("div",{className:"ml-6 space-y-4"},s().createElement(xe.A,{htmlFor:"thumbnail_dimensions_list",help:(0,o.__)("These are maximum values","nggallery")},(0,o.__)("Thumbnail dimensions","nggallery")),s().createElement("div",{className:"flex gap-4"},s().createElement(F.A,{type:"number",name:"thumbnail_width",value:String(null!==(g=e.thumbnail_width)&&void 0!==g?g:240),onChange:function(e){return L("thumbnail_width",parseInt(e.target.value))}}),s().createElement(F.A,{type:"number",name:"thumbnail_height",value:String(null!==(p=e.thumbnail_height)&&void 0!==p?p:160),onChange:function(e){return L("thumbnail_height",parseInt(e.target.value))}})),s().createElement(Ne.A,{id:"thumbnail_crop_list",name:"thumbnail_crop",checked:!!e.thumbnail_crop,onChange:function(e){return L("thumbnail_crop",e.target.checked?1:0)},label:(0,o.__)("Thumbnail crop","nggallery")})):null,s().createElement(Ne.A,{id:"enable_breadcrumbs_list",name:"enable_breadcrumbs",checked:!1!==e.enable_breadcrumbs,onChange:function(e){return L("enable_breadcrumbs",e.target.checked)},label:(0,o.__)("Enable breadcrumbs","nggallery")}),s().createElement(Ne.A,{id:"enable-descriptions-list",name:"enable_descriptions",checked:!!e.enable_descriptions,onChange:function(e){return L("enable_descriptions",e.target.checked)},label:(0,o.__)("Enable descriptions","nggallery")}),"pro"===w?s().createElement(Ne.A,{id:"enable-ecommerce-list",name:"is_ecommerce_enabled",checked:!!e.is_ecommerce_enabled,onChange:function(e){return L("is_ecommerce_enabled",e.target.checked?1:0)},label:(0,o.__)("Enable eCommerce","nggallery")}):s().createElement("div",{className:"relative"},s().createElement("div",{className:"opacity-50 pointer-events-none"},s().createElement(Ne.A,{id:"enable-ecommerce-list",name:"is_ecommerce_enabled",checked:!1,onChange:function(){},label:(0,o.__)("Enable eCommerce","nggallery")})),s().createElement("div",{className:"absolute inset-0 cursor-pointer",onClick:function(){return f.setActiveModal("upgrade",{feature:"eCommerce features"})},title:(0,o.__)("Requires NextGEN Gallery Pro","nggallery")})),s().createElement(Ce.Y,{formState:{animate_images_enable:!!e.animate_images_enable,animate_images_style:null!==(b=e.animate_images_style)&&void 0!==b?b:"wobble",animate_images_duration:String(null!==(y=e.animate_images_duration)&&void 0!==y?y:1500),animate_images_delay:String(null!==(_=e.animate_images_delay)&&void 0!==_?_:250),animate_pagination_enable:!!e.animate_pagination_enable,animate_pagination_style:null!==(h=e.animate_pagination_style)&&void 0!==h?h:"flipInX",animate_pagination_duration:String(null!==(v=e.animate_pagination_duration)&&void 0!==v?v:1500),animate_pagination_delay:String(null!==(x=e.animate_pagination_delay)&&void 0!==x?x:250)},handleInputChange:function(e){var t,n=(e.target||{}).name,r=e.target&&"checked"in e.target?e.target.checked:null===(t=e.target)||void 0===t?void 0:t.value;/duration|delay/.test(n)&&(r=parseInt(r)),L(n,r)}}))}(b);case"imagely-pro-search":return function(e){var t,n,r;return s().createElement("div",{className:"space-y-4"},s().createElement(P.A,{id:"search-gallery-display-type",name:"gallery_display_type",value:e.gallery_display_type||(null===(t=T[0])||void 0===t?void 0:t.value)||"",onChange:function(e){return L("gallery_display_type",e.target.value)},label:(0,o.__)("Display results as","nggallery")},T.map(function(e){return s().createElement("option",{key:e.value,value:e.value},e.label)})),s().createElement(P.A,{id:"search-mode",name:"search_mode",value:e.search_mode||"natural",onChange:function(e){return L("search_mode",e.target.value)},label:(0,o.__)("Database search mode","nggallery")},s().createElement("option",{value:"natural"},(0,o.__)("Natural language","nggallery")),s().createElement("option",{value:"boolean"},(0,o.__)("Boolean","nggallery"))),s().createElement("div",{className:"grid grid-cols-2 gap-4"},s().createElement(F.A,{type:"number",name:"limit",value:String(null!==(n=e.limit)&&void 0!==n?n:0),onChange:function(e){return L("limit",parseInt(e.target.value))},label:(0,o.__)("Limit search results","nggallery"),help:(0,o.__)("Limit search results to this amount. A setting of zero means no limitations are applied","nextgen-gallery-pro"),min:0}),s().createElement(P.A,{id:"order-by",name:"order_by",value:e.order_by||"pid",onChange:function(e){return L("order_by",e.target.value)},label:(0,o.__)("Order search results by","nggallery")},s().createElement("option",{value:"pid"},(0,o.__)("Image ID","nggallery")),s().createElement("option",{value:"galleryid"},(0,o.__)("Gallery ID","nggallery")),s().createElement("option",{value:"filename"},(0,o.__)("Image filename","nggallery")),s().createElement("option",{value:"imagedate"},(0,o.__)("Image date (EXIF or time of upload)","nggallery")))),s().createElement("div",{className:"grid grid-cols-2 gap-4"},s().createElement(P.A,{id:"order-direction",name:"order_direction",value:e.order_direction||"ASC",onChange:function(e){return L("order_direction",e.target.value)},label:(0,o.__)("Order direction of search results","nggallery")},s().createElement("option",{value:"ASC"},(0,o.__)("Ascending","nggallery")),s().createElement("option",{value:"DESC"},(0,o.__)("Descending","nggallery"))),s().createElement(Ne.A,{id:"order-by-relevance",name:"order_by_relevance",checked:!1!==e.order_by_relevance,onChange:function(e){return L("order_by_relevance",e.target.checked)},label:(0,o.__)("Order by relevance first","nggallery"),help:(0,o.__)("When enabled search results will be ordered by their relevance first, then by the secondary order setting","nextgen-gallery-pro")})),s().createElement(F.A,{type:"number",name:"minimum_relevance",value:String(null!==(r=e.minimum_relevance)&&void 0!==r?r:1),onChange:function(e){return L("minimum_relevance",parseFloat(e.target.value))},label:(0,o.__)("Minimum relevance","nggallery"),help:(0,o.__)("The database server assigns a relevance score to each possible image based on a number of factors with zero being not at all relevant. Users with smaller databases or images whose alttext or description only holds a few words will need a lower number here; possibly as low as 0.05. It is unlikely many users will need to raise this beyond one.","nextgen-gallery-pro"),min:0,max:10}),s().createElement(Ne.A,{id:"search-alttext",name:"search_alttext",checked:!1!==e.search_alttext,onChange:function(e){return L("search_alttext",e.target.checked)},label:(0,o.__)("Search image alttext","nggallery")}),s().createElement(Ne.A,{id:"search-description",name:"search_description",checked:!1!==e.search_description,onChange:function(e){return L("search_description",e.target.checked)},label:(0,o.__)("Search image description","nggallery")}),s().createElement(Ne.A,{id:"search-tags",name:"search_tags",checked:!1!==e.search_tags,onChange:function(e){return L("search_tags",e.target.checked)},label:(0,o.__)("Search image tags","nggallery")}),s().createElement(Ne.A,{id:"enable-tag-filter",name:"enable_tag_filter",checked:!1!==e.enable_tag_filter,onChange:function(e){return L("enable_tag_filter",e.target.checked)},label:(0,o.__)("Enable filtering results by tag","nggallery")}))}(b)}}())))),s().createElement("div",{className:"px-4 py-4 lg:sticky lg:top-6 lg:max-h-screen"},B?s().createElement(ke.A,null):s().createElement(we.A,{previewMode:r,onPreviewModeChange:i,url:z,title:(0,o.__)("Album Preview","nggallery")})))},Ge=function(e){var t=e.currentTab,n=e.albumId,r=e.album,a=e.previewMode,l=e.onPreviewModeChange;switch(t){case"galleries":default:return s().createElement(_e,{albumId:n,album:r});case"customize":case"settings":return s().createElement(De,{albumId:n,album:r,previewMode:a,onPreviewModeChange:l})}};var Me=["galleries","settings"],ze=function(e){var t=e.currentTab,n=e.setCurrentTab,r=e.albumId,a=e.album,l=e.previewMode,c=e.handlePreviewModeChange,u=e.handleNext,m=e.handleCancel,d=e.nextButtonText,g=e.navigateTo,p=e.isFirstTab,b=e.isEmbed;return s().createElement("div",{className:"px-4 md:px-6 lg:px-8 py-4 md:py-6 pb-24"},!b&&s().createElement("div",{className:"mb-6 flex items-center gap-3"},s().createElement("button",{onClick:function(){return g("imagely-albums","general")},className:"flex items-center justify-center w-8 h-8 rounded-md hover:bg-gray-100 transition-colors"},s().createElement(i.Kj,{className:"w-5 h-5"})),s().createElement("h1",{className:"text-2xl font-semibold text-gray-900"},(0,o.__)("Edit Album","nggallery"))),s().createElement("div",{className:"bg-white shadow rounded-md pt-4 md:pt-6 lg:pt-8"},s().createElement(w.A,{currentTab:t,onTabChange:n,containerClassName:"",contentClassName:"",headerComponent:function(){return s().createElement(A,{activeTab:t,onTabChange:n})}},s().createElement(Ge,{currentTab:t,albumId:r,album:a,previewMode:l,onPreviewModeChange:c}))),s().createElement(C,{onNext:u,onCancel:m,nextButtonText:d,isFirstTab:p}))};const Le=function(e){var t=e.albumId,n=(0,c.useState)("desktop"),r=(0,a.A)(n,2),l=r[0],u=r[1],m=(0,v.useDispatch)(h.E),d=(0,_.X)();(0,c.useEffect)(function(){t&&m&&m.setCurrentId(t)},[t,m]);var g=(0,f.$U)(t),p=g.data,b=g.isLoading,y=g.error,x=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).onComplete,t=(0,v.useDispatch)(h.E),n=(0,v.useSelect)(function(e){return{currentTab:e(h.E).getCurrentTab()}},[]).currentTab,r=Me,a=r.indexOf(n),l=0===a,i=a===r.length-1,o=(0,c.useCallback)(function(e){r.includes(e)&&t.setCurrentTab(e)},[t.setCurrentTab,r]),u=(0,c.useCallback)(function(e,n,r){t.navigateTo(e,n,r)},[t.navigateTo]),m=(0,c.useCallback)(function(){i?e&&e():o(r[a+1])},[i,a,r,o,e]),d=(0,c.useCallback)(function(){l||o(r[a-1])},[l,a,r,o]),g=(0,c.useCallback)(function(e){o(e)},[o]),p=(0,c.useMemo)(function(){return r.includes(n)?n:"galleries"},[n,r]),b=s().useRef(n);return s().useEffect(function(){b.current===p||r.includes(n)||o(p),b.current=n},[p,n,o,r]),{currentTab:p,setCurrentTab:o,goToNextTab:m,goToPreviousTab:d,goToTab:g,isFirstTab:l,isLastTab:i,tabIds:r,currentTabIndex:a,navigateTo:u}}({onComplete:function(){m&&m.showNotice("success",(0,o.__)("Album updated successfully","nggallery"))},enableTabValidation:!1}),E=x.currentTab,w=x.setCurrentTab,C=x.goToNextTab,k=x.goToPreviousTab,A=x.isFirstTab,S=x.isLastTab,O=x.navigateTo;return b?s().createElement(N.A,{size:"xl",text:(0,o.__)("Loading album...","nggallery")}):y||!p?s().createElement("div",{className:"p-6 min-h-screen"},s().createElement("div",{className:"bg-red-50 border border-red-200 rounded-md p-4"},s().createElement("div",{className:"flex"},s().createElement("div",{className:"flex-shrink-0"},s().createElement(i.IJ,{className:"h-5 w-5 text-red-400"})),s().createElement("div",{className:"ml-3"},s().createElement("h3",{className:"text-sm font-medium text-red-800"},(0,o.__)("Error loading album","nggallery")),s().createElement("div",{className:"mt-2 text-sm text-red-700"},y instanceof Error?y.message:(0,o.__)("Album not found","nggallery")))))):s().createElement(pe,{initialAlbum:p},s().createElement(ze,{currentTab:E,setCurrentTab:w,albumId:t,album:p,previewMode:l,handlePreviewModeChange:function(e){u(e)},handleNext:function(){if(S){if(d.isEmbed&&d.onInsertAlbum){try{d.onInsertAlbum(t)}catch(e){console.error("Failed to insert album:",e)}return}var e=(null==p?void 0:p.name)||"";m.setActiveModal("albumSuccess",{albumId:t,albumName:e})}else C()},handleCancel:function(){if(A)if(d.isEmbed&&d.onClose)try{d.onClose()}catch(e){console.error("Failed to close embed:",e)}else m.navigateTo("imagely-albums","general");else k()},nextButtonText:S?(0,o.__)("Update","nggallery"):(0,o.__)("Next step","nggallery"),navigateTo:O,isFirstTab:A,isEmbed:d.isEmbed}))};var Be=n(1648);const Re=function(){var e=(0,v.useDispatch)(h.E),t=window.imagelyApp.assetsURL+"/images/HeaderImage.png",n=window.imagelyApp.assetsURL+"/images/HeaderArrow.png";return React.createElement("div",{className:"mb-8 bg-white rounded-lg shadow-sm p-4 sm:p-6 lg:p-8 flex flex-col lg:flex-row lg:justify-between lg:items-center relative overflow-hidden"},React.createElement("div",{className:"w-full lg:max-w-[50%] relative z-10 mb-6 lg:mb-0"},React.createElement("h1",{className:"text-2xl sm:text-3xl font-semibold mb-2 text-gray-900"},(0,o.__)("Welcome to Imagely","nggallery")),React.createElement("p",{className:"text-sm sm:text-base text-gray-600 mb-4 sm:mb-6"},(0,o.__)("Let's get started by adding galleries to create your album","nggallery")),React.createElement("div",{className:"flex flex-col sm:flex-row sm:items-center gap-4"},React.createElement("button",{className:"bg-green-500 text-white hover:bg-green-600 px-4 sm:px-6 py-2.5 h-auto rounded-md text-sm font-medium w-full sm:w-auto transition-colors",onClick:function(){(0,Be.jP)()?e.setActiveModal("album"):e.setActiveModal("licenseRequired",{action:"create new albums"})}},(0,o.__)("Add a New Album","nggallery")),React.createElement("div",{className:"hidden sm:block w-12 h-12 relative -top-5"},React.createElement("img",{src:n,alt:"Decorative arrow",className:"w-full h-full object-contain"})))),React.createElement("div",{className:"w-full lg:absolute lg:inset-y-0 lg:right-0 lg:w-1/2 lg:h-full flex items-center justify-center"},React.createElement("img",{src:t,alt:"Album illustration",className:"w-full h-48 sm:h-64 lg:h-full object-contain lg:relative lg:left-20"})))},We=function(e){var t=e.isLoading,n=e.items,l=e.visibleColumns,m=e.selectedItems,d=e.onSelectAll,g=e.onSelectItem,p=e.columns,b=e.onSort,f=e.sortColumn,y=e.sortDirection,_=e.loadingContent,h=e.notFoundContent,v=e.dropdownContent,x=e.actionsHeaderLabel,E=e.actionCellRenderer,w=e.showSelection,C=!1!==(void 0===w||w),k=C&&n.length>0&&n.every(function(e){return m.has(e.id)}),A=(0,c.useState)(null),S=(0,a.A)(A,2),O=S[0],T=S[1],j=(0,c.useState)({column:f||null,direction:y||null}),P=(0,a.A)(j,2),I=P[0],F=P[1],D=s().createElement(N.A,{size:"md",text:(0,o.__)("Loading items...","nggallery")}),G=s().createElement("div",{className:"p-4 text-center text-gray-500 text-sm"},(0,o.__)("No items found.","nggallery")),M=p.filter(function(e){return l[e.key]}).length+(E||v?1:0)+(C?1:0);return s().createElement("div",{className:"bg-white rounded-b-lg shadow-sm"},s().createElement("div",{className:"overflow-x-auto"},s().createElement("table",{className:"w-full border-collapse min-w-[800px]"},s().createElement("thead",null,s().createElement("tr",{className:"border-b bg-gray-100"},C&&s().createElement("th",{className:"w-12 px-4 py-3 text-left"},s().createElement("input",{type:"checkbox",id:"select-all",name:"select-all",className:"rounded border-gray-300",checked:k,onChange:function(e){return d(e.target.checked)}})),p.map(function(e){var t,n,r=e.key,a=e.label,c=e.className;return l[r]&&s().createElement("th",{key:r,className:"px-4 py-3 text-left font-medium text-gray-600 text-sm cursor-pointer whitespace-nowrap ".concat(c||""),onClick:function(){return function(e){var t=p.find(function(t){return t.key===e});if(null!=t&&t.sortType){var n=null;return"backend"===t.sortType&&b?(n=I.column===e?"asc"===I.direction?"desc":"desc"===I.direction?null:"asc":"asc",F({column:n?e:null,direction:n}),b(e,n)):"frontend"===t.sortType&&(n=I.column===e?"asc"===I.direction?"desc":"desc"===I.direction?null:"asc":"asc",F({column:n?e:null,direction:n})),n}}(r)}},s().createElement("div",{className:"flex items-center"},(0,o.__)(a),(t=r,null!==(n=p.find(function(e){return e.key===t}))&&void 0!==n&&n.sortType?I.column!==t?s().createElement(i.oE,{className:"w-4 h-4 ml-1 text-gray-400"}):"asc"===I.direction?s().createElement(i.VB,{className:"w-4 h-4 ml-1 text-gray-900"}):s().createElement(i.R6,{className:"w-4 h-4 ml-1 text-gray-900"}):null)))}),(E||v)&&s().createElement("th",{className:"w-20 px-4 py-3 text-left font-medium text-gray-600 text-sm whitespace-nowrap"},x?(0,o.__)(x):(0,o.__)("Actions","nggallery")))),s().createElement("tbody",null,t?s().createElement("tr",null,s().createElement("td",{colSpan:M},_||D)):0===n.length?s().createElement("tr",null,s().createElement("td",{colSpan:M},h||G)):function(){if(!I.column||!I.direction||!Array.isArray(n))return n||[];var e=p.find(function(e){return e.key===I.column});return null!=e&&e.sortType&&"frontend"===e.sortType?(0,r.A)(n).sort(function(e,t){var n=String(e[I.column]||"").toLowerCase(),r=String(t[I.column]||"").toLowerCase();return"asc"===I.direction?n.localeCompare(r):r.localeCompare(n)}):n||[]}().map(function(e){var t=!1!==e.canManage,n="border-b cursor-pointer ".concat(t?"hover:bg-gray-50":"opacity-50 hover:bg-gray-50/50");return s().createElement("tr",{key:e.id,className:n},C&&s().createElement("td",{className:"w-12 px-4 py-3"},s().createElement("input",{type:"checkbox",id:"item-".concat(e.id),name:"item-".concat(e.id),className:"rounded border-gray-300",checked:m.has(e.id),onChange:function(){return g(e.id)},disabled:!t})),p.map(function(t){var n=t.key,r=t.render,a=t.className;return l[n]&&s().createElement("td",{key:n,className:"px-4 py-3 whitespace-nowrap ".concat(a||"")},r?r(e):s().createElement("div",{className:"flex items-center gap-3"},s().createElement("span",{className:"font-medium text-gray-900 text-sm"},String(e[n]))))}),(E||v)&&s().createElement("td",{className:"w-20 px-4 py-3"},E?E(e):s().createElement(u.m,{isOpen:O===e.id,onClose:function(){return T(null)},onToggle:function(){return T(O===e.id?null:e.id)},trigger:s().createElement("button",{id:"quick-edit-".concat(e.id),className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-full",disabled:!t},s().createElement(i.xK,{className:"w-5 h-5"}))},v?v(e):s().createElement("div",{className:"py-1"},s().createElement("button",{className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100"},(0,o.__)("Quick Edit","nggallery")),s().createElement("button",{className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100"},(0,o.__)("Duplicate","nggallery")),s().createElement("button",{className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100"},(0,o.__)("Add to Album","nggallery")),s().createElement("button",{className:"block w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-gray-100"},(0,o.__)("Delete Item","nggallery"))))))})))))};function Xe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Ue(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Xe(Object(n),!0).forEach(function(t){(0,l.A)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Xe(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function qe(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function l(n,r,a,l){var c=r&&r.prototype instanceof o?r:o,s=Object.create(c.prototype);return He(s,"_invoke",function(n,r,a){var l,o,c,s=0,u=a||[],m=!1,d={p:0,n:0,v:e,a:g,f:g.bind(e,4),d:function(t,n){return l=t,o=0,c=e,d.n=n,i}};function g(n,r){for(o=n,c=r,t=0;!m&&s&&!a&&t<u.length;t++){var a,l=u[t],g=d.p,p=l[2];n>3?(a=p===r)&&(c=l[(o=l[4])?5:(o=3,3)],l[4]=l[5]=e):l[0]<=g&&((a=n<2&&g<l[1])?(o=0,d.v=r,d.n=l[1]):g<p&&(a=n<3||l[0]>r||r>p)&&(l[4]=n,l[5]=r,d.n=p,o=0))}if(a||n>1)return i;throw m=!0,r}return function(a,u,p){if(s>1)throw TypeError("Generator is already running");for(m&&1===u&&g(u,p),o=u,c=p;(t=o<2?e:c)||!m;){l||(o?o<3?(o>1&&(d.n=-1),g(o,c)):d.n=c:d.v=c);try{if(s=2,l){if(o||(a="next"),t=l[a]){if(!(t=t.call(l,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,o<2&&(o=0)}else 1===o&&(t=l.return)&&t.call(l),o<2&&(c=TypeError("The iterator does not provide a '"+a+"' method"),o=1);l=e}else if((t=(m=d.n<0)?c:n.call(r,d))!==i)break}catch(t){l=e,o=1,c=t}finally{s=1}}return{value:t,done:m}}}(n,a,l),!0),s}var i={};function o(){}function c(){}function s(){}t=Object.getPrototypeOf;var u=[][r]?t(t([][r]())):(He(t={},r,function(){return this}),t),m=s.prototype=o.prototype=Object.create(u);function d(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,He(e,a,"GeneratorFunction")),e.prototype=Object.create(m),e}return c.prototype=s,He(m,"constructor",s),He(s,"constructor",c),c.displayName="GeneratorFunction",He(s,a,"GeneratorFunction"),He(m),He(m,a,"Generator"),He(m,r,function(){return this}),He(m,"toString",function(){return"[object Generator]"}),(qe=function(){return{w:l,m:d}})()}function He(e,t,n,r){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}He=function(e,t,n,r){function l(t,n){He(e,t,function(e){return this._invoke(t,n,e)})}t?a?a(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(l("next",0),l("throw",1),l("return",2))},He(e,t,n,r)}const Ve=function(e){var t=e.isLoading,n=e.albums,r=e.visibleColumns,a=e.selectedAlbums,l=e.onSelectAll,c=e.onSelectAlbum,u=e.onSort,m=e.sortColumn,d=e.sortDirection,g=e.onDelete,p=e.onEdit,b=e.hasActiveSearch,f=void 0!==b&&b,y=(0,v.useDispatch)(h.E),_=function(){var e=(0,S.A)(qe().m(function e(t){var n;return qe().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,navigator.clipboard.writeText(t);case 1:y.showNotice("success",(0,o.__)("Shortcode copied to clipboard!","nggallery")),e.n=3;break;case 2:e.p=2,e.v,(n=document.createElement("textarea")).value=t,document.body.appendChild(n),n.select();try{document.execCommand("copy"),y.showNotice("success",(0,o.__)("Shortcode copied to clipboard!","nggallery"))}catch(e){y.showNotice("error",(0,o.__)("Failed to copy shortcode to clipboard","nggallery"))}document.body.removeChild(n);case 3:return e.a(2)}},e,null,[[0,2]])}));return function(t){return e.apply(this,arguments)}}(),E=f?s().createElement("div",{className:"py-16"},s().createElement("div",{className:"flex flex-col items-center justify-center text-center text-gray-500"},s().createElement("p",{className:"text-sm mb-2"},(0,o.__)("No results found for your search.","nggallery")))):s().createElement("div",{className:"py-16"},s().createElement("div",{className:"flex flex-col items-center justify-center text-center text-gray-500"},s().createElement("div",{className:"mb-4"},s().createElement(i.qX,{className:"w-16 h-16 opacity-60"})),s().createElement("p",{className:"text-sm mb-2"},(0,o.__)("No Albums so far!","nggallery")),s().createElement("button",{type:"button",className:"inline-flex items-center gap-1 text-green-500 hover:text-green-600 text-sm font-medium",onClick:function(){(0,Be.jP)()?y.setActiveModal("album"):y.setActiveModal("licenseRequired",{action:"create new albums"})}},(0,o.__)("Add New Album","nggallery"),s().createElement(i.c1,{className:"w-4 h-4"}))));return s().createElement(We,{isLoading:t,items:n,visibleColumns:r,selectedItems:a,onSelectAll:l,onSelectItem:c,columns:x().map(function(e){return Ue(Ue({},e),{},{render:function(t){return function(e,t){switch(t){case"id":return s().createElement("span",{className:"text-gray-600 text-sm"},e.id);case"albumTitle":return s().createElement("button",{onClick:function(){return function(e){p(e)}(e)},className:"font-medium text-gray-900 text-sm hover:underline"},e.albumTitle);case"thumbnail":return e.thumbnail?s().createElement("img",{src:e.thumbnail,alt:e.albumTitle,className:"w-12 h-12 object-cover rounded-md border border-gray-200"}):s().createElement("div",{className:"w-12 h-12 bg-gray-200 rounded-md border border-gray-200 flex items-center justify-center"},s().createElement("svg",{className:"w-6 h-6 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},s().createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})));case"shortcode":return s().createElement("button",{onClick:function(){return _(e.shortcode)},className:"bg-gray-100 px-3 py-1 rounded text-sm font-mono text-gray-600 hover:bg-gray-200 transition-colors cursor-pointer border-none",title:(0,o.__)("Click to copy shortcode","nggallery")},e.shortcode);case"count":return s().createElement("span",{className:"text-gray-600 text-sm"},e.count);case"created":return s().createElement("span",{className:"text-gray-600 text-sm"},e.created);case"modified":return s().createElement("span",{className:"text-gray-600 text-sm"},e.modified);case"displayType":return s().createElement("span",{className:"text-gray-600 text-sm"},e.displayType.replace("photocrati-nextgen_","").replace("_"," "));default:return null}}(t,e.key)}})}),onSort:u,sortColumn:m,sortDirection:d,notFoundContent:E,actionsHeaderLabel:(0,o.__)("Actions","nggallery"),actionCellRenderer:function(e){return s().createElement("div",{className:"flex flex-col items-center text-gray-500"},s().createElement("button",{type:"button",className:"flex flex-col items-center text-red-600 hover:text-red-700",onClick:function(){return function(e){g([e])}(e)}},s().createElement(i.AR,{className:"w-4 h-4 mb-1"}),s().createElement("span",{className:"text-xs"},(0,o.__)("Delete","nggallery"))))}})};var Ke=function(){var e=(0,c.useState)(""),t=(0,a.A)(e,2),n=t[0],l=t[1],u=function(e){var t=(0,c.useState)(e),n=(0,a.A)(t,2),r=n[0],l=n[1];return(0,c.useEffect)(function(){var t=setTimeout(function(){l(e)},300);return function(){clearTimeout(t)}},[e,300]),r}(n),m=(0,c.useState)(E),d=(0,a.A)(m,2),g=d[0],_=d[1],w=(0,c.useState)(new Set),N=(0,a.A)(w,2),C=N[0],k=N[1],A=(0,c.useState)("modified"),S=(0,a.A)(A,2),O=S[0],T=S[1],j=(0,c.useState)("desc"),P=(0,a.A)(j,2),I=P[0],F=P[1],D=(0,c.useState)(1),G=(0,a.A)(D,2),M=G[0],z=G[1],L=(0,y.UG)().data,B=(null==L?void 0:L.admin_table_per_page)||20,R=s().useMemo(function(){return{page:M,per_page:B,search:u||void 0,sort:O||void 0,order:I||void 0}},[M,B,u,O,I]),W=(0,f.uI)(R),X=W.data,U=W.isLoading,q=W.error,H=s().useMemo(function(){return(null==X?void 0:X.albums)||[]},[null==X?void 0:X.albums]),V=s().useMemo(function(){return(null==X?void 0:X.pagination)||{total:0,total_pages:1,per_page:B,current_page:1}},[null==X?void 0:X.pagination,B]),K=(0,v.useDispatch)(h.E);(0,c.useEffect)(function(){z(1)},[u]),(0,c.useEffect)(function(){k(new Set)},[M,B,u,O,I]),(0,c.useEffect)(function(){V.total_pages>0&&M>V.total_pages&&z(V.total_pages)},[V.total_pages,M]);var Y=s().useCallback(function(e){z(e),window.scrollTo({top:0,behavior:"smooth"})},[]),J=function(e){K.setActiveModal("deleteAlbums",{albums:e,onClose:function(){return K.setActiveModal(null)},onConfirm:function(){k(new Set)}})};return q?s().createElement("div",{className:"p-6 min-h-screen"},s().createElement(Re,null),s().createElement("div",{className:"bg-red-50 border border-red-200 rounded-md p-4"},s().createElement("div",{className:"flex"},s().createElement("div",{className:"flex-shrink-0"},s().createElement(i.IJ,{className:"h-5 w-5 text-red-400"})),s().createElement("div",{className:"ml-3"},s().createElement("h3",{className:"text-sm font-medium text-red-800"},(0,o.__)("Error loading albums","nggallery")),s().createElement("div",{className:"mt-2 text-sm text-red-700"},q instanceof Error?q.message:(0,o.__)("An unexpected error occurred","nggallery")))))):s().createElement("div",{className:"p-6 min-h-screen"},s().createElement(Re,null),s().createElement(p,{title:(0,o.__)("Manage Albums","nggallery"),searchTerm:n,setSearchTerm:l,onSearch:function(){},visibleColumns:g,setVisibleColumns:_,selectedItems:C,items:H,columns:(0,r.A)(x()),itemType:"album",searchPlaceholder:(0,o.__)("Search Albums","nggallery"),onDelete:J}),s().createElement(Ve,{isLoading:U,albums:H,visibleColumns:g,selectedAlbums:C,onSelectAll:function(e){k(e?new Set(H.map(function(e){return e.id})):new Set)},onSelectAlbum:function(e){var t=new Set(C);t.has(e)?t.delete(e):t.add(e),k(t)},onSort:function(e,t){T(t?{albumTitle:"name",created:"created",modified:"modified",id:"id",displayType:"display_type"}[e]||e:null),F(t),z(1)},sortColumn:O,sortDirection:I,onDelete:J,onEdit:function(e){K.setCurrentId(e.id),K.navigateTo("imagely-albums","galleries",e.id)},hasActiveSearch:!!u}),!U&&(V.total>0||u)&&s().createElement(b.A,{currentPage:M,totalPages:V.total_pages,perPage:V.per_page,total:V.total,onPageChange:Y,itemLabel:u?(0,o.__)("Results","nggallery"):(0,o.__)("Items","nggallery"),showItemCount:!0}))};const Ye=function(){var e=(0,_.X)(),t=(null==e?void 0:e.isEmbed)||!1,n=(0,v.useSelect)(function(e){return{currentId:e(h.E).getCurrentId()}},[]).currentId;return n?s().createElement(Le,{albumId:n}):t?null:s().createElement(Ke,null)}}}]);