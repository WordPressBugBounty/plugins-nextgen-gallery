/*! For license information please see 81.min.js.LICENSE.txt */
"use strict";(self.webpackChunk_envira_imagely_admin_app=self.webpackChunk_envira_imagely_admin_app||[]).push([[81],{9081:(e,t,n)=>{n.r(t),n.d(t,{default:()=>ot});var a=n(3453),r=n(5760),l=n(9292),i=n(6106),o=n(2329),c=n(2549),s=n(1648),u=n(7143),g=n(7723),m=n(1609),d=n.n(m);const p=function(e){var t=e.onNext,n=e.onCancel,r=e.nextButtonText,l=void 0===r?(0,g.__)("Next step","nggallery"):r,i=e.showNextButton,c=void 0===i||i,s=e.showCancelButton,u=void 0===s||s,p=e.isFirstTab,_=void 0===p||p,y=(0,o.X)(),f=(null==y?void 0:y.isEmbed)||!1,h=(0,m.useState)(160),b=(0,a.A)(h,2),v=b[0],E=b[1];return(0,m.useEffect)(function(){if(!f){var e=function(){var e=document.body,t=window.innerWidth;t<=782?E(0):t<=960||e.classList.contains("folded")?E(36):E(160)};e(),window.addEventListener("resize",e);var t=new MutationObserver(e);return t.observe(document.body,{attributes:!0,attributeFilter:["class"]}),function(){window.removeEventListener("resize",e),t.disconnect()}}E(0)},[f]),d().createElement("div",{className:"fixed bottom-0 right-0 bg-white border-t border-gray-200 z-10",style:{left:"".concat(v,"px"),maxWidth:"calc(100vw - ".concat(v,"px)")}},d().createElement("div",{className:"px-2 sm:px-4 py-3 sm:px-6"},d().createElement("div",{className:"flex justify-end items-center space-x-1 sm:space-x-3"},u&&d().createElement("button",{onClick:n,className:"px-2 sm:px-4 py-2 text-xs sm:text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"},_?(0,g.__)("Cancel","nggallery"):(0,g.__)("Back","nggallery")),c&&d().createElement("button",{onClick:t,className:"px-2 sm:px-4 py-2 text-xs sm:text-sm font-medium text-white bg-green-500 border border-green-500 rounded-md hover:bg-green-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition-colors"},l))))};var _=n(8168),y=n(467),f=n(4980),h=n(1966),b=n(2724),v=n(2416),E=n(9667);function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function x(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(Object(n),!0).forEach(function(t){(0,f.A)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var C=function(e){return e?{title:e.title||"",description:e.galdesc||"",display_type:e.display_type||"",display_type_settings:e.display_type_settings||{},settings:{gallery_display_type:e.display_type,gallery_override_global_settings:!1},imageSettings:{sortBy:"sortorder",sortOrder:"asc",selectedImages:[],searchQuery:""},isDirty:!1,lastSaved:new Date,dirtyFields:new Set}:{title:"",description:"",display_type:"",display_type_settings:{},settings:{},imageSettings:{sortBy:"sortorder",sortOrder:"asc",selectedImages:[],searchQuery:""},isDirty:!1,lastSaved:null,dirtyFields:new Set}},A=function(e,t){switch(t.type){case"INIT_FROM_GALLERY":case"RESET_TO_SAVED":return C(t.payload);case"UPDATE_FIELD":var n=t.payload,a=n.path,r=function(e,t,n){for(var a=t.split("."),r=x({},e),l=r,i=0;i<a.length-1;i++){var o=a[i];l[o]=l[o]?x({},l[o]):{},l=l[o]}return l[a[a.length-1]]=n,r}(e,a,n.value),l=new Set(e.dirtyFields);return l.add(a),x(x({},r),{},{isDirty:!0,dirtyFields:l});case"UPDATE_FIELDS":var i=new Set(e.dirtyFields);return Object.keys(t.payload).forEach(function(e){return i.add(e)}),x(x(x({},e),t.payload),{},{isDirty:!0,dirtyFields:i});case"UPDATE_DISPLAY_TYPE_SETTINGS":var o=t.payload,c=o.displayType,s=o.settings,u=x(x({},e.display_type_settings),{},(0,f.A)({},c,x(x({},e.display_type_settings[c]),s))),g=new Set(e.dirtyFields);return g.add("display_type_settings.".concat(c)),x(x({},e),{},{display_type_settings:u,isDirty:!0,dirtyFields:g});case"UPDATE_GALLERY_SETTINGS":var m=new Set(e.dirtyFields);return Object.keys(t.payload).forEach(function(e){return m.add("settings.".concat(e))}),x(x({},e),{},{settings:x(x({},e.settings),t.payload),isDirty:!0,dirtyFields:m});case"UPDATE_IMAGE_SETTINGS":return x(x({},e),{},{imageSettings:x(x({},e.imageSettings),t.payload)});case"MARK_CLEAN":return x(x({},e),{},{isDirty:!1,lastSaved:new Date,dirtyFields:new Set});default:return e}},k=(0,m.createContext)(null),S=function(e){var t=e.children,n=e.initialGallery,r=void 0===n?null:n,l=(0,m.useReducer)(A,null,function(){return C(r)}),i=(0,a.A)(l,2),o=i[0],c=i[1],s=(0,m.useRef)(new Map);(0,m.useEffect)(function(){r&&r.gid&&!o.lastSaved&&c({type:"INIT_FROM_GALLERY",payload:r})},[r,o.lastSaved]);var u=(0,m.useCallback)(function(e,t){c({type:"UPDATE_FIELD",payload:{path:e,value:t}})},[]),g=(0,m.useCallback)(function(e){c({type:"UPDATE_FIELDS",payload:e})},[]),p=(0,m.useCallback)(function(e,t){c({type:"UPDATE_DISPLAY_TYPE_SETTINGS",payload:{displayType:e,settings:t}})},[]),_=(0,m.useCallback)(function(e){c({type:"UPDATE_GALLERY_SETTINGS",payload:e})},[]),y=(0,m.useCallback)(function(e){c({type:"UPDATE_IMAGE_SETTINGS",payload:e})},[]),f=(0,m.useCallback)(function(e){c({type:"INIT_FROM_GALLERY",payload:e})},[]),h=(0,m.useCallback)(function(){c({type:"MARK_CLEAN"})},[]),b=(0,m.useCallback)(function(e){c({type:"RESET_TO_SAVED",payload:e})},[]),v=(0,m.useCallback)(function(){return Array.from(o.dirtyFields)},[o.dirtyFields]),E=(0,m.useCallback)(function(e){var t=e||o.display_type;return o.display_type_settings[t]||{}},[o.display_type_settings,o.display_type]),w=(0,m.useCallback)(function(){return E()},[E]),x=(0,m.useCallback)(function(e,t){s.current.set(e,t)},[]),S=(0,m.useCallback)(function(e){s.current.delete(e)},[]),N=(0,m.useCallback)(function(){s.current.forEach(function(e){try{e()}catch(e){console.error("Error flushing pending save:",e)}})},[]),T=(0,m.useMemo)(function(){return{state:o,updateField:u,updateFields:g,updateDisplayTypeSettings:p,updateGallerySettings:_,updateImageSettings:y,initFromGallery:f,markClean:h,resetToSaved:b,getDirtyFields:v,getDisplayTypeSettings:E,getCurrentDisplayTypeSettings:w,registerFlushCallback:x,unregisterFlushCallback:S,flushAllPendingSaves:N}},[o,u,g,p,_,y,f,h,b,v,E,w,x,S,N]);return d().createElement(k.Provider,{value:T},t)},N=function(){var e=(0,m.useContext)(k);if(!e)throw new Error("useGalleryForm must be used within a GalleryFormProvider. This indicates a component structure issue that should be fixed.");return e},T=n(8376),I=n(4707),O=n(9836),P=["photocrati-nextgen_basic_slideshow","photocrati-nextgen_basic_thumbnails","photocrati-nextgen_basic_imagebrowser","photocrati-nextgen_basic_tagcloud"],j=[].concat(P,["photocrati-nextgen_pro_film","photocrati-nextgen_pro_mosaic"]),D=n(5258),F=n(6629),G=n(1552),M=n(7899),z=n(5909),L=n(6415),R=n(1548),B=function(e){var t=e.formState,n=e.handleInputChange;return d().createElement(d().Fragment,null,d().createElement(F.A,{htmlFor:"maximum_dimensions",help:(0,g.__)("Certain themes may allow images to flow over their container if this setting is too large","nggallery")},(0,g.__)("Maximum dimensions","nggallery")),d().createElement("div",{className:"flex gap-2 items-center"},d().createElement("span",null,"w"),d().createElement(z.A,{type:"number",name:"gallery_width",value:t.gallery_width,onChange:n}),d().createElement("span",null,"/"),d().createElement(z.A,{type:"number",name:"gallery_height",value:t.gallery_height,onChange:n}),d().createElement("span",null,"h")),d().createElement(L.A,{id:"autoplay",name:"autoplay",checked:t.autoplay,onChange:n,label:(0,g.__)("Autoplay","nggallery")}),d().createElement(L.A,{id:"pauseonhover",name:"pauseonhover",checked:t.pauseonhover,onChange:n,label:(0,g.__)("Pause on Hover","nggallery")}),d().createElement(L.A,{id:"arrows",name:"arrows",checked:t.arrows,onChange:n,label:(0,g.__)("Show Arrows","nggallery")}),d().createElement(M.A,{id:"transition_style",name:"transition_style",value:t.transition_style,onChange:n,label:(0,g.__)("Transition Style","nggallery")},d().createElement("option",{value:"fade"},(0,g.__)("Fade","nggallery")),d().createElement("option",{value:"slide"},(0,g.__)("Slide","nggallery"))),d().createElement(z.A,{type:"number",name:"interval",value:t.interval,onChange:n,label:(0,g.__)("Interval","nggallery")}),d().createElement(z.A,{type:"number",name:"transition_speed",value:t.transition_speed,onChange:n,label:(0,g.__)("Transition Speed","nggallery")}),d().createElement(L.A,{id:"show_thumbnail_link",name:"show_thumbnail_link",checked:t.show_thumbnail_link,onChange:n,label:(0,g.__)("Show thumbnail link","nggallery")}),(0,O._w)(t.show_thumbnail_link)&&d().createElement("div",{className:"ml-6 space-y-4"},d().createElement(z.A,{type:"text",name:"thumbnail_link_text",value:t.thumbnail_link_text,onChange:n,label:(0,g.__)("Thumbnail link text","nggallery")})),d().createElement(G.A,{prefix:"gallery",value:t.template,onChange:n}),d().createElement(R.Y,{formState:t,handleInputChange:n,hidePagination:!0}))},q=function(e){var t=e.formState,n=e.handleInputChange;return d().createElement(L.A,{id:"ajax_pagination",name:"ajax_pagination",checked:t.ajax_pagination,onChange:n,label:(0,g.__)("Enable AJAX pagination","nggallery"),help:(0,g.__)("Browse images without reloading the page.","nggallery")})},K=function(e){var t=e.formState,n=e.handleInputChange;return d().createElement(M.A,{id:"ngg_triggers_display",name:"ngg_triggers_display",value:t.ngg_triggers_display,onChange:n,label:(0,g.__)("Display Triggers","nggallery")},d().createElement("option",{value:"never"},(0,g.__)("Never","nggallery")),d().createElement("option",{value:"always"},(0,g.__)("Always","nggallery")),d().createElement("option",{value:"exclude_mobile"},(0,g.__)("Exclude Mobile","nggallery")))},U=function(e){var t=e.formState,n=e.handleInputChange;return d().createElement(d().Fragment,null,d().createElement(L.A,{id:"override_thumbnail_settings",name:"override_thumbnail_settings",checked:t.override_thumbnail_settings,onChange:n,label:(0,g.__)("Override thumbnail settings","nggallery"),help:(0,g.__)("This does not affect existing thumbnails; overriding the thumbnail settings will create an additional set of thumbnails. To change the size of existing thumbnails please visit 'Manage Galleries' and choose 'Create new thumbnails' for all images in the gallery.","nggallery")}),(0,O._w)(t.override_thumbnail_settings)&&d().createElement("div",{className:"ml-6 space-y-4"},d().createElement(F.A,{htmlFor:"thumbnail_dimensions",help:(0,g.__)("These are maximum values","nggallery")},(0,g.__)("Thumbnail dimensions","nggallery")),d().createElement("div",{className:"flex gap-4"},d().createElement(z.A,{type:"number",name:"thumbnail_width",value:t.thumbnail_width,onChange:n}),d().createElement(z.A,{type:"number",name:"thumbnail_height",value:t.thumbnail_height,onChange:n})),d().createElement(L.A,{id:"thumbnail_crop",name:"thumbnail_crop",checked:t.thumbnail_crop,onChange:n,label:(0,g.__)("Thumbnail crop","nggallery")})),d().createElement(z.A,{type:"number",name:"images_per_page",value:t.images_per_page,onChange:n,label:(0,g.__)("Images per page","nggallery")}))},Y=function(e){var t=e.formState,n=e.handleInputChange,a=(0,u.useDispatch)(c.E);return"pro"===c.W?d().createElement(L.A,{id:"ngg_proofing_display",name:"ngg_proofing_display",checked:t.ngg_proofing_display,onChange:n,label:(0,g.__)("Enable proofing","nggallery"),help:(0,g.__)("Trigger buttons or hover captions need to be enabled for proofing to work","nggallery")}):d().createElement("div",{className:"relative"},d().createElement("div",{className:"opacity-50 pointer-events-none"},d().createElement(L.A,{id:"ngg_proofing_display",name:"ngg_proofing_display",checked:!1,onChange:function(){},label:(0,g.__)("Enable proofing","nggallery"),help:(0,g.__)("Trigger buttons or hover captions need to be enabled for proofing to work","nggallery")})),d().createElement("div",{className:"absolute inset-0 cursor-pointer",onClick:function(){a.setActiveModal("upgrade",{feature:"proofing features"})},title:(0,g.__)("Requires NextGEN Gallery Pro","nggallery")}))},W=function(e){var t=e.formState,n=e.handleInputChange;return d().createElement(d().Fragment,null,d().createElement(U,{formState:t,handleInputChange:n}),d().createElement(z.A,{type:"number",name:"number_of_columns",value:t.number_of_columns,onChange:n,label:(0,g.__)("Number of columns to display","nggallery"),help:(0,g.__)("An empty or zero in this field will use a responsive layout","nggallery")}),d().createElement(L.A,{id:"show_all_in_lightbox",name:"show_all_in_lightbox",checked:t.show_all_in_lightbox,onChange:n,label:(0,g.__)("Add hidden images","nggallery"),help:(0,g.__)("If pagination is used this option will show all images in the modal window (Thickbox, Lightbox etc.) This increases page load.","nggallery")}),d().createElement(L.A,{id:"use_imagebrowser_effect",name:"use_imagebrowser_effect",checked:t.use_imagebrowser_effect,onChange:n,label:(0,g.__)("Use imagebrowser effect","nggallery"),help:(0,g.__)("When active each image in the gallery will link to an imagebrowser display and lightbox effects will not be applied.","nggallery")}),d().createElement(L.A,{id:"show_slideshow_link",name:"show_slideshow_link",checked:t.show_slideshow_link,onChange:n,label:(0,g.__)("Show slideshow link","nggallery")}),(0,O._w)(t.show_slideshow_link)&&d().createElement("div",{className:"ml-6 space-y-4"},d().createElement(z.A,{type:"text",name:"slideshow_link_text",value:t.slideshow_link_text,onChange:n,label:(0,g.__)("Slideshow link text","nggallery")})),d().createElement("input",{type:"hidden",name:"display_view",value:"default"}),d().createElement(G.A,{prefix:"gallery",value:t.template,onChange:n}),d().createElement(Y,{formState:t,handleInputChange:n}),d().createElement(R.Y,{formState:t,handleInputChange:n}),d().createElement(K,{formState:t,handleInputChange:n}),d().createElement(q,{formState:t,handleInputChange:n}))},X=n(5316),Q=function(e){var t=e.formState,n=e.handleInputChange;return d().createElement(d().Fragment,null,d().createElement(L.A,{id:"captions_enabled",name:"captions_enabled",checked:t.captions_enabled,onChange:n,label:(0,g.__)("Enable caption overlay","nggallery")}),(0,O._w)(t.captions_enabled)&&d().createElement("div",{className:"ml-6 space-y-4"},d().createElement(L.A,{id:"captions_display_sharing",name:"captions_display_sharing",checked:t.captions_display_sharing,onChange:n,label:(0,g.__)("Display share icons","nggallery")}),d().createElement(L.A,{id:"captions_display_title",name:"captions_display_title",checked:t.captions_display_title,onChange:n,label:(0,g.__)("Display image title","nggallery")}),d().createElement(L.A,{id:"captions_display_description",name:"captions_display_description",checked:t.captions_display_description,onChange:n,label:(0,g.__)("Display image description","nggallery")}),d().createElement(M.A,{id:"captions_animation",name:"captions_animation",value:t.captions_animation,onChange:n,label:(0,g.__)("Animation type","nggallery")},d().createElement("option",{value:"fade"},(0,g.__)("Fade in","nggallery")),d().createElement("option",{value:"slideup"},(0,g.__)("Slide up","nggallery")),d().createElement("option",{value:"slidedown"},(0,g.__)("Slide down","nggallery")),d().createElement("option",{value:"slideleft"},(0,g.__)("Slide left","nggallery")),d().createElement("option",{value:"titlebar"},(0,g.__)("Titlebar","nggallery")),d().createElement("option",{value:"plain"},(0,g.__)("Plain","nggallery")))))},V=function(e){var t=e.formState,n=e.handleInputChange;return d().createElement(d().Fragment,null,d().createElement(U,{formState:t,handleInputChange:n}),d().createElement(z.A,{type:"number",name:"number_of_columns",value:t.number_of_columns,onChange:n,label:(0,g.__)("Number of columns to display","nggallery"),help:(0,g.__)("An empty or zero in this field will use a responsive layout","nggallery")}),d().createElement(z.A,{type:"number",name:"border_size",value:t.border_size,onChange:n,label:(0,g.__)("Border size","nggallery")}),d().createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},(0,g.__)("Border color","nggallery")),d().createElement(X.e,{color:t.border_color,onChange:function(e){return n({target:{name:"border_color",value:e}})}}),d().createElement(z.A,{type:"number",name:"spacing",value:t.spacing,onChange:n,label:(0,g.__)("Spacing","nggallery")}),d().createElement(M.A,{id:"display_type_view",name:"display_type_view",value:t.display_type_view,onChange:n,label:(0,g.__)("Select View","nggallery")},d().createElement("option",{value:"default"},(0,g.__)("Default","nggallery")),d().createElement("option",{value:"pro-thumbnail-border-template.php"},(0,g.__)("pro-thumbnail-border-template.php","nggallery")),d().createElement("option",{value:"pro-thumbnail-caption-template.php"},(0,g.__)("pro-thumbnail-caption-template.php","nggallery")),d().createElement("option",{value:"pro-thumbnail-caption2-template.php"},(0,g.__)("pro-thumbnail-caption2-template.php","nggallery"))),d().createElement(Q,{formState:t,handleInputChange:n}),d().createElement(R.Y,{formState:t,handleInputChange:n}),d().createElement(K,{formState:t,handleInputChange:n}))},H=function(e){var t=e.formState,n=e.handleInputChange;return d().createElement(d().Fragment,null,d().createElement("input",{type:"hidden",name:"display_view",value:"default_view"}),d().createElement(G.A,{prefix:"imagebrowser",value:t.template,onChange:n}),d().createElement(R.Y,{formState:t,handleInputChange:n}),d().createElement(q,{formState:t,handleInputChange:n}))},J=function(e){var t=e.formState,n=e.handleInputChange,a=(0,T.a)().map(function(e){return{value:e.id,label:e.name}});return d().createElement("div",{className:"space-y-4"},d().createElement("h3",{className:"text-sm font-medium text-gray-900"},(0,g.__)("Gallery Display Settings","nggallery")),d().createElement(M.A,{id:"gallery_display_type",name:"gallery_display_type",value:t.gallery_display_type||"",onChange:n,label:(0,g.__)("Display Type","nggallery")},a.map(function(e){return d().createElement("option",{key:e.value,value:e.value},e.label)})),d().createElement(L.A,{id:"gallery_override_global_settings",name:"gallery_override_global_settings",checked:t.gallery_override_global_settings||!1,onChange:n,label:(0,g.__)("Override Global Settings","nggallery")}),t.gallery_override_global_settings&&d().createElement("div",{className:"pl-4 border-l-2 border-gray-200 space-y-4"},d().createElement("p",{className:"text-sm text-gray-600"},(0,g.__)("Custom settings for this gallery will override the global display type settings.","nggallery"))))},$=function(e){var t=e.formState,n=e.handleInputChange;return d().createElement(d().Fragment,null,d().createElement(z.A,{type:"number",name:"number",value:t.number,onChange:n,label:(0,g.__)("Number of tags to display","nggallery"),help:(0,g.__)("Enter the maximum number of tags to display in the cloud","nggallery")}),d().createElement(J,{formState:t,handleInputChange:n}),d().createElement(R.Y,{formState:t,handleInputChange:n}))},Z=function(e){var t=e.formState,n=e.handleInputChange;return d().createElement(d().Fragment,null,d().createElement(L.A,{id:"override_image_settings",name:"override_image_settings",checked:t.override_image_settings,onChange:n,label:(0,g.__)("Override image settings","nggallery"),help:(0,g.__)("Overriding the image settings will create an additional set of images","nggallery")}),(0,O._w)(t.override_image_settings)&&d().createElement("div",{className:"ml-6 space-y-4"},d().createElement(M.A,{id:"image_quality",name:"image_quality",value:t.image_quality,onChange:n,label:(0,g.__)("Image quality","nggallery")},Array.from({length:12},function(e,t){return 45+5*t}).map(function(e){return d().createElement("option",{key:e,value:e.toString()},e,"%")})),d().createElement(L.A,{id:"image_watermark",name:"image_watermark",checked:t.image_watermark,onChange:n,label:(0,g.__)("Image watermark","nggallery")})),d().createElement(z.A,{type:"number",name:"image_display_size",value:t.image_display_size,onChange:n,label:(0,g.__)("Image display size","nggallery"),help:(0,g.__)("Measured in pixels","nggallery")}),d().createElement(z.A,{type:"number",name:"image_max_height",value:t.image_max_height,onChange:n,label:(0,g.__)("Image maximum height","nggallery"),help:(0,g.__)("Measured in pixels. Empty or 0 will not impose a limit.","nggallery")}),d().createElement(z.A,{type:"number",name:"image_spacing",value:t.image_spacing,onChange:n,label:(0,g.__)("Image spacing","nggallery"),help:(0,g.__)("Measured in pixels","nggallery")}),d().createElement(z.A,{type:"number",name:"border_size",value:t.border_size,onChange:n,label:(0,g.__)("Border size","nggallery")}),d().createElement("div",{className:"mb-4"},d().createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},(0,g.__)("Border color","nggallery")),d().createElement(X.e,{color:t.border_color,onChange:function(e){n({target:{name:"border_color",value:e}})}})),d().createElement(M.A,{id:"display_type_view",name:"display_type_view",value:t.display_type_view,onChange:n,label:(0,g.__)("Select View","nggallery")},d().createElement("option",{value:"default"},(0,g.__)("Default","nggallery"))),d().createElement(L.A,{id:"display_captions",name:"display_captions",checked:t.display_captions,onChange:n,label:(0,g.__)("Display captions","nggallery")}),(0,O._w)(t.display_captions)&&d().createElement("div",{className:"ml-6 space-y-4"},d().createElement(M.A,{id:"caption_location",name:"caption_location",value:t.caption_location,onChange:n,label:(0,g.__)("Caption location","nggallery")},d().createElement("option",{value:"above"},(0,g.__)("Above","nggallery")),d().createElement("option",{value:"below"},(0,g.__)("Below","nggallery")))),d().createElement(Q,{formState:t,handleInputChange:n}),d().createElement(Y,{formState:t,handleInputChange:n}),d().createElement(R.Y,{formState:t,handleInputChange:n,hidePagination:!0}),d().createElement(K,{formState:t,handleInputChange:n}))},ee=function(e){var t=e.formState,n=e.handleInputChange;return d().createElement(d().Fragment,null,d().createElement("input",{type:"hidden",name:"display_type_view",value:"default"}),d().createElement(G.A,{prefix:"imagebrowser",value:t.template,onChange:n}),d().createElement(R.Y,{formState:t,handleInputChange:n}),d().createElement(q,{formState:t,handleInputChange:n}))},te=function(e){var t=e.formState,n=e.handleInputChange;return d().createElement(d().Fragment,null,d().createElement(z.A,{type:"number",name:"height",value:t.height,onChange:n,label:(0,g.__)("Gallery Height","nggallery")}),d().createElement(Q,{formState:t,handleInputChange:n}),d().createElement(R.Y,{formState:t,handleInputChange:n,hidePagination:!0}))},ne=function(e){var t=e.formState,n=e.handleInputChange,a=function(e,t){n({target:{name:t,value:e}})},r=function(e){return function(t){var a=""===t.target.value?"":String(parseInt(t.target.value,10)||0);n({target:{name:e,value:a}})}};return d().createElement(d().Fragment,null,d().createElement(U,{formState:t,handleInputChange:n}),d().createElement(z.A,{type:"number",name:"image_spacing",value:t.image_spacing,onChange:n,label:(0,g.__)("Image spacing","nggallery")}),d().createElement(z.A,{type:"number",name:"border_size",value:t.border_size,onChange:n,label:(0,g.__)("Border size","nggallery")}),d().createElement(z.A,{type:"number",name:"frame_size",value:t.frame_size,onChange:n,label:(0,g.__)("Frame size","nggallery")}),d().createElement("div",{className:"mb-4"},d().createElement(F.A,null,(0,g.__)("Border color","nggallery")),d().createElement(X.e,{color:t.border_color,onChange:function(e){return a(e,"border_color")}})),d().createElement("div",{className:"mb-4"},d().createElement(F.A,null,(0,g.__)("Frame color","nggallery")),d().createElement(X.e,{color:t.frame_color,onChange:function(e){return a(e,"frame_color")}})),d().createElement(L.A,{id:"alttext_display",name:"alttext_display",checked:t.alttext_display,onChange:n,label:(0,g.__)("Display image title","nggallery")}),(0,O._w)(t.alttext_display)&&d().createElement("div",{className:"ml-6 space-y-4"},d().createElement("div",{className:"mb-4"},d().createElement(F.A,null,(0,g.__)("Title font color","nggallery")),d().createElement(X.e,{color:t.alttext_font_color,onChange:function(e){return a(e,"alttext_font_color")}}),d().createElement("p",{className:"mt-1 text-sm text-gray-500"},(0,g.__)("An empty color setting will use your theme colors","nggallery"))),d().createElement(z.A,{type:"number",name:"alttext_font_size",value:t.alttext_font_size,onChange:r("alttext_font_size"),label:(0,g.__)("Title font size","nggallery"),help:(0,g.__)("Measured in pixels. An empty or zero setting will use your theme font size","nggallery"),placeholder:(0,g.__)("# of pixels","nggallery"),min:0,max:200})),d().createElement(L.A,{id:"description_display",name:"description_display",checked:t.description_display,onChange:n,label:(0,g.__)("Display image description","nggallery")}),(0,O._w)(t.description_display)&&d().createElement("div",{className:"ml-6 space-y-4"},d().createElement("div",{className:"mb-4"},d().createElement(F.A,{help:(0,g.__)("An empty color setting will use your theme colors","nggallery")},(0,g.__)("Description font color","nggallery")),d().createElement(X.e,{color:t.description_font_color,onChange:function(e){return a(e,"description_font_color")}})),d().createElement(z.A,{type:"number",name:"description_font_size",value:t.description_font_size,onChange:r("description_font_size"),label:(0,g.__)("Description font size","nggallery"),help:(0,g.__)("Measured in pixels. An empty or zero setting will use your theme font size","nggallery"),placeholder:(0,g.__)("# of pixels","nggallery"),min:0,max:200})),d().createElement(Q,{formState:t,handleInputChange:n}),d().createElement(Y,{formState:t,handleInputChange:n}),d().createElement(K,{formState:t,handleInputChange:n}))},ae=function(e){var t=e.formState,n=e.handleInputChange;return d().createElement(d().Fragment,null,d().createElement(L.A,{id:"override_gallery_width",name:"override_gallery_width",checked:t.override_gallery_width,onChange:n,label:(0,g.__)("Override maximum gallery width","nggallery"),help:(0,g.__)("Gallery width is set to your theme's content width but this can be overridden to create smaller galleries. If your theme does not provide the $content_width feature the default will fallback to 2000px.","nggallery")}),(0,O._w)(t.override_gallery_width)&&d().createElement("div",{className:"ml-6 space-y-4"},d().createElement(z.A,{type:"number",name:"maximum_gallery_width",value:t.maximum_gallery_width,onChange:n,label:(0,g.__)("Maximum gallery width","nggallery"),help:(0,g.__)("Measured in pixels","nggallery")})),d().createElement(Q,{formState:t,handleInputChange:n}),d().createElement(R.Y,{formState:t,handleInputChange:n,hidePagination:!0}))},re=function(e){var t=e.formState,n=e.handleInputChange;return d().createElement(d().Fragment,null,d().createElement(M.A,{id:"justify_last_row",name:"justify_last_row",value:t.justify_last_row,onChange:n,label:(0,g.__)("Justify last row","nggallery"),help:(0,g.__)('When aligning the last row some images may appear cropped. Select "Do not justify" to allow the last row to appear flush but "unfinished". "Hide" will omit any images that can not be justified without cropping.',"nggallery")},d().createElement("option",{value:"justify"},(0,g.__)("Justify","nggallery")),d().createElement("option",{value:"nojustify"},(0,g.__)("Do not justify","nggallery")),d().createElement("option",{value:"hide"},(0,g.__)("Hide","nggallery"))),d().createElement(L.A,{id:"enable_lazy_loading",name:"enable_lazy_loading",checked:t.enable_lazy_loading,onChange:n,label:(0,g.__)('Enable "lazy" image loading',"nggallery")}),t.enable_lazy_loading&&d().createElement("div",{className:"ml-6 space-y-4"},d().createElement(z.A,{type:"number",name:"images_to_load_on_scroll",value:t.images_to_load_on_scroll,onChange:n,label:(0,g.__)("Images to load when scrolling","nggallery")}),d().createElement(z.A,{type:"number",name:"images_to_display_at_start",value:t.images_to_display_at_start,onChange:n,label:(0,g.__)("Images to display at start","nggallery")})),d().createElement(z.A,{type:"number",name:"margins",value:t.margins,onChange:n,label:(0,g.__)("Margins","nggallery")}),d().createElement(z.A,{type:"number",name:"row_height",value:t.row_height,onChange:n,label:(0,g.__)("Row height","nggallery")}),d().createElement(Q,{formState:t,handleInputChange:n}),d().createElement(Y,{formState:t,handleInputChange:n}),d().createElement(R.Y,{formState:t,handleInputChange:n}))},le=function(e){var t=e.formState,n=e.handleInputChange;return d().createElement(d().Fragment,null,d().createElement(z.A,{type:"number",name:"maximum_image_width",value:t.maximum_image_width,onChange:n,label:(0,g.__)("Maximum image width","nggallery"),help:(0,g.__)("Measured in pixels","nggallery")}),d().createElement(z.A,{type:"number",name:"image_padding",value:t.image_padding,onChange:n,label:(0,g.__)("Image padding","nggallery"),help:(0,g.__)("Measured in pixels","nggallery")}),d().createElement(L.A,{id:"center_gallery",name:"center_gallery",checked:t.center_gallery,onChange:n,label:(0,g.__)("Center the gallery","nggallery")}),d().createElement(Q,{formState:t,handleInputChange:n}),d().createElement(R.Y,{formState:t,handleInputChange:n,hidePagination:!0}),d().createElement(K,{formState:t,handleInputChange:n}))},ie=function(e){var t=e.formState,n=e.handleInputChange;return d().createElement(d().Fragment,null,d().createElement(L.A,{id:"enable_tag_filter",name:"enable_tag_filter",checked:t.enable_tag_filter,onChange:n,label:(0,g.__)("Enable filtering results by tag","nggallery")}),d().createElement(L.A,{id:"search_alttext",name:"search_alttext",checked:t.search_alttext,onChange:n,label:(0,g.__)("Search image alttext","nggallery")}),d().createElement(L.A,{id:"search_description",name:"search_description",checked:t.search_description,onChange:n,label:(0,g.__)("Search image description","nggallery")}),d().createElement(L.A,{id:"search_tags",name:"search_tags",checked:t.search_tags,onChange:n,label:(0,g.__)("Search image tags","nggallery")}),d().createElement(M.A,{id:"search_mode",name:"search_mode",value:t.search_mode,onChange:n,label:(0,g.__)("Database search mode","nggallery"),help:(0,g.__)("A natural language search treats the requested string as a phrase in text without any operators except for quotation marks. A boolean search uses special rules and operators such as the plus and minus symbols.","nggallery")},d().createElement("option",{value:"natural"},(0,g.__)("Natural language","nggallery")),d().createElement("option",{value:"boolean"},(0,g.__)("Boolean","nggallery"))),d().createElement(z.A,{type:"number",name:"minimum_relevance",value:t.minimum_relevance,onChange:n,label:(0,g.__)("Minimum relevance","nggallery"),help:(0,g.__)("The database server assigns a relevance score to each possible image based on a number of factors with zero being not at all relevant. Users with smaller databases or images whose alttext or description only holds a few words will need a lower number here; possibly as low as 0.05. It is unlikely many users will need to raise this beyond one.","nggallery")}),d().createElement(z.A,{type:"number",name:"limit",value:t.limit,onChange:n,label:(0,g.__)("Limit search results","nggallery"),help:(0,g.__)("Limit search results to this amount. A setting of zero means no limitations are applied","nggallery")}),d().createElement(L.A,{id:"order_by_relevance",name:"order_by_relevance",checked:t.order_by_relevance,onChange:n,label:(0,g.__)("Order by relevance first","nggallery"),help:(0,g.__)("When enabled search results will be ordered by their relevance first, then by the secondary order setting","nggallery")}),d().createElement(M.A,{id:"order_by",name:"order_by",value:t.order_by,onChange:n,label:(0,g.__)("Order search results by","nggallery")},d().createElement("option",{value:"pid"},(0,g.__)("Image ID","nggallery")),d().createElement("option",{value:"galleryid"},(0,g.__)("Gallery ID","nggallery")),d().createElement("option",{value:"filename"},(0,g.__)("Image filename","nggallery"))),d().createElement(M.A,{id:"order_direction",name:"order_direction",value:t.order_direction,onChange:n,label:(0,g.__)("Order direction of search results","nggallery")},d().createElement("option",{value:"ASC"},(0,g.__)("Ascending","nggallery")),d().createElement("option",{value:"DESC"},(0,g.__)("Descending","nggallery"))),d().createElement(M.A,{id:"gallery_display_type",name:"gallery_display_type",value:t.gallery_display_type,onChange:n,label:(0,g.__)("Gallery display type","nggallery"),help:(0,g.__)("The display type used to render search results","nggallery")},d().createElement("option",{value:"photocrati-nextgen_basic_thumbnails"},(0,g.__)("Basic Thumbnails","nggallery")),d().createElement("option",{value:"photocrati-nextgen_basic_slideshow"},(0,g.__)("Basic Slideshow","nggallery")),d().createElement("option",{value:"photocrati-nextgen_basic_imagebrowser"},(0,g.__)("Basic ImageBrowser","nggallery")),d().createElement("option",{value:"photocrati-nextgen_pro_thumbnail_grid"},(0,g.__)("Pro Thumbnail Grid","nggallery")),d().createElement("option",{value:"photocrati-nextgen_pro_blog_gallery"},(0,g.__)("Pro Blog Gallery","nggallery")),d().createElement("option",{value:"photocrati-nextgen_pro_imagebrowser"},(0,g.__)("Pro ImageBrowser","nggallery")),d().createElement("option",{value:"photocrati-nextgen_pro_slideshow"},(0,g.__)("Pro Slideshow","nggallery"))))},oe=function(e){var t=e.formState,n=e.handleInputChange;return d().createElement(d().Fragment,null,d().createElement(L.A,{id:"crop_images",name:"crop_images",checked:t.crop_images,onChange:n,label:(0,g.__)("Crop images","nggallery")}),d().createElement("div",{className:"ml-6 space-y-4"},t.crop_images&&d().createElement(L.A,{id:"pan_images",name:"pan_images",checked:t.pan_images,onChange:n,label:(0,g.__)("Pan images","nggallery")}),!t.crop_images&&d().createElement(d().Fragment,null,d().createElement(z.A,{type:"number",name:"border_size",value:t.border_size,onChange:n,label:(0,g.__)("Border size","nggallery"),help:(0,g.__)('Borders will not be applied if "Crop Images" is enabled',"nggallery")}),d().createElement(F.A,null,(0,g.__)("Border color","nggallery")),d().createElement(X.e,{color:t.border_color,onChange:function(e){n({target:{name:"border_color",value:e}})}}))),d().createElement(L.A,{id:"show_play_controls",name:"show_play_controls",checked:t.show_play_controls,onChange:n,label:(0,g.__)("Show play controls","nggallery")}),d().createElement(L.A,{id:"show_captions",name:"show_captions",checked:t.show_captions,onChange:n,label:(0,g.__)("Show captions","nggallery")}),(0,O._w)(t.show_captions)&&d().createElement("div",{className:"ml-4 space-y-4"},d().createElement(M.A,{id:"caption_class",name:"caption_class",value:t.caption_class,onChange:n,label:(0,g.__)("Caption location","nggallery")},d().createElement("option",{value:"caption_above_stage"},(0,g.__)("Top","nggallery")),d().createElement("option",{value:"caption_below_stage"},(0,g.__)("Bottom","nggallery")),d().createElement("option",{value:"caption_overlay_top"},(0,g.__)("Top (Overlay)","nggallery")),d().createElement("option",{value:"caption_overlay_bottom"},(0,g.__)("Bottom (Overlay)","nggallery"))),d().createElement(z.A,{type:"number",name:"caption_height",value:t.caption_height,onChange:n,label:(0,g.__)("Caption height","nggallery"),help:(0,g.__)("Measured in pixels","nggallery")})),d().createElement(M.A,{id:"stage_aspect_ratio",name:"stage_aspect_ratio",value:t.stage_aspect_ratio,onChange:n,label:(0,g.__)("Stage aspect ratio","nggallery")},d().createElement("option",{value:"first_image"},(0,g.__)("First Image","nggallery")),d().createElement("option",{value:"image_average"},(0,g.__)("Average","nggallery")),d().createElement("option",{value:"1.5"},(0,g.__)("3:2 [1.5]","nggallery")),d().createElement("option",{value:"1.333"},(0,g.__)("4:3 [1.333]","nggallery")),d().createElement("option",{value:"1.777"},(0,g.__)("16:9 [1.777]","nggallery")),d().createElement("option",{value:"1.6"},(0,g.__)("16:10 [1.6]","nggallery")),d().createElement("option",{value:"1.85"},(0,g.__)("1.85:1 [1.85]","nggallery")),d().createElement("option",{value:"2.39"},(0,g.__)("2.39:1 [2.39]","nggallery")),d().createElement("option",{value:"1.81"},(0,g.__)("1.81:1 [1.81]","nggallery")),d().createElement("option",{value:"1"},(0,g.__)("1:1 (Square) [1]","nggallery"))),d().createElement(F.A,null,(0,g.__)("Gallery width","nggallery")),d().createElement("div",{className:"flex items-end gap-2"},d().createElement(z.A,{type:"number",name:"gallery_width",value:t.gallery_width,onChange:n}),d().createElement(M.A,{id:"gallery_width_unit",name:"gallery_width_unit",value:t.gallery_width_unit,onChange:n},d().createElement("option",{value:"percent"},(0,g.__)("Percent","nggallery")),d().createElement("option",{value:"pixels"},(0,g.__)("Pixels","nggallery")))),d().createElement(M.A,{id:"transition_effect",name:"transition_effect",value:t.transition_effect,onChange:n,label:(0,g.__)("Transition effect","nggallery")},d().createElement("option",{value:"fade"},(0,g.__)("Crossfade between images","nggallery")),d().createElement("option",{value:"flash"},(0,g.__)("Fades into background color between images","nggallery")),d().createElement("option",{value:"pulse"},(0,g.__)("Quickly move the image into the background color, then fade into the next image","nggallery")),d().createElement("option",{value:"slide"},(0,g.__)("Slide images depending on image position","nggallery")),d().createElement("option",{value:"fadeslide"},(0,g.__)("Fade between images and slide slightly at the same time","nggallery"))),d().createElement(z.A,{type:"number",name:"transition_speed",value:t.transition_speed,onChange:n,label:(0,g.__)("Transition speed","nggallery"),help:(0,g.__)("Measured in seconds","nggallery")}),d().createElement(z.A,{type:"number",name:"slideshow_speed",value:t.slideshow_speed,onChange:n,label:(0,g.__)("Slideshow speed","nggallery"),help:(0,g.__)("Measured in seconds","nggallery")}),d().createElement(L.A,{id:"override_thumbnail_settings",name:"override_thumbnail_settings",checked:t.override_thumbnail_settings,onChange:n,label:(0,g.__)("Override thumbnail settings","nggallery"),help:(0,g.__)("This does not affect existing thumbnails; overriding the thumbnail settings will create an additional set of thumbnails. To change the size of existing thumbnails please visit 'Manage Galleries' and choose 'Create new thumbnails' for all images in the gallery.","nggallery")}),t.override_thumbnail_settings&&d().createElement("div",{className:"ml-6 space-y-4"},d().createElement(M.A,{id:"thumbnail_dimensions",name:"thumbnail_dimensions",value:t.thumbnail_dimensions,onChange:n,label:(0,g.__)("Thumbnail dimensions","nggallery"),help:(0,g.__)("These are maximum values","nggallery")},d().createElement("option",{value:"240x160"},"240x160"),d().createElement("option",{value:"custom"},(0,g.__)("Custom","nggallery"))),"custom"===t.thumbnail_dimensions&&d().createElement("div",{className:"flex gap-4"},d().createElement(z.A,{type:"number",name:"thumbnail_width",value:t.thumbnail_width,onChange:n}),d().createElement(z.A,{type:"number",name:"thumbnail_height",value:t.thumbnail_height,onChange:n}))),d().createElement(K,{formState:t,handleInputChange:n}))},ce=function(e){var t=e.formState,n=e.handleInputChange;return d().createElement(d().Fragment,null,d().createElement(L.A,{id:"crop_images",name:"crop_images",checked:t.crop_images,onChange:n,label:(0,g.__)("Crop images","nggallery")}),d().createElement("div",{className:"ml-6 space-y-4"},t.crop_images&&d().createElement(L.A,{id:"pan_images",name:"pan_images",checked:t.pan_images,onChange:n,label:(0,g.__)("Pan images","nggallery")}),!t.crop_images&&d().createElement(d().Fragment,null,d().createElement(z.A,{type:"number",name:"border_size",value:t.border_size,onChange:n,label:(0,g.__)("Border size","nggallery"),help:(0,g.__)('Borders will not be applied if "Crop Images" is enabled',"nggallery")}),d().createElement(F.A,null,(0,g.__)("Border color","nggallery")),d().createElement(X.e,{color:t.border_color,onChange:function(e){n({target:{name:"border_color",value:e}})}}))),d().createElement(L.A,{id:"show_play_controls",name:"show_play_controls",checked:t.show_play_controls,onChange:n,label:(0,g.__)("Show play controls","nggallery")}),d().createElement(L.A,{id:"show_captions",name:"show_captions",checked:t.show_captions,onChange:n,label:(0,g.__)("Show captions","nggallery")}),(0,O._w)(t.show_captions)&&d().createElement("div",{className:"ml-4 space-y-4"},d().createElement(M.A,{id:"caption_class",name:"caption_class",value:t.caption_class,onChange:n,label:(0,g.__)("Caption location","nggallery")},d().createElement("option",{value:"caption_above_stage"},(0,g.__)("Top","nggallery")),d().createElement("option",{value:"caption_below_stage"},(0,g.__)("Bottom","nggallery")),d().createElement("option",{value:"caption_overlay_top"},(0,g.__)("Top (Overlay)","nggallery")),d().createElement("option",{value:"caption_overlay_bottom"},(0,g.__)("Bottom (Overlay)","nggallery"))),d().createElement(z.A,{type:"number",name:"caption_height",value:t.caption_height,onChange:n,label:(0,g.__)("Caption height","nggallery"),help:(0,g.__)("Measured in pixels","nggallery")})),d().createElement(M.A,{id:"stage_aspect_ratio",name:"stage_aspect_ratio",value:t.stage_aspect_ratio,onChange:n,label:(0,g.__)("Stage aspect ratio","nggallery")},d().createElement("option",{value:"first_image"},(0,g.__)("First Image","nggallery")),d().createElement("option",{value:"image_average"},(0,g.__)("Average","nggallery")),d().createElement("option",{value:"1.5"},(0,g.__)("3:2 [1.5]","nggallery")),d().createElement("option",{value:"1.333"},(0,g.__)("4:3 [1.333]","nggallery")),d().createElement("option",{value:"1.777"},(0,g.__)("16:9 [1.777]","nggallery")),d().createElement("option",{value:"1.6"},(0,g.__)("16:10 [1.6]","nggallery")),d().createElement("option",{value:"1.85"},(0,g.__)("1.85:1 [1.85]","nggallery")),d().createElement("option",{value:"2.39"},(0,g.__)("2.39:1 [2.39]","nggallery")),d().createElement("option",{value:"1.81"},(0,g.__)("1.81:1 [1.81]","nggallery")),d().createElement("option",{value:"1"},(0,g.__)("1:1 (Square) [1]","nggallery"))),d().createElement(F.A,null,(0,g.__)("Gallery width","nggallery")),d().createElement("div",{className:"flex items-end gap-2"},d().createElement(z.A,{type:"number",name:"gallery_width",value:t.gallery_width,onChange:n}),d().createElement(M.A,{id:"gallery_width_unit",name:"gallery_width_unit",value:t.gallery_width_unit,onChange:n},d().createElement("option",{value:"percent"},(0,g.__)("Percent","nggallery")),d().createElement("option",{value:"pixels"},(0,g.__)("Pixels","nggallery")))),d().createElement(M.A,{id:"transition_effect",name:"transition_effect",value:t.transition_effect,onChange:n,label:(0,g.__)("Transition effect","nggallery")},d().createElement("option",{value:"fade"},(0,g.__)("Crossfade between images","nggallery")),d().createElement("option",{value:"flash"},(0,g.__)("Fades into background color between images","nggallery")),d().createElement("option",{value:"pulse"},(0,g.__)("Quickly move the image into the background color, then fade into the next image","nggallery")),d().createElement("option",{value:"slide"},(0,g.__)("Slide images depending on image position","nggallery")),d().createElement("option",{value:"fadeslide"},(0,g.__)("Fade between images and slide slightly at the same time","nggallery"))),d().createElement(z.A,{type:"number",name:"transition_speed",value:t.transition_speed,onChange:n,label:(0,g.__)("Transition speed","nggallery"),help:(0,g.__)("Measured in seconds","nggallery")}),d().createElement(z.A,{type:"number",name:"slideshow_speed",value:t.slideshow_speed,onChange:n,label:(0,g.__)("Slideshow speed","nggallery"),help:(0,g.__)("Measured in seconds","nggallery")}),d().createElement(L.A,{id:"override_thumbnail_settings",name:"override_thumbnail_settings",checked:t.override_thumbnail_settings,onChange:n,label:(0,g.__)("Override thumbnail settings","nggallery"),help:(0,g.__)("This does not affect existing thumbnails; overriding the thumbnail settings will create an additional set of thumbnails. To change the size of existing thumbnails please visit 'Manage Galleries' and choose 'Create new thumbnails' for all images in the gallery.","nggallery")}),t.override_thumbnail_settings&&d().createElement("div",{className:"ml-6 space-y-4"},d().createElement(M.A,{id:"thumbnail_dimensions",name:"thumbnail_dimensions",value:t.thumbnail_dimensions,onChange:n,label:(0,g.__)("Thumbnail dimensions","nggallery"),help:(0,g.__)("These are maximum values","nggallery")},d().createElement("option",{value:"240x160"},"240x160"),d().createElement("option",{value:"custom"},(0,g.__)("Custom","nggallery"))),"custom"===t.thumbnail_dimensions&&d().createElement("div",{className:"flex gap-4"},d().createElement(z.A,{type:"number",name:"thumbnail_width",value:t.thumbnail_width,onChange:n}),d().createElement(z.A,{type:"number",name:"thumbnail_height",value:t.thumbnail_height,onChange:n}))),d().createElement(K,{formState:t,handleInputChange:n}))};function se(){var e,t,n="function"==typeof Symbol?Symbol:{},a=n.iterator||"@@iterator",r=n.toStringTag||"@@toStringTag";function l(n,a,r,l){var c=a&&a.prototype instanceof o?a:o,s=Object.create(c.prototype);return ue(s,"_invoke",function(n,a,r){var l,o,c,s=0,u=r||[],g=!1,m={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return l=t,o=0,c=e,m.n=n,i}};function d(n,a){for(o=n,c=a,t=0;!g&&s&&!r&&t<u.length;t++){var r,l=u[t],d=m.p,p=l[2];n>3?(r=p===a)&&(c=l[(o=l[4])?5:(o=3,3)],l[4]=l[5]=e):l[0]<=d&&((r=n<2&&d<l[1])?(o=0,m.v=a,m.n=l[1]):d<p&&(r=n<3||l[0]>a||a>p)&&(l[4]=n,l[5]=a,m.n=p,o=0))}if(r||n>1)return i;throw g=!0,a}return function(r,u,p){if(s>1)throw TypeError("Generator is already running");for(g&&1===u&&d(u,p),o=u,c=p;(t=o<2?e:c)||!g;){l||(o?o<3?(o>1&&(m.n=-1),d(o,c)):m.n=c:m.v=c);try{if(s=2,l){if(o||(r="next"),t=l[r]){if(!(t=t.call(l,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,o<2&&(o=0)}else 1===o&&(t=l.return)&&t.call(l),o<2&&(c=TypeError("The iterator does not provide a '"+r+"' method"),o=1);l=e}else if((t=(g=m.n<0)?c:n.call(a,m))!==i)break}catch(t){l=e,o=1,c=t}finally{s=1}}return{value:t,done:g}}}(n,r,l),!0),s}var i={};function o(){}function c(){}function s(){}t=Object.getPrototypeOf;var u=[][a]?t(t([][a]())):(ue(t={},a,function(){return this}),t),g=s.prototype=o.prototype=Object.create(u);function m(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,ue(e,r,"GeneratorFunction")),e.prototype=Object.create(g),e}return c.prototype=s,ue(g,"constructor",s),ue(s,"constructor",c),c.displayName="GeneratorFunction",ue(s,r,"GeneratorFunction"),ue(g),ue(g,r,"Generator"),ue(g,a,function(){return this}),ue(g,"toString",function(){return"[object Generator]"}),(se=function(){return{w:l,m}})()}function ue(e,t,n,a){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}ue=function(e,t,n,a){function l(t,n){ue(e,t,function(e){return this._invoke(t,n,e)})}t?r?r(e,t,{value:n,enumerable:!a,configurable:!a,writable:!a}):e[t]=n:(l("next",0),l("throw",1),l("return",2))},ue(e,t,n,a)}function ge(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function me(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ge(Object(n),!0).forEach(function(t){(0,f.A)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ge(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}const de=function(e){var t,n=e.gallery,r=e.previewMode,l=e.onPreviewModeChange,i=(0,u.useSelect)(function(e){return e(c.E).getCurrentId()},[]),o=(0,b.iX)(i).data,s=(null===(t=window.imagelyApp)||void 0===t?void 0:t.proTypeInstalled)||"lite",p=(0,m.useMemo)(function(){return function(e){switch(e){case"lite":default:return P;case"starter":return j;case"pro":case"plus":return(0,T.a)().map(function(e){return e.id})}}(s)},[s]),_=(0,m.useState)(null),w=(0,a.A)(_,2),x=w[0],C=w[1],A=(0,E.b)({type:"gallery",item:o,includeEcommerce:!1}),k=(null==n?void 0:n.display_type)||"photocrati-nextgen_basic_thumbnails",S=N(),F=S.getCurrentDisplayTypeSettings,G=S.updateDisplayTypeSettings,M=S.updateField,z=S.registerFlushCallback,L=S.unregisterFlushCallback,R=(0,b.hW)(),q=(0,v.E)(),K=q.showSuccess,U=q.showError,Y=(0,m.useRef)(null),X=(0,m.useRef)(null),Q=(0,m.useCallback)(function(){Y.current&&(clearTimeout(Y.current),Y.current=null),X.current&&(X.current(),X.current=null)},[]);(0,m.useEffect)(function(){return z("customizeTab",Q),Q(),function(){Q(),L("customizeTab")}},[k,Q,z,L]),(0,m.useEffect)(function(){if(k&&n){var e=(null==n?void 0:n.display_type_settings)||{},t=(0,O.bT)(e[k]||{}),a=me(me({},(l={},["photocrati-nextgen_basic_imagebrowser","photocrati-nextgen_basic_singlepic","photocrati-nextgen_basic_thumbnails","photocrati-nextgen_basic_slideshow","photocrati-nextgen_basic_compact_album","photocrati-nextgen_basic_extended_album","photocrati-nextgen_pro_thumbnail_grid","photocrati-nextgen_pro_blog_gallery","photocrati-nextgen_pro_imagebrowser","photocrati-nextgen_pro_sidescroll","photocrati-nextgen_pro_film","photocrati-nextgen_pro_tile","photocrati-nextgen_pro_mosaic","photocrati-nextgen_pro_masonry","photocrati-nextgen_pro_grid_album","photocrati-nextgen_pro_list_album"].includes(r=k)&&(l.animate_images_duration="1500",l.animate_images_delay="250",l.animate_pagination_duration="1500",l.animate_pagination_delay="250"),"imagely-pro-search"===r&&(l.search_alttext=!0,l.search_description=!0,l.search_tags=!0,l.enable_tag_filter=!0,l.search_mode="natural",l.limit="0",l.order_by="pid",l.order_direction="ASC",l.order_by_relevance=!0,l.minimum_relevance="1",l.gallery_display_type="photocrati-nextgen_basic_thumbnails",l.use_lightbox_effect=!0),["photocrati-nextgen_pro_thumbnail_grid","photocrati-nextgen_pro_blog_gallery","photocrati-nextgen_pro_imagebrowser"].includes(r)&&(l.display_type_view="default"),"photocrati-nextgen_pro_mosaic"===r&&(l.images_to_load_on_scroll="15",l.images_to_display_at_start="15"),"photocrati-nextgen_pro_slideshow"===r&&(l.stage_aspect_ratio="1.5",l.gallery_width="100",l.gallery_width_unit="percent"),l)),t);G(k,a)}var r,l},[k,null==n?void 0:n.display_type_settings,n,G]);var J=function(){var e=(0,y.A)(se().m(function e(t){var a;return se().w(function(e){for(;;)switch(e.p=e.n){case 0:if(n){e.n=1;break}return e.a(2);case 1:if(C(t),p.includes(t)){e.n=2;break}return e.a(2);case 2:return M("display_type",t),e.p=3,e.n=4,R.mutateAsync({id:n.gid,data:{display_type:t}});case 4:K((0,g.__)("Layout changed successfully!","nggallery")),e.n=6;break;case 5:e.p=5,a=e.v,U((0,g.__)("Failed to change layout. Please try again.","nggallery")),console.error("Error changing layout:",a);case 6:return e.a(2)}},e,null,[[3,5]])}));return function(t){return e.apply(this,arguments)}}(),ue=(0,m.useCallback)(function(){var e=(0,y.A)(se().m(function e(t,n,a){var r;return se().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,R.mutateAsync({id:t,data:{display_type:n,display_type_settings:a}});case 1:e.n=3;break;case 2:e.p=2,r=e.v,U((0,g.__)("Failed to update display settings. Changes have been reverted.","nggallery")),console.error("Error updating display settings:",r);case 3:return e.a(2)}},e,null,[[0,2]])}));return function(t,n,a){return e.apply(this,arguments)}}(),[R,U]),ge=(0,m.useCallback)(function(e){var t=e.target,a=t.name,r=t.value,l=t.type,i="checkbox"===l?e.target.checked:r;if(k&&(G(k,(0,f.A)({},a,i)),n)){Y.current&&clearTimeout(Y.current);var o=k,c=n.gid,s=n.display_type_settings,u="checkbox"===l?(0,O.xZ)(i):i,g=function(){var e=me(me({},s),{},(0,f.A)({},o,me(me({},(null==s?void 0:s[o])||{}),{},(0,f.A)({},a,u))));ue(c,o,e)};X.current=g,Y.current=window.setTimeout(function(){g(),X.current=null},1e3)}},[k,n,G,ue]),de=F(),pe=x&&!p.includes(x);return d().createElement("div",{className:"bg-white rounded-lg shadow lg:grid lg:grid-cols-2 lg:items-start"},d().createElement("div",{className:"px-6 py-6 lg:px-8 lg:py-8 border-b lg:border-b-0 lg:border-r"},d().createElement("div",{className:"space-y-4"},d().createElement("h1",{className:"text-lg font-medium"},(0,g.__)("Customize","nggallery")),d().createElement(h.A,{title:(0,g.__)("Choose Layout","nggallery"),defaultExpanded:!0,className:"mb-4"},d().createElement("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-5 gap-2 sm:gap-4"},(0,T.a)().map(function(e){var t=p.includes(e.id),n=(x||k)===e.id;return d().createElement("div",{key:e.id,className:"flex flex-col items-center text-center"},d().createElement("div",{className:"relative p-1 border rounded-md cursor-pointer transition-all duration-200 w-full ".concat(n?"border-green-500":t?"border-gray-600 hover:border-green-500":"border-gray-200 hover:border-green-500"),onClick:function(){return J(e.id)}},d().createElement("div",{className:"flex items-center justify-center ".concat(n?"text-gray-600":"text-gray-200 hover:text-gray-600")},d().createElement("div",{className:"w-12 h-8 sm:w-16 sm:h-12 flex items-center justify-center"},e.icon))),d().createElement("h3",{className:"text-xs sm:text-xs font-medium mt-1 sm:mt-2 ".concat(t?"text-gray-300":"text-gray-400")},e.name))}))),de&&d().createElement("div",{className:pe?"opacity-50 pointer-events-none":""},d().createElement(h.A,{title:(0,g.__)("Customize Gallery Look","nggallery"),defaultExpanded:!0,className:"mb-4"},d().createElement("div",{className:"space-y-4"},"photocrati-nextgen_basic_slideshow"===k&&d().createElement(B,{formState:de,handleInputChange:ge}),"photocrati-nextgen_basic_thumbnails"===k&&d().createElement(W,{formState:de,handleInputChange:ge}),"photocrati-nextgen_pro_thumbnail_grid"===k&&d().createElement(V,{formState:de,handleInputChange:ge}),"photocrati-nextgen_basic_imagebrowser"===k&&d().createElement(H,{formState:de,handleInputChange:ge}),"photocrati-nextgen_basic_tagcloud"===k&&d().createElement($,{formState:de,handleInputChange:ge}),"photocrati-nextgen_pro_blog_gallery"===k&&d().createElement(Z,{formState:de,handleInputChange:ge}),"photocrati-nextgen_pro_imagebrowser"===k&&d().createElement(ee,{formState:de,handleInputChange:ge}),"photocrati-nextgen_pro_sidescroll"===k&&d().createElement(te,{formState:de,handleInputChange:ge}),"photocrati-nextgen_pro_film"===k&&d().createElement(ne,{formState:de,handleInputChange:ge}),"photocrati-nextgen_pro_tile"===k&&d().createElement(ae,{formState:de,handleInputChange:ge}),"photocrati-nextgen_pro_mosaic"===k&&d().createElement(re,{formState:de,handleInputChange:ge}),"photocrati-nextgen_pro_masonry"===k&&d().createElement(le,{formState:de,handleInputChange:ge}),"imagely-pro-search"===k&&d().createElement(ie,{formState:de,handleInputChange:ge}),"photocrati-nextgen_pro_horizontal_filmstrip"===k&&d().createElement(oe,{formState:de,handleInputChange:ge}),"photocrati-nextgen_pro_slideshow"===k&&d().createElement(ce,{formState:de,handleInputChange:ge})))))),d().createElement("div",{className:"px-6 py-6 lg:px-8 lg:py-8 lg:sticky lg:top-8 lg:max-h-screen"},pe?d().createElement(D.A,null):d().createElement(I.A,{previewMode:r,onPreviewModeChange:l,url:A,title:(0,g.__)("Gallery Preview","nggallery")})))};var pe=n(2284),_e=n(5458),ye=n(3375),fe=n(3627),he=n(4848),be=n(2935),ve=n(3717),Ee=n(7374),we=n(443),xe=n(4540),Ce=function(){var e=Ae();return null!==e&&e.enabled&&e.license_valid},Ae=function(){var e=window.imagelyApp;return(null==e?void 0:e.enviraCdnConfig)||null},ke=function(e){var t;return!(null===(t=e.meta_data)||void 0===t||!t._envira_cdn_id)},Se=function(){var e=window.wpApiSettings;if(null!=e&&e.nonce)return e.nonce;var t=window.imagelyApp;return(null==t?void 0:t.nonce)||null},Ne=function(){var e=window.imagelyApp;return(null==e?void 0:e.restURL)||"/wp-json/"},Te=n(5300),Ie=n(7665),Oe=n(1455),Pe=n.n(Oe),je=n(4979),De=n(7196);const Fe=function(e){var t=e.isOpen,n=e.onClose,a=e.image;if(!a)return null;var r=a.meta_data||{},l=function(e){return null==e||""===e?"N/A":"boolean"==typeof e?e?"Yes":"No":String(e)},i=[{tag:"Image ID",value:a.pid},{tag:"Image Width",value:r.width},{tag:"Image Height",value:r.height},{tag:"md5",value:r.md5}],o=[{tag:"Orientation",value:r.Orientation},{tag:"Camera",value:r.camera},{tag:"Aperture",value:r.aperture},{tag:"Focal Length",value:r.focal_length},{tag:"ISO",value:r.iso},{tag:"Shutter Speed",value:r.shutter_speed},{tag:"Flash",value:r.flash},{tag:"Created",value:r.created_timestamp?new Date(1e3*r.created_timestamp).toLocaleString():null}].filter(function(e){return null!==e.value&&void 0!==e.value&&""!==e.value&&!1!==e.value});return d().createElement(De.A,{isOpen:t,onClose:n,title:(0,g.__)("Show meta data","nggallery")},d().createElement("div",{className:"space-y-6"},d().createElement("div",null,d().createElement("h3",{className:"text-lg font-semibold text-gray-900 mb-4"},(0,g.__)("Meta Data","nggallery")),d().createElement("div",{className:"bg-gray-50 rounded-lg overflow-hidden"},d().createElement("table",{className:"min-w-full"},d().createElement("thead",{className:"bg-gray-100"},d().createElement("tr",null,d().createElement("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 w-1/3"},(0,g.__)("Tag","nggallery")),d().createElement("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700"},(0,g.__)("Value","nggallery")))),d().createElement("tbody",{className:"divide-y divide-gray-200 bg-white"},i.map(function(e,t){return d().createElement("tr",{key:t,className:"bg-white"},d().createElement("td",{className:"px-4 py-3 text-sm text-gray-900 font-medium"},e.tag),d().createElement("td",{className:"px-4 py-3 text-sm text-gray-700"},l(e.value)))}))))),o.length>0&&d().createElement("div",null,d().createElement("h3",{className:"text-lg font-semibold text-gray-900 mb-4"},(0,g.__)("EXIF Data","nggallery")),d().createElement("div",{className:"bg-gray-50 rounded-lg overflow-hidden"},d().createElement("table",{className:"min-w-full"},d().createElement("thead",{className:"bg-gray-100"},d().createElement("tr",null,d().createElement("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 w-1/3"},(0,g.__)("Tag","nggallery")),d().createElement("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700"},(0,g.__)("Value","nggallery")))),d().createElement("tbody",{className:"divide-y divide-gray-200 bg-white"},o.map(function(e,t){return d().createElement("tr",{key:t,className:"bg-white"},d().createElement("td",{className:"px-4 py-3 text-sm text-gray-900 font-medium"},e.tag),d().createElement("td",{className:"px-4 py-3 text-sm text-gray-700"},l(e.value)))}))))),0===o.length&&d().createElement("div",null,d().createElement("h3",{className:"text-lg font-semibold text-gray-900 mb-4"},(0,g.__)("EXIF Data","nggallery")),d().createElement("div",{className:"bg-gray-50 rounded-lg p-4"},d().createElement("p",{className:"text-sm text-gray-600 text-center"},(0,g.__)("No EXIF data available for this image.","nggallery"))))))};function Ge(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function Me(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ge(Object(n),!0).forEach(function(t){(0,f.A)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ge(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function ze(){var e,t,n="function"==typeof Symbol?Symbol:{},a=n.iterator||"@@iterator",r=n.toStringTag||"@@toStringTag";function l(n,a,r,l){var c=a&&a.prototype instanceof o?a:o,s=Object.create(c.prototype);return Le(s,"_invoke",function(n,a,r){var l,o,c,s=0,u=r||[],g=!1,m={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return l=t,o=0,c=e,m.n=n,i}};function d(n,a){for(o=n,c=a,t=0;!g&&s&&!r&&t<u.length;t++){var r,l=u[t],d=m.p,p=l[2];n>3?(r=p===a)&&(c=l[(o=l[4])?5:(o=3,3)],l[4]=l[5]=e):l[0]<=d&&((r=n<2&&d<l[1])?(o=0,m.v=a,m.n=l[1]):d<p&&(r=n<3||l[0]>a||a>p)&&(l[4]=n,l[5]=a,m.n=p,o=0))}if(r||n>1)return i;throw g=!0,a}return function(r,u,p){if(s>1)throw TypeError("Generator is already running");for(g&&1===u&&d(u,p),o=u,c=p;(t=o<2?e:c)||!g;){l||(o?o<3?(o>1&&(m.n=-1),d(o,c)):m.n=c:m.v=c);try{if(s=2,l){if(o||(r="next"),t=l[r]){if(!(t=t.call(l,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,o<2&&(o=0)}else 1===o&&(t=l.return)&&t.call(l),o<2&&(c=TypeError("The iterator does not provide a '"+r+"' method"),o=1);l=e}else if((t=(g=m.n<0)?c:n.call(a,m))!==i)break}catch(t){l=e,o=1,c=t}finally{s=1}}return{value:t,done:g}}}(n,r,l),!0),s}var i={};function o(){}function c(){}function s(){}t=Object.getPrototypeOf;var u=[][a]?t(t([][a]())):(Le(t={},a,function(){return this}),t),g=s.prototype=o.prototype=Object.create(u);function m(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,Le(e,r,"GeneratorFunction")),e.prototype=Object.create(g),e}return c.prototype=s,Le(g,"constructor",s),Le(s,"constructor",c),c.displayName="GeneratorFunction",Le(s,r,"GeneratorFunction"),Le(g),Le(g,r,"Generator"),Le(g,a,function(){return this}),Le(g,"toString",function(){return"[object Generator]"}),(ze=function(){return{w:l,m}})()}function Le(e,t,n,a){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}Le=function(e,t,n,a){function l(t,n){Le(e,t,function(e){return this._invoke(t,n,e)})}t?r?r(e,t,{value:n,enumerable:!a,configurable:!a,writable:!a}):e[t]=n:(l("next",0),l("throw",1),l("return",2))},Le(e,t,n,a)}var Re=function(){return d().createElement("div",{className:"absolute inset-0 bg-white bg-opacity-60 flex items-center justify-center z-20"},d().createElement(i.Nl,{className:"animate-spin h-8 w-8 -mt-[48px] text-green-500"}))},Be=(0,m.memo)(function(e){var t,n=e.image,r=e.gallery,l=e.isSelected,o=e.onSelect,s=e.onDelete,p=e.onRecover,f=e.onGenerateThumbnail,h=e.isProcessing,E=e.onToggleVisibility,w=(0,m.useState)(!1),x=(0,a.A)(w,2),C=x[0],A=x[1],k=(0,m.useState)(!1),S=(0,a.A)(k,2),N=S[0],T=S[1],I=(0,m.useState)(!1),O=(0,a.A)(I,2),P=O[0],j=O[1],D=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:768,t=(0,m.useState)(!1),n=(0,a.A)(t,2),r=n[0],l=n[1];return(0,m.useEffect)(function(){var t=function(){l(window.innerWidth<e)};return t(),window.addEventListener("resize",t),function(){return window.removeEventListener("resize",t)}},[e]),r}(),F=(0,u.useDispatch)(c.E),G=(0,Ie.jE)(),M=(0,b.iX)((null==r?void 0:r.gid)||null).data,z=(0,b.Fv)(),L=(0,v.E)(),R=L.showSuccess,B=L.showError,q=(0,m.useCallback)(function(){var e=function(e){var t,n=null===(t=e.meta_data)||void 0===t?void 0:t._envira_cdn_id;return n?"https://images.envira-cdn.com/cdn-cgi/imagedelivery/Fcmm2_rOlMVEVM7KyY_2rw/".concat(n,"/w=original"):null}(n);e&&window.open(e,"_blank"),A(!1)},[n]),K=(0,m.useCallback)((0,y.A)(ze().m(function e(){var t,a,l,i,o,c,s;return ze().w(function(e){for(;;)switch(e.p=e.n){case 0:if(null!==(t=n.meta_data)&&void 0!==t&&t._envira_cdn_id){e.n=1;break}return e.a(2);case 1:if(a=Se(),l=Ne(),a){e.n=2;break}return B((0,g.__)("Authentication error","nggallery")),A(!1),e.a(2);case 2:return A(!1),e.p=3,e.n=4,fetch("".concat(l,"envira-cdn/v1/ngg-remove-image/").concat(n.pid),{method:"DELETE",headers:{"X-WP-Nonce":a}});case 4:if((i=e.v).ok){e.n=6;break}return e.n=5,i.json().catch(function(){return{}});case 5:return o=e.v,console.error("CDN removal error:",o),B((0,g.__)("Failed to remove image from CDN","nggallery")),e.a(2);case 6:return e.n=7,i.json();case 7:if(!(c=e.v).success){e.n=9;break}if(R((0,g.__)("Image removed from CDN successfully","nggallery")),null==r||!r.gid){e.n=8;break}return e.n=8,G.invalidateQueries({queryKey:["gallery",r.gid,"images"]});case 8:e.n=10;break;case 9:B(c.message||(0,g.__)("Failed to remove image from CDN","nggallery"));case 10:e.n=12;break;case 11:e.p=11,s=e.v,console.error("CDN removal error:",s),B((0,g.__)("Error removing image from CDN","nggallery"));case 12:return e.a(2)}},e,null,[[3,11]])})),[n,null==r?void 0:r.gid,G,R,B]),U=(null==n?void 0:n.pid)||0,Y=(0,fe.gl)({id:U,transition:{duration:150,easing:"cubic-bezier(0.25, 1, 0.5, 1)"}}),W=Y.attributes,X=Y.listeners,Q=Y.setNodeRef,V=Y.transform,H=Y.transition,J=Y.isDragging;if(!n||null==n||!n.pid||"number"!=typeof n.pid)return null;if(null==n||!n.filename||null==r||!r.path)return null;var $={transform:je.Ks.Transform.toString(V),transition:H,opacity:J?.5:1,touchAction:"none",willChange:"transform, opacity",pointerEvents:h?"none":void 0},Z=function(){var e=(0,y.A)(ze().m(function e(){return ze().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,p(n.pid);case 1:A(!1);case 2:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),ee=D||N||l,te=function(){var e=(0,y.A)(ze().m(function e(){var t;return ze().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,z.mutateAsync({galleryId:r.gid,imageId:n.pid});case 1:R((0,g.__)("Gallery thumbnail updated successfully","nggallery")),e.n=3;break;case 2:e.p=2,t=e.v,console.error("Error setting gallery thumbnail:",t),B((0,g.__)("Failed to update gallery thumbnail","nggallery"));case 3:A(!1);case 4:return e.a(2)}},e,null,[[0,2]])}));return function(){return e.apply(this,arguments)}}(),ne=(null===(t=M||r)||void 0===t?void 0:t.previewpic)===n.pid;return d().createElement("div",{className:"relative w-full sm:w-full md:w-[130px] ".concat(h?"opacity-50":"")},d().createElement("div",{ref:Q,style:$,className:"relative bg-white rounded-lg will-change-transform ".concat(J?"z-10 shadow-xl ring-2 ring-green-500":""),"data-testid":"sortable-image-".concat(n.pid),onMouseEnter:function(){return T(!0)},onMouseLeave:function(){D||(T(!1),A(!1))},onTouchStart:function(){T(!0)}},h&&d().createElement(Re,null),d().createElement("div",{className:"absolute top-2 left-2 z-20"},d().createElement("input",{title:(0,g.__)("Select image","nggallery"),type:"checkbox",checked:l,onChange:function(){return o(n.pid)},onClick:function(e){return e.stopPropagation()},className:"rounded border-gray-300 ".concat(h?"cursor-not-allowed":"cursor-pointer"," w-5 h-5 md:w-4 md:h-4 text-green-600 focus:ring-green-500 focus:ring-2"),disabled:h})),d().createElement("div",{className:"absolute top-2 right-2 z-20 ".concat(h?"cursor-not-allowed":"cursor-pointer")},d().createElement(he.m,{isOpen:C,onClose:function(){A(!1)},onToggle:function(){A(!C)},trigger:d().createElement("button",{title:(0,g.__)("Actions","nggallery"),className:"bg-transparent p-2 md:p-1 hover:bg-opacity-80 focus:outline-none ".concat(h?"cursor-not-allowed":"cursor-pointer"),onClick:function(e){e.stopPropagation(),e.preventDefault(),A(!C)},disabled:h},d().createElement("svg",{className:"w-6 h-6 md:w-5 md:h-5 text-white hover:text-gray-300",viewBox:"0 0 20 20",fill:"currentColor"},d().createElement("path",{d:"M10 6a2 2 0 110-4 2 2 0 010 4zM10 12a2 2 0 110-4 2 2 0 010 4zM10 18a2 2 0 110-4 2 2 0 010 4z"})))},d().createElement("div",{className:"py-1"},d().createElement("button",{onClick:function(){F.setActiveModal("editImage",{image:n}),A(!1),T(!1)},className:"block w-full text-left px-4 py-1.5 text-sm text-gray-700 hover:bg-gray-100 ".concat(h?"cursor-not-allowed":"cursor-pointer"),disabled:h},(0,g.__)("Edit Details","nggallery")),d().createElement("button",{onClick:function(){F.setActiveModal("imageView",{image:{filename:n.filename,alttext:n.alttext,galleryPath:(null==r?void 0:r.path)||"",pid:n.pid,galleryid:n.galleryid,image_url:n.image_url}}),A(!1),T(!1)},className:"block w-full text-left px-4 py-1.5 text-sm text-gray-700 hover:bg-gray-100 ".concat(h?"cursor-not-allowed":"cursor-pointer"),disabled:h},(0,g.__)("Edit Image","nggallery")),d().createElement("button",{onClick:function(){j(!0),A(!1),T(!1)},className:"block w-full text-left px-4 py-1.5 text-sm text-gray-700 hover:bg-gray-100 ".concat(h?"cursor-not-allowed":"cursor-pointer"),disabled:h},(0,g.__)("View Meta","nggallery")),d().createElement("button",{onClick:function(){s(n),A(!1)},className:"block w-full text-left px-4 py-1.5 text-sm text-red-600 hover:bg-gray-100 ".concat(h?"cursor-not-allowed":"cursor-pointer"),disabled:h},(0,g.__)("Delete Image","nggallery")),d().createElement("button",{onClick:Z,className:"block w-full text-left px-4 py-1.5 text-sm text-gray-700 hover:bg-gray-100 ".concat(h?"cursor-not-allowed":"cursor-pointer"),disabled:h},(0,g.__)("Recover from Backup","nggallery")),d().createElement("button",{onClick:function(){f(n.pid),A(!1)},className:"block w-full text-left px-4 py-1.5 text-sm text-gray-700 hover:bg-gray-100 ".concat(h?"cursor-not-allowed":"cursor-pointer"),disabled:h},(0,g.__)("Generate Thumbnail","nggallery")),d().createElement("button",{onClick:te,className:"block w-full text-left px-4 py-1.5 text-sm text-gray-700 hover:bg-gray-100  ".concat(h||ne?"cursor-not-allowed":"cursor-pointer"),disabled:h||ne},ne?(0,g.__)("Current Preview Thumbnail","nggallery"):(0,g.__)("Set as Preview Thumbnail","nggallery")),d().createElement("button",{onClick:function(e){e.stopPropagation(),E(n,!n.exclude),A(!1),T(!1)},className:"block w-full text-left px-4 py-1.5 text-sm ".concat(n.exclude?"text-blue-600":"text-gray-700"," hover:bg-gray-100 ").concat(h?"cursor-not-allowed":"cursor-pointer"),disabled:h},n.exclude?(0,g.__)("Show Image","nggallery"):(0,g.__)("Hide Image","nggallery")),Ce()&&ke(n)&&d().createElement(d().Fragment,null,d().createElement("button",{onClick:q,className:"block w-full text-left px-4 py-1.5 text-sm text-blue-600 hover:bg-gray-100 cursor-pointer"},(0,g.__)("View CDN URL","nggallery")),d().createElement("button",{onClick:K,className:"block w-full text-left px-4 py-1.5 text-sm text-orange-600 hover:bg-gray-100 cursor-pointer"},(0,g.__)("Remove from CDN","nggallery")))))),d().createElement("div",{className:"overflow-hidden rounded-lg bg-gray-100 flex items-center justify-center relative cursor-pointer w-full h-[100px] sm:h-[120px] md:w-[130px] md:h-[90px]",onClick:function(e){e.stopPropagation(),F.setActiveModal("galleryImageView",{image:{filename:n.filename,alttext:n.alttext,galleryPath:(null==r?void 0:r.path)||"",pid:n.pid},galleryId:null==r?void 0:r.gid})}},d().createElement("img",{src:"".concat(n.thumb_url||"").concat(n.reloadKey?"?t=".concat(n.reloadKey):""),alt:n.alttext||"",className:"w-full h-full object-cover cursor-pointer ".concat(n.exclude?"opacity-50 grayscale":""),loading:"lazy",draggable:!1}),n.exclude&&d().createElement("div",{className:"absolute inset-0 flex items-center justify-center bg-black bg-opacity-30"},d().createElement("div",{className:"bg-gray-600 text-white text-xs px-2 py-1 rounded font-medium shadow-lg"},(0,g.__)("Hidden","nggallery"))),ee&&d().createElement("div",{className:"absolute inset-0 bg-black bg-opacity-60 flex items-center justify-center z-10 transition-opacity"})),d().createElement("div",{className:"mt-2 px-1"},d().createElement("div",{className:"flex items-center justify-between"},d().createElement("p",{className:"text-sm text-gray-900 truncate flex-1 mr-2",title:n.alttext||n.filename},n.alttext||n.filename),d().createElement("button",(0,_.A)({},h?{}:Me(Me({},W),X),{className:"flex-shrink-0 text-gray-100 p-1 rounded hover:bg-gray-100 ".concat(h?"cursor-not-allowed opacity-50":"cursor-move"),disabled:h,title:(0,g.__)("Drag to reorder","nggallery")}),d().createElement(i.GG,{className:"text-gray-500"}))),n.tags&&n.tags.length>0&&d().createElement("div",{className:"mt-1 flex flex-nowrap gap-1 overflow-hidden"},function(){for(var e=0,t=[],a=0;a<n.tags.length;a++){var r=n.tags[a],l=r.length+2;if(e+l>15)break;t.push(r),e+=l}var i=n.tags.length-t.length;return d().createElement(d().Fragment,null,t.map(function(e,t){return d().createElement("span",{key:t,className:"inline-flex items-center px-1.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-700 flex-shrink-0",title:e},e)}),i>0&&d().createElement("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-700 flex-shrink-0"},"+",i))}()))),d().createElement(Fe,{isOpen:P,onClose:function(){return j(!1)},image:n}))});Be.displayName="SortableImage";const qe=Be;function Ke(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError((0,pe.A)(e)+" is not iterable")}function Ue(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function Ye(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ue(Object(n),!0).forEach(function(t){(0,f.A)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ue(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function We(){var e,t,n="function"==typeof Symbol?Symbol:{},a=n.iterator||"@@iterator",r=n.toStringTag||"@@toStringTag";function l(n,a,r,l){var c=a&&a.prototype instanceof o?a:o,s=Object.create(c.prototype);return Xe(s,"_invoke",function(n,a,r){var l,o,c,s=0,u=r||[],g=!1,m={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return l=t,o=0,c=e,m.n=n,i}};function d(n,a){for(o=n,c=a,t=0;!g&&s&&!r&&t<u.length;t++){var r,l=u[t],d=m.p,p=l[2];n>3?(r=p===a)&&(c=l[(o=l[4])?5:(o=3,3)],l[4]=l[5]=e):l[0]<=d&&((r=n<2&&d<l[1])?(o=0,m.v=a,m.n=l[1]):d<p&&(r=n<3||l[0]>a||a>p)&&(l[4]=n,l[5]=a,m.n=p,o=0))}if(r||n>1)return i;throw g=!0,a}return function(r,u,p){if(s>1)throw TypeError("Generator is already running");for(g&&1===u&&d(u,p),o=u,c=p;(t=o<2?e:c)||!g;){l||(o?o<3?(o>1&&(m.n=-1),d(o,c)):m.n=c:m.v=c);try{if(s=2,l){if(o||(r="next"),t=l[r]){if(!(t=t.call(l,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,o<2&&(o=0)}else 1===o&&(t=l.return)&&t.call(l),o<2&&(c=TypeError("The iterator does not provide a '"+r+"' method"),o=1);l=e}else if((t=(g=m.n<0)?c:n.call(a,m))!==i)break}catch(t){l=e,o=1,c=t}finally{s=1}}return{value:t,done:g}}}(n,r,l),!0),s}var i={};function o(){}function c(){}function s(){}t=Object.getPrototypeOf;var u=[][a]?t(t([][a]())):(Xe(t={},a,function(){return this}),t),g=s.prototype=o.prototype=Object.create(u);function m(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,Xe(e,r,"GeneratorFunction")),e.prototype=Object.create(g),e}return c.prototype=s,Xe(g,"constructor",s),Xe(s,"constructor",c),c.displayName="GeneratorFunction",Xe(s,r,"GeneratorFunction"),Xe(g),Xe(g,r,"Generator"),Xe(g,a,function(){return this}),Xe(g,"toString",function(){return"[object Generator]"}),(We=function(){return{w:l,m}})()}function Xe(e,t,n,a){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}Xe=function(e,t,n,a){function l(t,n){Xe(e,t,function(e){return this._invoke(t,n,e)})}t?r?r(e,t,{value:n,enumerable:!a,configurable:!a,writable:!a}):e[t]=n:(l("next",0),l("throw",1),l("return",2))},Xe(e,t,n,a)}function Qe(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Ve(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ve(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,i=!0,o=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){o=!0,l=e},f:function(){try{i||null==n.return||n.return()}finally{if(o)throw l}}}}function Ve(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}var He=function(e){var t=e.onClick;return d().createElement("div",{className:"relative w-full"},d().createElement("div",{className:"relative bg-gray-100 rounded-lg border-2 border-dashed border-gray-300 hover:border-gray-400 cursor-pointer transition-colors w-full h-[90px] sm:h-[100px] md:w-[130px] md:h-[90px]",onClick:t},d().createElement("div",{className:"absolute inset-0 flex flex-col items-center justify-center"},d().createElement(i.c1,{className:"w-6 h-6 sm:w-8 sm:h-8 text-gray-400 mb-1 sm:mb-2"}),d().createElement("span",{className:"text-xs sm:text-sm text-gray-500 font-medium"},(0,g.__)("Add Images","nggallery")))))};const Je=function(e){var t=e.gallery,n=e.error,r=(0,u.useDispatch)(c.E),l=N(),o=l.state,s=l.updateImageSettings,p=(0,we.r)(),_=p.navigateTo,f=p.currentId,h=(0,v.E)(),E=h.showSuccess,w=h.showError,x=(0,Ee.UG)().data,C=(null==x?void 0:x.item_details_per_page)||50,A=(null==t?void 0:t.gid)||f,k=(0,Ie.jE)(),S=(0,b.TG)(),T=(0,ve.yr)(),I=(0,b.sr)(),O=(0,b.fZ)(),P=(0,b.Hh)(),j=(0,b.CD)(),D=(0,b.cX)(),F=(0,b.NK)(),G=(0,m.useState)([]),M=(0,a.A)(G,2),z=M[0],L=M[1],R=(0,m.useState)(null),B=(0,a.A)(R,2),q=B[0],K=B[1],U=(0,m.useState)(!1),Y=(0,a.A)(U,2),W=Y[0],X=Y[1],Q=(0,m.useState)(!1),V=(0,a.A)(Q,2),H=V[0],J=V[1],$=(0,m.useState)(new Set),Z=(0,a.A)($,2),ee=Z[0],te=Z[1],ne=(0,m.useState)(!1),ae=(0,a.A)(ne,2),re=ae[0],le=ae[1],ie=new Set(o.imageSettings.selectedImages||[]),oe=function(e){try{s({selectedImages:Array.from(e)})}catch(e){console.error("Error updating image settings:",e)}},ce=(0,ye.FR)((0,ye.MS)(ye.AN,{activationConstraint:{distance:8,delay:100,tolerance:10}}),(0,ye.MS)(ye.uN,{coordinateGetter:fe.JR})),se=(0,b.iX)(null!=A?A:0),ue=se.data,ge=se.isLoading,me=se.error,de=se.isError,pe=(0,m.useState)(1),Ae=(0,a.A)(pe,2),Oe=Ae[0],je=Ae[1],De=(0,b.gj)(null!=A?A:0,{per_page:C,page:Oe}),Fe=De.data,Ge=De.isLoading,Me=De.error,ze=(null==Fe?void 0:Fe.images)||[],Le=(null==Fe?void 0:Fe.pagination)||{total:0,total_pages:1,per_page:C,current_page:Oe};(0,m.useEffect)(function(){je(1)},[A]);var Re=Le.total,Be=Le.total_pages,Ue=(0,m.useCallback)(function(e){je(e),window.scrollTo({top:0,behavior:"smooth"})},[]),Xe=(0,m.useRef)(!1);(0,m.useEffect)(function(){me&&A&&!Xe.current&&(Xe.current=!0,w((0,g.__)("Gallery not found.","nggallery")),_("imagely-galleries","galleries"))},[me,A,w,_]),(0,m.useEffect)(function(){de&&A&&!me&&!Xe.current&&(Xe.current=!0,w((0,g.__)("Gallery not found.","nggallery")),_("imagely-galleries","galleries"))},[de,A,me,w,_]);var Ve=ue||t;(0,m.useEffect)(function(){ze.length>0&&L(ze)},[ze]);var Je=(0,m.useCallback)(function(){var e=(0,y.A)(We().m(function e(t){var n,a,r,l,i,o,c,s,u,m,d,p,_,y,f;return We().w(function(e){for(;;)switch(e.p=e.n){case 0:if(n=t.active,a=t.over,K(null),!a||n.id===a.id||!A){e.n=7;break}return r=z.findIndex(function(e){return e.pid===n.id}),l=z.findIndex(function(e){return e.pid===a.id}),i=(0,fe.be)(z,r,l),L(i),e.p=1,o=(0,xe.m9)(),e.n=2,Pe()({path:"/imagely/v1/images?gallery_id=".concat(A,"&per_page=-1&orderby=sortorder&order=asc"),method:"GET",headers:{"X-WP-Nonce":o}});case 2:if(c=e.v,Array.isArray(c)&&0!==c.length){e.n=3;break}return e.a(2);case 3:s=new Set(i.map(function(e){return e.pid})),u=[],m=0,d=Qe(c);try{for(d.s();!(p=d.n()).done;)_=p.value,s.has(_.pid)?(u.push(i[m]),m++):u.push(_)}catch(e){d.e(e)}finally{d.f()}return y=u.map(function(e,t){return{id:e.pid,sortorder:t+1}}),e.n=4,S.mutateAsync({images:y});case 4:e.n=6;break;case 5:e.p=5,f=e.v,console.error("Error reordering images:",f),w((0,g.__)("Failed to reorder images","nggallery")),k.invalidateQueries({queryKey:["gallery",A,"images"]});case 6:window.navigator.vibrate&&window.navigator.vibrate([50,50,50]);case 7:return e.a(2)}},e,null,[[1,5]])}));return function(t){return e.apply(this,arguments)}}(),[S,A,z,k,w]),$e=(0,m.useMemo)(function(){return z.map(function(e){return e.pid})},[z]),Ze=function(){var e=(0,y.A)(We().m(function e(n){var a,r,l,i,o;return We().w(function(e){for(;;)switch(e.p=e.n){case 0:if(t&&A){e.n=1;break}return w((0,g.__)("Cannot sort: Gallery not loaded","nggallery")),e.a(2);case 1:return e.p=1,s({sortBy:n,sortOrder:"asc"}),E((0,g.__)("Sorting images...","nggallery")),a=(0,xe.m9)(),e.n=2,Pe()({path:"/imagely/v1/images?gallery_id=".concat(A,"&per_page=-1&orderby=sortorder&order=asc"),method:"GET",headers:{"X-WP-Nonce":a}});case 2:if(r=e.v,Array.isArray(r)&&0!==r.length){e.n=3;break}return w((0,g.__)("No images found to sort","nggallery")),e.a(2);case 3:return l=(0,_e.A)(r),"invert"===n?l.reverse():l.sort(function(e,t){switch(n){case"pid":return e.pid-t.pid;case"filename":return(e.filename||"").localeCompare(t.filename||"");case"alttext":return(e.alttext||"").localeCompare(t.alttext||"");case"imagedate":return new Date(t.imagedate||0).getTime()-new Date(e.imagedate||0).getTime();default:return 0}}),i=l.map(function(e,t){return{id:e.pid,sortorder:t+1}}),e.n=4,S.mutateAsync({images:i});case 4:return e.n=5,k.invalidateQueries({queryKey:["galleryImages",A]});case 5:E((0,g.__)("Images sorted successfully!","nggallery")),e.n=7;break;case 6:e.p=6,o=e.v,w((0,g.__)("Failed to sort images: ","nggallery")+(o instanceof Error?o.message:String(o)));case 7:return e.a(2)}},e,null,[[1,6]])}));return function(t){return e.apply(this,arguments)}}(),et=function(e){var t=new Set(ie);t.has(e)?t.delete(e):t.add(e),oe(t)},tt=function(e){var t;r.setActiveModal("deleteImages",{images:[e],onClose:function(){return r.setActiveModal(null)},onConfirm:(t=(0,y.A)(We().m(function t(){return We().w(function(t){for(;;)switch(t.n){case 0:return L(function(t){return t.filter(function(t){return t.pid!==e.pid})}),t.n=1,r.deleteItem("images",e.pid);case 1:r.setActiveModal(null);case 2:return t.a(2)}},t)})),function(){return t.apply(this,arguments)})})},nt=function(){var e=(0,y.A)(We().m(function e(t){var n,a,r,l;return We().w(function(e){for(;;)switch(e.p=e.n){case 0:return te(function(e){return new Set(e).add(t)}),e.p=1,e.n=2,O.mutateAsync(t);case 2:n=Date.now(),A&&k.setQueriesData({queryKey:["gallery",A,"images"]},function(e){return null!=e&&e.images?Ye(Ye({},e),{},{images:e.images.map(function(e){return e.pid===t?Ye(Ye({},e),{},{reloadKey:n}):e})}):e}),Ve&&Ve.previewpic===t&&(r="".concat((null===(a=Ve.previewpic_url)||void 0===a?void 0:a.split("?")[0])||"","?t=").concat(n),k.setQueryData(["gallery",Ve.gid],function(e){return e?Ye(Ye({},e),{},{previewpic_url:r}):e}),k.setQueriesData({queryKey:["galleries"]},function(e){return null!=e&&e.galleries?Ye(Ye({},e),{},{galleries:e.galleries.map(function(e){return e.gid===Ve.gid?Ye(Ye({},e),{},{previewpic_url:r}):e})}):e})),e.n=4;break;case 3:e.p=3,l=e.v,console.error("Error recovering image",l);case 4:return e.p=4,te(function(e){var n=new Set(e);return n.delete(t),n}),e.f(4);case 5:return e.a(2)}},e,null,[[1,3,4,5]])}));return function(t){return e.apply(this,arguments)}}(),at=function(){var e=(0,y.A)(We().m(function e(t){var n,a,r,l;return We().w(function(e){for(;;)switch(e.p=e.n){case 0:return te(function(e){return new Set(e).add(t)}),e.p=1,e.n=2,P.mutateAsync(t);case 2:n=Date.now(),A&&k.setQueriesData({queryKey:["gallery",A,"images"]},function(e){return null!=e&&e.images?Ye(Ye({},e),{},{images:e.images.map(function(e){return e.pid===t?Ye(Ye({},e),{},{reloadKey:n}):e})}):e}),Ve&&Ve.previewpic===t&&(r="".concat((null===(a=Ve.previewpic_url)||void 0===a?void 0:a.split("?")[0])||"","?t=").concat(n),k.setQueryData(["gallery",Ve.gid],function(e){return e?Ye(Ye({},e),{},{previewpic_url:r}):e}),k.setQueriesData({queryKey:["galleries"]},function(e){return null!=e&&e.galleries?Ye(Ye({},e),{},{galleries:e.galleries.map(function(e){return e.gid===Ve.gid?Ye(Ye({},e),{},{previewpic_url:r}):e})}):e})),e.n=4;break;case 3:e.p=3,l=e.v,console.error("Error generating thumbnail",l);case 4:return e.p=4,te(function(e){var n=new Set(e);return n.delete(t),n}),e.f(4);case 5:return e.a(2)}},e,null,[[1,3,4,5]])}));return function(t){return e.apply(this,arguments)}}(),rt=function(){var e=(0,y.A)(We().m(function e(t,n){var a,r,l,i;return We().w(function(e){for(;;)switch(e.p=e.n){case 0:return te(function(e){return new Set(e).add(t)}),e.p=1,e.n=2,I.mutateAsync({pid:t,rotation:n});case 2:a=Date.now(),A&&k.setQueriesData({queryKey:["gallery",A,"images"]},function(e){return null!=e&&e.images?Ye(Ye({},e),{},{images:e.images.map(function(e){return e.pid===t?Ye(Ye({},e),{},{reloadKey:a}):e})}):e}),Ve&&Ve.previewpic===t&&(l="".concat((null===(r=Ve.previewpic_url)||void 0===r?void 0:r.split("?")[0])||"","?t=").concat(a),k.setQueryData(["gallery",Ve.gid],function(e){return e?Ye(Ye({},e),{},{previewpic_url:l}):e}),k.setQueriesData({queryKey:["galleries"]},function(e){return null!=e&&e.galleries?Ye(Ye({},e),{},{galleries:e.galleries.map(function(e){return e.gid===Ve.gid?Ye(Ye({},e),{},{previewpic_url:l}):e})}):e})),e.n=4;break;case 3:e.p=3,i=e.v,console.error("Error rotating image",i);case 4:return e.p=4,te(function(e){var n=new Set(e);return n.delete(t),n}),e.f(4);case 5:return e.a(2)}},e,null,[[1,3,4,5]])}));return function(t,n){return e.apply(this,arguments)}}(),lt=function(){var e=(0,y.A)(We().m(function e(){var t,n,a,r,l;return We().w(function(e){for(;;)switch(e.p=e.n){case 0:t=z.filter(function(e){return ie.has(e.pid)}),te(function(e){var n=new Set(e);return t.forEach(function(e){return n.add(e.pid)}),n}),n=Qe(t),e.p=1,n.s();case 2:if((a=n.n()).done){e.n=4;break}return r=a.value,e.n=3,nt(r.pid);case 3:e.n=2;break;case 4:e.n=6;break;case 5:e.p=5,l=e.v,n.e(l);case 6:return e.p=6,n.f(),e.f(6);case 7:J(!1),oe(new Set);case 8:return e.a(2)}},e,null,[[1,5,6,7]])}));return function(){return e.apply(this,arguments)}}(),it=function(){var e=(0,y.A)(We().m(function e(){var t,n,a,r,l,i,o,c,s,u;return We().w(function(e){for(;;)switch(e.p=e.n){case 0:if(t=z.filter(function(e){return ie.has(e.pid)}),0!==(n=t.filter(function(e){return ke(e)})).length){e.n=1;break}return w((0,g.__)("No selected images are on CDN","nggallery")),J(!1),e.a(2);case 1:if(a=Se(),r=Ne(),a){e.n=2;break}return w((0,g.__)("Authentication error","nggallery")),J(!1),e.a(2);case 2:te(function(e){var t=new Set(e);return n.forEach(function(e){return t.add(e.pid)}),t}),J(!1),l=0,i=0,o=Qe(n),e.p=3,s=We().m(function e(){var t,n,o;return We().w(function(e){for(;;)switch(e.p=e.n){case 0:return t=c.value,e.p=1,e.n=2,fetch("".concat(r,"envira-cdn/v1/ngg-remove-image/").concat(t.pid),{method:"DELETE",headers:{"X-WP-Nonce":a}});case 2:if(!(n=e.v).ok){e.n=4;break}return e.n=3,n.json();case 3:e.v.success?l++:i++,e.n=5;break;case 4:i++;case 5:e.n=7;break;case 6:e.p=6,o=e.v,console.error("CDN removal error:",o),i++;case 7:return e.p=7,te(function(e){var n=new Set(e);return n.delete(t.pid),n}),e.f(7);case 8:return e.a(2)}},e,null,[[1,6,7,8]])}),o.s();case 4:if((c=o.n()).done){e.n=6;break}return e.d(Ke(s()),5);case 5:e.n=4;break;case 6:e.n=8;break;case 7:e.p=7,u=e.v,o.e(u);case 8:return e.p=8,o.f(),e.f(8);case 9:if(l>0&&0===i?E((0,g.__)("Successfully removed ".concat(l," image(s) from CDN"),"nggallery")):l>0&&i>0?E((0,g.__)("Removed ".concat(l," image(s) from CDN. ").concat(i," failed."),"nggallery")):w((0,g.__)("Failed to remove images from CDN","nggallery")),!A){e.n=10;break}return e.n=10,k.invalidateQueries({queryKey:["gallery",A,"images"]});case 10:oe(new Set);case 11:return e.a(2)}},e,null,[[3,7,8,9]])}));return function(){return e.apply(this,arguments)}}(),ot=function(){var e=(0,y.A)(We().m(function e(t){var n,a,r,l,i;return We().w(function(e){for(;;)switch(e.p=e.n){case 0:n=z.filter(function(e){return ie.has(e.pid)}),te(function(e){var t=new Set(e);return n.forEach(function(e){return t.add(e.pid)}),t}),a=Qe(n),e.p=1,a.s();case 2:if((r=a.n()).done){e.n=4;break}return l=r.value,e.n=3,rt(l.pid,t);case 3:e.n=2;break;case 4:e.n=6;break;case 5:e.p=5,i=e.v,a.e(i);case 6:return e.p=6,a.f(),e.f(6);case 7:J(!1),oe(new Set);case 8:return e.a(2)}},e,null,[[1,5,6,7]])}));return function(t){return e.apply(this,arguments)}}(),ct=function(){var e=(0,y.A)(We().m(function e(){var t,n,a,r,l;return We().w(function(e){for(;;)switch(e.p=e.n){case 0:t=z.filter(function(e){return ie.has(e.pid)}),te(function(e){var n=new Set(e);return t.forEach(function(e){return n.add(e.pid)}),n}),n=Qe(t),e.p=1,r=We().m(function e(){var t,n,r;return We().w(function(e){for(;;)switch(e.p=e.n){case 0:return t=a.value,n=Date.now(),e.p=1,e.n=2,j.mutateAsync(t.pid);case 2:A&&k.setQueriesData({queryKey:["gallery",A,"images"]},function(e){return null!=e&&e.images?Ye(Ye({},e),{},{images:e.images.map(function(e){return e.pid===t.pid?Ye(Ye({},e),{},{reloadKey:n}):e})}):e}),e.n=4;break;case 3:e.p=3,r=e.v,console.error("Error setting watermark",r);case 4:return e.a(2)}},e,null,[[1,3]])}),n.s();case 2:if((a=n.n()).done){e.n=4;break}return e.d(Ke(r()),3);case 3:e.n=2;break;case 4:e.n=6;break;case 5:e.p=5,l=e.v,n.e(l);case 6:return e.p=6,n.f(),e.f(6);case 7:J(!1),oe(new Set),te(function(e){var n=new Set(e);return t.forEach(function(e){return n.delete(e.pid)}),n});case 8:return e.a(2)}},e,null,[[1,5,6,7]])}));return function(){return e.apply(this,arguments)}}(),st=function(){var e=(0,y.A)(We().m(function e(){var t,n;return We().w(function(e){for(;;)switch(e.n){case 0:t=z.filter(function(e){return ie.has(e.pid)}),n=t.map(function(e){return e.pid}),r.setActiveModal("bulkResize",{imageIds:n,galleryId:A,onConfirm:function(){oe(new Set)}});case 1:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),ut=function(){var e=(0,y.A)(We().m(function e(){var t,n,a,l;return We().w(function(e){for(;;)switch(e.p=e.n){case 0:return t=z.filter(function(e){return ie.has(e.pid)}),n=t.map(function(e){return e.pid}),te(function(e){var n=new Set(e);return t.forEach(function(e){return n.add(e.pid)}),n}),e.p=1,e.n=2,D.mutateAsync(n);case 2:(a=e.v).success_count>0&&r.showNotice("success","Successfully imported metadata for ".concat(a.success_count," of ").concat(a.processed," images")),a.failure_count>0&&r.showNotice("warning","Failed to import metadata for ".concat(a.failure_count," images")),e.n=4;break;case 3:e.p=3,l=e.v,console.error("Error bulk importing metadata:",l),r.showNotice("error","Failed to import metadata for selected images");case 4:return e.p=4,te(function(e){var n=new Set(e);return t.forEach(function(e){return n.delete(e.pid)}),n}),J(!1),oe(new Set),e.f(4);case 5:return e.a(2)}},e,null,[[1,3,4,5]])}));return function(){return e.apply(this,arguments)}}(),gt=function(){var e=(0,y.A)(We().m(function e(t,n){return We().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,T.mutateAsync({imageId:t.pid,data:{exclude:n}});case 1:L(function(e){return e.map(function(e){return e.pid===t.pid?Ye(Ye({},e),{},{exclude:n}):e})}),E((0,g.__)("Image visibility updated successfully!","nggallery")),e.n=3;break;case 2:e.p=2,e.v,w((0,g.__)("Failed to update image visibility","nggallery"));case 3:return e.a(2)}},e,null,[[0,2]])}));return function(t,n){return e.apply(this,arguments)}}(),mt=function(){var e=(0,y.A)(We().m(function e(){var t,n;return We().w(function(e){for(;;)switch(e.p=e.n){case 0:if(A){e.n=1;break}return e.a(2);case 1:return le(!0),e.p=2,e.n=3,F.mutateAsync(A);case 3:(t=e.v).images_added>0?E(t.message):r.showNotice("info",t.message),t.errors&&t.errors.length>0&&t.errors.forEach(function(e){w(e)}),e.n=5;break;case 4:e.p=4,n=e.v,w((null==n?void 0:n.message)||(0,g.__)("Failed to scan folder for new images.","nggallery"));case 5:return e.p=5,le(!1),e.f(5);case 6:return e.a(2)}},e,null,[[2,4,5,6]])}));return function(){return e.apply(this,arguments)}}();if(n)return d().createElement("div",{className:"text-red-600"},(0,g.__)("Error:","nggallery")," ",n);if(Me)return d().createElement("div",{className:"text-red-600"},(0,g.__)("Error loading images:","nggallery")," ",Me.message);var dt=q?z.find(function(e){return e.pid===q}):null,pt=((null==Ve?void 0:Ve.title)||"").replace(/<\/?[^>]+(>|$)/g,""),_t=((null==Ve?void 0:Ve.galdesc)||"").replace(/<\/?[^>]+(>|$)/g,""),yt=_t.length>100?_t.slice(0,100)+"...":_t,ft=pt.length>50?pt.slice(0,50)+"...":pt;return d().createElement("div",{className:""},d().createElement("div",{className:"p-6 lg:p-8 space-y-6"},d().createElement("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3 sm:gap-0"},d().createElement("div",{className:"flex items-center space-x-3 sm:space-x-4 ".concat(ge?"opacity-50":"")},d().createElement("img",{src:null!=Ve&&Ve.previewpic_url?null==Ve?void 0:Ve.previewpic_url:(0,Te.B)({text:"NO IMAGE"}),alt:ft,className:"w-10 h-10 sm:w-12 sm:h-12 object-cover rounded flex-shrink-0"}),d().createElement("div",{className:"flex flex-col min-w-0 flex-1"},d().createElement("div",{className:"flex flex-col sm:flex-row sm:items-center space-y-1 sm:space-y-0 sm:space-x-2"},d().createElement("h1",{className:"text-lg sm:text-xl font-semibold truncate"},ft," (",Re,")"),d().createElement("button",{className:"px-2 py-1 bg-gray-100 rounded hover:bg-gray-200 text-xs sm:text-sm flex items-center self-start sm:self-auto",onClick:function(){return r.setActiveModal("galleryEdit",{galleryId:null==Ve?void 0:Ve.gid})}},d().createElement("svg",{width:"8",height:"8",viewBox:"0 0 10 10",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"mr-1 sm:w-2.5 sm:h-2.5"},d().createElement("path",{d:"M7.5 0.500151C7.63132 0.368829 7.78722 0.264659 7.9588 0.193588C8.13038 0.122517 8.31428 0.0859375 8.5 0.0859375C8.68572 0.0859375 8.86962 0.122517 9.0412 0.193588C9.21278 0.264659 9.36868 0.36883 9.5 0.500151C9.63132 0.631473 9.73549 0.787375 9.80656 0.958955C9.87763 1.13054 9.91421 1.31443 9.91421 1.50015C9.91421 1.68587 9.87763 1.86977 9.80656 2.04135C9.73549 2.21293 9.63132 2.36883 9.5 2.50015L2.75 9.25015L0 10.0002L0.75 7.25015L7.5 0.500151Z",fill:"currentColor"})),(0,g.__)("Edit Details","nggallery"))),yt&&d().createElement("p",{className:"text-gray-500 text-xs sm:text-sm"},yt)))),d().createElement("hr",null),d().createElement("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3 sm:gap-0"},d().createElement("div",{className:"flex items-center space-x-2"},z.length>0&&d().createElement("input",{type:"checkbox",checked:ie.size===z.length,onChange:function(e){return t=e.target.checked,void oe(t?new Set(z.map(function(e){return e.pid})):new Set);var t},className:"rounded border-gray-300"}),d().createElement("h2",{className:"text-base sm:text-lg font-medium"},(0,g.__)("All Images","nggallery"))),d().createElement("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center space-y-2 sm:space-y-0 sm:space-x-4"},ie.size>0&&d().createElement(he.m,{isOpen:H,onClose:function(){return J(!1)},onToggle:function(){return J(!H)},trigger:d().createElement("button",{className:"appearance-none bg-white border rounded px-3 sm:px-4 py-2 pr-6 sm:pr-8 flex items-center justify-center space-x-2 text-sm sm:text-base w-full sm:w-auto"},d().createElement("span",null,(0,g.__)("Bulk Actions","nggallery")),d().createElement("svg",{className:"w-3 h-3 sm:w-4 sm:h-4",viewBox:"0 0 20 20",fill:"currentColor"},d().createElement("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})))},d().createElement("div",{className:"py-1"},d().createElement("button",{onClick:function(){ct(),J(!1)},className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100"},(0,g.__)("Set Watermark","nggallery")),d().createElement("button",{onClick:function(){var e,t;t=z.filter(function(e){return ie.has(e.pid)}),r.setActiveModal("deleteImages",{images:t,onClose:function(){return r.setActiveModal(null)},onConfirm:(e=(0,y.A)(We().m(function e(){return We().w(function(e){for(;;)switch(e.n){case 0:return L(function(e){return e.filter(function(e){return!ie.has(e.pid)})}),oe(new Set),e.n=1,Promise.all(t.map(function(e){return r.deleteItem("images",e.pid)}));case 1:r.setActiveModal(null);case 2:return e.a(2)}},e)})),function(){return e.apply(this,arguments)})}),J(!1)},className:"block w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-gray-100"},(0,g.__)("Delete Selected","nggallery")),d().createElement("button",{onClick:function(){lt(),J(!1)},className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100"},(0,g.__)("Recover Selected","nggallery")),d().createElement("button",{onClick:function(){var e;e=z.filter(function(e){return ie.has(e.pid)}).map(function(e){return e.pid}),r.setActiveModal("bulkGenerateThumbnails",{imageIds:e,galleryId:A,onConfirm:function(){oe(new Set)}}),J(!1)},className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100"},(0,g.__)("Generate Thumbnails","nggallery")),d().createElement("button",{onClick:function(){ot("cw"),J(!1)},className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100"},(0,g.__)("Rotate Clockwise","nggallery")),d().createElement("button",{onClick:function(){ot("ccw"),J(!1)},className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100"},(0,g.__)("Rotate Counter-Clockwise","nggallery")),d().createElement("button",{onClick:function(){st(),J(!1)},className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100"},(0,g.__)("Resize Selected","nggallery")),d().createElement("button",{onClick:function(){ut(),J(!1)},className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100"},(0,g.__)("Import Metadata","nggallery")),d().createElement("button",{onClick:function(){var e;e=z.filter(function(e){return ie.has(e.pid)}).map(function(e){return e.pid}),r.setActiveModal("gallerySelect",{imageIds:e,operation:"copy",excludeGalleryId:null==t?void 0:t.gid,onConfirm:function(){oe(new Set)}}),J(!1)},className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100"},(0,g.__)("Copy to...","nggallery")),d().createElement("button",{onClick:function(){var e;e=z.filter(function(e){return ie.has(e.pid)}).map(function(e){return e.pid}),r.setActiveModal("gallerySelect",{imageIds:e,operation:"move",excludeGalleryId:null==t?void 0:t.gid,onConfirm:function(){L(function(e){return e.filter(function(e){return!ie.has(e.pid)})}),oe(new Set)}}),J(!1)},className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100"},(0,g.__)("Move to...","nggallery")),d().createElement("button",{onClick:function(){var e;e=z.filter(function(e){return ie.has(e.pid)}).map(function(e){return e.pid}),r.setActiveModal("tags",{imageIds:e,onConfirm:function(){oe(new Set)}}),J(!1)},className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100"},(0,g.__)("Edit Tags","nggallery")),Ce()&&z.some(function(e){return ie.has(e.pid)&&ke(e)})&&d().createElement("button",{onClick:function(){it(),J(!1)},className:"block w-full text-left px-4 py-2 text-sm text-orange-600 hover:bg-gray-100"},(0,g.__)("Remove from CDN","nggallery")))),d().createElement(he.m,{isOpen:W,onClose:function(){return X(!1)},onToggle:function(){return X(!W)},trigger:d().createElement("button",{className:"appearance-none bg-white border rounded px-3 sm:px-4 py-2 pr-6 sm:pr-8 flex items-center justify-center space-x-2 text-sm sm:text-base w-full sm:w-auto"},d().createElement("span",null,(0,g.__)("Sort Images","nggallery")),d().createElement("svg",{className:"w-3 h-3 sm:w-4 sm:h-4",viewBox:"0 0 20 20",fill:"currentColor"},d().createElement("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})))},d().createElement("div",{className:"py-2"},d().createElement("button",{onClick:function(){Ze("pid"),X(!1)},className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 w-full text-left"},(0,g.__)("Sort by ID","nggallery")),d().createElement("button",{onClick:function(){Ze("filename"),X(!1)},className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 w-full text-left"},(0,g.__)("Sort by Filename","nggallery")),d().createElement("button",{onClick:function(){Ze("alttext"),X(!1)},className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 w-full text-left"},(0,g.__)("Sort by Alt Text","nggallery")),d().createElement("button",{onClick:function(){Ze("imagedate"),X(!1)},className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 w-full text-left"},(0,g.__)("Sort by Date","nggallery")),d().createElement("hr",{className:"my-2"}),d().createElement("button",{onClick:function(){Ze("invert"),X(!1)},className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 w-full text-left"},(0,g.__)("Invert Order","nggallery")))),A&&d().createElement("button",{onClick:mt,disabled:re,className:"appearance-none bg-white border rounded px-3 sm:px-4 py-2 flex items-center justify-center space-x-2 text-sm sm:text-base w-full sm:w-auto hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",title:(0,g.__)("Scan the gallery folder for new images added via FTP or file manager","nggallery")},d().createElement(i.B8,{className:"w-4 h-4"}),d().createElement("span",null,re?(0,g.__)("Scanning...","nggallery"):(0,g.__)("Scan Folder","nggallery"))))),d().createElement("div",{className:"relative ".concat(Ge?"opacity-50":"")},d().createElement(ye.Mp,{sensors:ce,collisionDetection:ye.fp,onDragStart:function(e){K(e.active.id),window.navigator.vibrate&&window.navigator.vibrate(50)},onDragEnd:Je,measuring:{droppable:{strategy:ye.Pf.Always}}},d().createElement(fe.gB,{items:$e,strategy:fe.kL},d().createElement(d().Fragment,null,d().createElement("div",{className:"grid gap-4 sm:gap-6 grid-cols-2 sm:grid-cols-3 md:grid-cols-[repeat(auto-fill,_130px)]"},d().createElement(He,{onClick:function(){return r.setActiveModal("imageUploader",{galleryId:null==Ve?void 0:Ve.gid})}}),z.map(function(e){return d().createElement(qe,{key:"".concat(e.pid,"-").concat(e.reloadKey||""),image:e,gallery:Ve,isSelected:ie.has(e.pid),onSelect:et,onDelete:tt,onRecover:nt,onGenerateThumbnail:at,isProcessing:ee.has(e.pid),onToggleVisibility:gt})})))),d().createElement(ye.Hd,null,dt&&d().createElement("div",{className:"transform scale-105 opacity-90 pointer-events-none"},d().createElement(qe,{image:dt,gallery:Ve,isSelected:ie.has(dt.pid),onSelect:et,onDelete:tt,onRecover:nt,onGenerateThumbnail:at,isProcessing:ee.has(dt.pid),onToggleVisibility:gt})))),!Ge&&Be>1&&d().createElement(be.A,{currentPage:Oe,totalPages:Be,perPage:C,total:Re,onPageChange:Ue,itemLabel:(0,g.__)("images","nggallery"),showItemCount:!0}))))};var $e=n(3633);function Ze(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function et(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ze(Object(n),!0).forEach(function(t){(0,f.A)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ze(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function tt(){var e,t,n="function"==typeof Symbol?Symbol:{},a=n.iterator||"@@iterator",r=n.toStringTag||"@@toStringTag";function l(n,a,r,l){var c=a&&a.prototype instanceof o?a:o,s=Object.create(c.prototype);return nt(s,"_invoke",function(n,a,r){var l,o,c,s=0,u=r||[],g=!1,m={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return l=t,o=0,c=e,m.n=n,i}};function d(n,a){for(o=n,c=a,t=0;!g&&s&&!r&&t<u.length;t++){var r,l=u[t],d=m.p,p=l[2];n>3?(r=p===a)&&(c=l[(o=l[4])?5:(o=3,3)],l[4]=l[5]=e):l[0]<=d&&((r=n<2&&d<l[1])?(o=0,m.v=a,m.n=l[1]):d<p&&(r=n<3||l[0]>a||a>p)&&(l[4]=n,l[5]=a,m.n=p,o=0))}if(r||n>1)return i;throw g=!0,a}return function(r,u,p){if(s>1)throw TypeError("Generator is already running");for(g&&1===u&&d(u,p),o=u,c=p;(t=o<2?e:c)||!g;){l||(o?o<3?(o>1&&(m.n=-1),d(o,c)):m.n=c:m.v=c);try{if(s=2,l){if(o||(r="next"),t=l[r]){if(!(t=t.call(l,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,o<2&&(o=0)}else 1===o&&(t=l.return)&&t.call(l),o<2&&(c=TypeError("The iterator does not provide a '"+r+"' method"),o=1);l=e}else if((t=(g=m.n<0)?c:n.call(a,m))!==i)break}catch(t){l=e,o=1,c=t}finally{s=1}}return{value:t,done:g}}}(n,r,l),!0),s}var i={};function o(){}function c(){}function s(){}t=Object.getPrototypeOf;var u=[][a]?t(t([][a]())):(nt(t={},a,function(){return this}),t),g=s.prototype=o.prototype=Object.create(u);function m(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,nt(e,r,"GeneratorFunction")),e.prototype=Object.create(g),e}return c.prototype=s,nt(g,"constructor",s),nt(s,"constructor",c),c.displayName="GeneratorFunction",nt(s,r,"GeneratorFunction"),nt(g),nt(g,r,"Generator"),nt(g,a,function(){return this}),nt(g,"toString",function(){return"[object Generator]"}),(tt=function(){return{w:l,m}})()}function nt(e,t,n,a){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}nt=function(e,t,n,a){function l(t,n){nt(e,t,function(e){return this._invoke(t,n,e)})}t?r?r(e,t,{value:n,enumerable:!a,configurable:!a,writable:!a}):e[t]=n:(l("next",0),l("throw",1),l("return",2))},nt(e,t,n,a)}const at=function(e){var t,n,r,l=e.gallery,o=e.previewMode,s=e.onPreviewModeChange,p=N(),_=p.updateField,h=p.registerFlushCallback,w=p.unregisterFlushCallback,x=(0,b.hW)(),C=(0,v.E)(),A=C.showSuccess,k=C.showError,S=(0,u.useDispatch)(c.E),T=(0,Ee.UG)().data,O=(0,Ee.h5)(),P=(0,m.useState)({title:(null==l?void 0:l.title)||"",description:(null==l?void 0:l.galdesc)||"",is_ecommerce_enabled:"1"===(null==l?void 0:l.is_ecommerce_enabled),pricelist_id:(null==l||null===(t=l.pricelist_id)||void 0===t?void 0:t.toString())||"0",pageid:(null==l||null===(n=l.pageid)||void 0===n?void 0:n.toString())||""}),j=(0,a.A)(P,2),D=j[0],F=j[1],G=(0,m.useRef)(null),R=(0,m.useRef)(null),B=(0,m.useCallback)(function(){G.current&&(clearTimeout(G.current),G.current=null),R.current&&(R.current(),R.current=null)},[]),q=(0,$e.Eq)({enabled:"pro"===c.W,per_page:-1}),K=q.data,U=q.isLoading,Y=(0,m.useState)([]),W=(0,a.A)(Y,2),X=W[0],Q=W[1],V=(0,m.useState)(!0),H=(0,a.A)(V,2),J=H[0],$=H[1],Z=(0,m.useState)([]),ee=(0,a.A)(Z,2),te=ee[0],ne=ee[1],ae=(0,m.useState)({open:!1,title:"",isCreating:!1}),re=(0,a.A)(ae,2),le=re[0],ie=re[1];(0,m.useEffect)(function(){if(l){var e,t,n,a=(null===(e=l.extras_post_meta)||void 0===e?void 0:e.pricelist_id)||(null===(t=l.pricelist_id)||void 0===t?void 0:t.toString())||"0",r="1"===String(l.is_ecommerce_enabled);if(r&&("0"===a||!a)){var i,o=null==K||null===(i=K.pricelists)||void 0===i?void 0:i[0];o&&(a=o.id.toString())}F({title:l.title||"",description:l.galdesc||"",is_ecommerce_enabled:r,pricelist_id:a,pageid:(null===(n=l.pageid)||void 0===n?void 0:n.toString())||""})}},[null==l?void 0:l.gid,K]),(0,m.useEffect)(function(){return h("settingsTab",B),function(){B(),w("settingsTab")}},[B,h,w]),(0,m.useEffect)(function(){var e=!0,t=function(){var t=(0,y.A)(tt().m(function t(){var n,a;return tt().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,Pe()({path:"/wp/v2/pages?per_page=-1&status=publish"});case 1:n=t.v,e&&Q(n),t.n=3;break;case 2:t.p=2,a=t.v,console.error("Error fetching pages:",a),e&&Q([]);case 3:return t.p=3,e&&$(!1),t.f(3);case 4:return t.a(2)}},t,null,[[0,2,3,4]])}));return function(){return t.apply(this,arguments)}}();return t(),function(){e=!1}},[]);var oe=(0,m.useCallback)(function(){var e=(0,y.A)(tt().m(function e(t,n){var a,r,l,i,o,c,s,u,m,d,p;return tt().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,l=null===(a=window.imagelyApp)||void 0===a?void 0:a.nonce,e.n=1,Pe()({path:"/wp/v2/pages/".concat(t,"?context=edit"),method:"GET",headers:{"X-WP-Nonce":l}});case 1:if(i=e.v,o=(null===(r=i.content)||void 0===r?void 0:r.raw)||"",c=new RegExp("\\[imagely[^\\]]*id=[\"']?".concat(n,"[\"']?[^\\]]*\\]"),"i"),s=new RegExp("\\[ngg[^\\]]*id=[\"']?".concat(n,"[\"']?[^\\]]*\\]"),"i"),!c.test(o)&&!s.test(o)){e.n=2;break}return e.a(2);case 2:return u='[imagely id="'.concat(n,'"]'),m=""===o.trim()?u:"".concat(o,"\n\n").concat(u),e.n=3,Pe()({path:"/wp/v2/pages/".concat(t),method:"POST",headers:{"X-WP-Nonce":l,"Content-Type":"application/json"},data:{content:m}});case 3:e.n=5;break;case 4:e.p=4,p=e.v,console.error("Error inserting gallery into page:",p),d=(null==p?void 0:p.message)||(0,g.__)("Unknown error occurred","nggallery"),k((0,g.__)("Failed to insert gallery shortcode into page: ","nggallery")+d);case 5:return e.a(2)}},e,null,[[0,4]])}));return function(t,n){return e.apply(this,arguments)}}(),[k]),ce=(0,m.useCallback)(function(){var e=(0,y.A)(tt().m(function e(t,n,a){var r,i,o;return tt().w(function(e){for(;;)switch(e.p=e.n){case 0:if(!l){e.n=9;break}if(e.p=1,r={},"title"!==t){e.n=2;break}r.title=n,e.n=6;break;case 2:if("description"!==t){e.n=3;break}r.galdesc=n,e.n=6;break;case 3:if("is_ecommerce_enabled"!==t){e.n=4;break}r.is_ecommerce_enabled=n?"1":"0",n&&(r.pricelist_id=parseInt(a.pricelist_id,10)),e.n=6;break;case 4:if("pricelist_id"!==t){e.n=5;break}r.pricelist_id=parseInt(n,10),e.n=6;break;case 5:if("pageid"!==t){e.n=6;break}if(r.pageid=n?parseInt(n,10):null,!n||""===n){e.n=6;break}return i=parseInt(n,10),e.n=6,oe(i,l.gid);case 6:return e.n=7,x.mutateAsync({id:l.gid,data:r});case 7:A((0,g.__)("Settings updated successfully!","nggallery")),e.n=9;break;case 8:e.p=8,o=e.v,console.error("Error updating settings:",o),k((0,g.__)("Failed to update settings. Please try again.","nggallery"));case 9:return e.a(2)}},e,null,[[1,8]])}));return function(t,n,a){return e.apply(this,arguments)}}(),[l,x,A,k]),se=function(e){var t=e.target,n=t.name,a=t.value,r="checkbox"===t.type?e.target.checked:a;if("pageid"!==n||"__create__"!==a){var l=et(et({},D),{},(0,f.A)({},n,r));if("is_ecommerce_enabled"===n&&r&&("0"===D.pricelist_id||!D.pricelist_id)){var i,o=null==K||null===(i=K.pricelists)||void 0===i?void 0:i[0];o&&(l.pricelist_id=o.id.toString())}F(l),_(n,r),"is_ecommerce_enabled"===n&&l.pricelist_id!==D.pricelist_id&&_("pricelist_id",l.pricelist_id),G.current&&clearTimeout(G.current);var c=function(){ce(n,r,l)};R.current=c,G.current=window.setTimeout(function(){c(),R.current=null},1e3)}else ue()},ue=function(){ie({open:!0,title:"".concat((null==l?void 0:l.title)||"Gallery"," Page"),isCreating:!1})},ge=function(){var e=(0,y.A)(tt().m(function e(){var t,n,a,r,l,i,o;return tt().w(function(e){for(;;)switch(e.p=e.n){case 0:if(le.title.trim()){e.n=1;break}return e.a(2);case 1:return e.p=1,ie(function(e){return et(et({},e),{},{isCreating:!0})}),n=null===(t=window.imagelyApp)||void 0===t?void 0:t.nonce,e.n=2,Pe()({path:"/wp/v2/pages",method:"POST",headers:{"X-WP-Nonce":n,"Content-Type":"application/json"},data:{title:le.title,content:"",status:"publish"}});case 2:a=e.v,(r=String((null==a?void 0:a.id)||""))&&(l=et(et({},D),{},{pageid:r}),F(l),_("pageid",r),i=null!=a&&a.title&&a.title.rendered?a.title.rendered:le.title,ne(function(e){return[{id:Number(r),title:{rendered:i}}].concat((0,_e.A)(e))}),ce("pageid",r,l),A((0,g.__)("Page created and linked successfully!","nggallery"))),e.n=4;break;case 3:e.p=3,o=e.v,console.error("Error creating page:",o),k((0,g.__)("Failed to create page. Please try again.","nggallery"));case 4:return e.p=4,ie({open:!1,title:"",isCreating:!1}),e.f(4);case 5:return e.a(2)}},e,null,[[1,3,4,5]])}));return function(){return e.apply(this,arguments)}}(),me=(0,m.useMemo)(function(){return[].concat((0,_e.A)(te),(0,_e.A)(X)).reduce(function(e,t){return e.find(function(e){return e.id===t.id})||e.push(t),e},[]).map(function(e){var t;return{value:String(e.id),label:(null===(t=e.title)||void 0===t?void 0:t.rendered)||"Page #".concat(e.id)}})},[X,te]),de=(0,m.useMemo)(function(){var e=(null==K?void 0:K.pricelists)||[],t=[];return t.push({value:"0",label:(0,g.__)("None","nggallery")}),Array.isArray(e)&&e.length>0&&e.forEach(function(e){t.push({value:e.id.toString(),label:e.title})}),t},[K]),pe="pro"===c.W||"plus"===c.W,ye="pro"===(null===(r=window.imagelyApp)||void 0===r?void 0:r.proTypeInstalled),fe=[].concat((0,_e.A)(pe?[{value:"photocrati-nextgen_pro_lightbox",label:(0,g.__)("Pro Lightbox","nggallery")}]:[]),[{value:"simplelightbox",label:(0,g.__)("Simplelightbox","nggallery")},{value:"fancybox",label:(0,g.__)("Fancybox","nggallery")},{value:"thickbox",label:(0,g.__)("Thickbox","nggallery")},{value:"shutter",label:(0,g.__)("Shutter","nggallery")},{value:"shutter2",label:(0,g.__)("Shutter Reloaded","nggallery")},{value:"custom_lightbox",label:(0,g.__)("Custom Lightbox","nggallery")},{value:"none",label:(0,g.__)("None","nggallery")}]),he=(0,m.useCallback)(function(){var e=(0,y.A)(tt().m(function e(t){var n,a;return tt().w(function(e){for(;;)switch(e.p=e.n){case 0:return n=t.target.value,e.p=1,e.n=2,O.mutateAsync({thumbEffect:n});case 2:A((0,g.__)("Lightbox setting updated successfully!","nggallery")),e.n=4;break;case 3:e.p=3,a=e.v,console.error("Error updating lightbox setting:",a),k((0,g.__)("Failed to update lightbox setting. Please try again.","nggallery"));case 4:return e.a(2)}},e,null,[[1,3]])}));return function(t){return e.apply(this,arguments)}}(),[O,A,k]),be=(0,u.useSelect)(function(e){return e(c.E).getCurrentId()},[]),ve=(0,b.iX)(be).data,we=(0,E.b)({type:"gallery",item:ve,includeEcommerce:D.is_ecommerce_enabled});return d().createElement(d().Fragment,null,d().createElement("div",{className:"bg-white rounded-lg shadow lg:grid lg:grid-cols-2 lg:items-start"},d().createElement("div",{className:"px-6 py-6 lg:px-8 lg:py-8 border-b lg:border-b-0 lg:border-r"},d().createElement("h1",{className:"text-lg font-medium"},(0,g.__)("Settings","nggallery")),d().createElement("div",{className:"space-y-4 mt-6"},d().createElement(z.A,{type:"text",name:"title",value:D.title,onChange:se,label:(0,g.__)("Gallery Title","nggallery"),placeholder:(0,g.__)("Enter gallery title","nggallery")}),d().createElement("div",null,d().createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},(0,g.__)("Gallery Description","nggallery")),d().createElement("textarea",{name:"description",value:D.description,onChange:se,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:3,placeholder:(0,g.__)("Enter gallery description","nggallery")})),d().createElement(M.A,{id:"pageid",name:"pageid",value:D.pageid,onChange:se,label:(0,g.__)("Link to page:","nggallery"),help:(0,g.__)("Select a page to link this gallery to, or create a new page with the gallery content","nggallery")},J?d().createElement("option",{value:""},(0,g.__)("Loading pages...","nggallery")):d().createElement(d().Fragment,null,d().createElement("option",{value:""},(0,g.__)("Not linked","nggallery")),d().createElement("option",{value:"__create__",className:"text-green-600"},(0,g.__)("Create new page","nggallery")),me.map(function(e){return d().createElement("option",{key:e.value,value:e.value},e.label)}))),d().createElement("div",null,d().createElement("h3",{className:"text-sm font-medium text-gray-900 mb-4"},(0,g.__)("eCommerce Settings","nggallery")),ye?d().createElement("div",{className:"space-y-4"},d().createElement(L.A,{id:"is_ecommerce_enabled",name:"is_ecommerce_enabled",checked:D.is_ecommerce_enabled,onChange:se,label:(0,g.__)("Enable eCommerce","nggallery"),help:(0,g.__)("Enable eCommerce functionality for this gallery","nggallery")}),D.is_ecommerce_enabled&&d().createElement("div",{className:"pl-4 border-l-2 border-gray-200"},d().createElement(M.A,{id:"pricelist_id",name:"pricelist_id",value:D.pricelist_id,onChange:se,label:(0,g.__)("Pricelist","nggallery"),help:(0,g.__)("Select a pricelist for this gallery","nggallery")},U?d().createElement("option",{value:"0",disabled:!0},(0,g.__)("Loading...","nggallery")):de.map(function(e){return d().createElement("option",{key:e.value,value:e.value},e.label)})))):d().createElement("div",{className:"relative"},d().createElement("div",{className:"opacity-50 pointer-events-none"},d().createElement(L.A,{id:"is_ecommerce_enabled",name:"is_ecommerce_enabled",checked:!1,onChange:function(){},label:(0,g.__)("Enable eCommerce","nggallery"),help:(0,g.__)("Enable eCommerce functionality for this gallery","nggallery")})),d().createElement("div",{className:"absolute inset-0 cursor-pointer",onClick:function(){ye||S.setActiveModal("upgrade",{feature:"eCommerce features"})},title:(0,g.__)("Requires NextGEN Gallery Pro","nggallery")}))),d().createElement("div",{className:"space-y-4"},d().createElement(M.A,{id:"thumbEffect",name:"thumbEffect",value:(null==T?void 0:T.thumbEffect)||"",onChange:he,label:(0,g.__)("Lightbox Library","nggallery"),help:(0,g.__)("What lightbox would you like to use?","nggallery")},fe.map(function(e){return d().createElement("option",{key:e.value,value:e.value},e.label)})),d().createElement("div",{className:"bg-info-bg border border-info-border rounded-md p-3"},d().createElement("div",{className:"flex items-start"},d().createElement("div",{className:"flex-shrink-0"},d().createElement(i.F,{className:"h-4 w-4 text-gray-400 mt-0.5"})),d().createElement("div",{className:"ml-2"},d().createElement("p",{className:"text-xs text-gray-700"},(0,g.__)("This lightbox setting affects all galleries on your site, not just this one. To configure additional lightbox options, visit the Settings page.","nggallery")))))))),d().createElement("div",{className:"px-6 py-6 lg:px-8 lg:py-8 lg:sticky lg:top-8 lg:max-h-screen"},d().createElement(I.A,{previewMode:o,onPreviewModeChange:s,url:we,title:(0,g.__)("Gallery Preview","nggallery")}))),d().createElement(De.A,{isOpen:le.open,onClose:function(){return ie({open:!1,title:"",isCreating:!1})},title:(0,g.__)("Create New Page","nggallery")},d().createElement("div",{className:"space-y-4"},d().createElement(z.A,{type:"text",id:"new_page_title",name:"new_page_title",value:le.title,onChange:function(e){return ie(function(t){return et(et({},t),{},{title:e.target.value})})},label:(0,g.__)("Page Title","nggallery"),placeholder:(0,g.__)("Enter page title...","nggallery")}),d().createElement("div",{className:"bg-info-bg border border-info-border rounded-md p-3"},d().createElement("div",{className:"flex items-start"},d().createElement("div",{className:"py-0.5 flex-shrink-0"},d().createElement(i.F,{className:"h-4 w-4 text-gray-500 mt-0.5"})),d().createElement("div",{className:"py-1 ml-2"},d().createElement("p",{className:"text-xs text-gray-500"},(0,g.__)("A new page will be created with the gallery added immediately.","nggallery"))))),d().createElement("div",{className:"flex gap-2 justify-end"},d().createElement("button",{type:"button",className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-50",onClick:function(){return ie({open:!1,title:"",isCreating:!1})},disabled:le.isCreating},(0,g.__)("Cancel","nggallery")),d().createElement("button",{type:"button",className:"px-4 py-2 text-sm font-medium text-white bg-green-500 border border-transparent rounded-md hover:bg-green-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-50 disabled:cursor-not-allowed inline-flex items-center",onClick:ge,disabled:le.isCreating||!le.title.trim()},le.isCreating?(0,g.__)("Creating...","nggallery"):(0,g.__)("Create Page","nggallery"))))))},rt=function(e){var t=e.onCreateNewGallery;return d().createElement("div",{className:"bg-white rounded-lg shadow p-8 text-center"},d().createElement("div",{className:"space-y-4"},d().createElement("button",{onClick:t,className:"px-6 py-3 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors inline-flex items-center"},d().createElement("span",{className:"mr-2"},"+"),(0,g.__)("Create New Gallery","nggallery"))))},lt=function(e){var t=e.currentTab,n=e.selectedGalleryId,a=e.gallery,r=e.error,l=e.previewMode,i=e.onPreviewModeChange,o=e.onCreateNewGallery;if(!n)return d().createElement(rt,{onCreateNewGallery:o});var c={previewMode:l,onPreviewModeChange:i};switch(t){case"images":return d().createElement(Je,{gallery:a,error:r});case"customize":return d().createElement(de,(0,_.A)({gallery:a},c));case"settings":return d().createElement(at,(0,_.A)({gallery:a},c));default:return d().createElement("div",{className:"bg-white rounded-lg shadow p-8 text-center text-gray-500"},(0,g.__)("Please select a tab to continue.","nggallery"))}};var it=function(e){var t=e.currentTab,n=e.setCurrentTab,a=e.error,l=e.selectedGalleryId,o=e.gallery,c=e.previewMode,s=e.handlePreviewModeChange,u=e.handleCreateNewGallery,g=e.handleNext,m=e.handleCancel,_=e.nextButtonText,y=e.navigateTo,f=e.isFirstTab,h=e.pageTitle,b=e.isEmbed,v=N().flushAllPendingSaves;return d().createElement("div",{className:"px-4 md:px-6 lg:px-8 py-4 md:py-6 pb-24"},!b&&d().createElement("div",{className:"mb-6 flex items-center gap-3"},d().createElement("button",{onClick:function(){return y("imagely","galleryList")},className:"flex items-center justify-center w-8 h-8 rounded-md hover:bg-gray-100 transition-colors"},d().createElement(i.Kj,{className:"w-5 h-5"})),d().createElement("h1",{className:"text-2xl font-semibold text-gray-900"},h)),d().createElement("div",{className:"bg-white shadow rounded-md pt-4 md:pt-6 lg:pt-8"},d().createElement(r.A,{currentTab:t,onTabChange:n,error:a,containerClassName:"",contentClassName:""},d().createElement(lt,{currentTab:t,selectedGalleryId:(null==l?void 0:l.toString())||null,gallery:o||null,error:a,previewMode:c,onPreviewModeChange:s,onCreateNewGallery:u}))),l&&d().createElement(p,{onNext:function(){v(),g()},onCancel:m,nextButtonText:_,isFirstTab:f}))};const ot=function(){var e=(0,m.useState)("desktop"),t=(0,a.A)(e,2),n=t[0],r=t[1],i=(0,u.useDispatch)(c.E),p=(0,o.X)(),_=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).onComplete,t=(0,u.useSelect)(function(e){var t=e(c.E);return{currentTab:t.getCurrentTab(),selectedGalleryId:t.getCurrentId()}},[]),n=t.currentTab,a=t.selectedGalleryId,r=(0,u.useDispatch)(c.E),l=(0,b.iX)(a),i=l.data,o=l.error,d=l.isLoading;(0,m.useEffect)(function(){o&&a&&(403===(null==o?void 0:o.status)||"gallery_forbidden"===(null==o?void 0:o.code))&&(r.showNotice("error",(0,g.__)("You do not have permission to access this gallery","nggallery")),r.navigateTo("imagely","galleryList"))},[o,a,r]);var p=(0,m.useMemo)(function(){return(0,T.B)().map(function(e){return e.id})},[]),_=(0,m.useMemo)(function(){return p.indexOf(n)},[p,n]),y=0===_,f=_===p.length-1,h=(0,m.useCallback)(function(e){p.includes(e)&&r.setCurrentTab(e)},[r.setCurrentTab,p]),v=(0,m.useCallback)(function(e,t,n){r.navigateTo(e,t,n)},[r.navigateTo]),E=(0,m.useCallback)(function(){f?e&&e():h(p[_+1])},[f,_,p,h,e]),w=(0,m.useCallback)(function(){y||h(p[_-1])},[y,_,p,h]),x=(0,m.useCallback)(function(e){h(e)},[h]);return(0,m.useEffect)(function(){p.includes(n)||h("images")},[n,h,p]),(0,m.useEffect)(function(){var e=new URLSearchParams(window.location.search).get("id");if(!a&&!e){if(!(0,s.HN)())return void r.setActiveModal("licenseRequired",{action:"create new galleries"});r.setActiveModal("imageUploader",{})}},[a,r.setActiveModal]),{currentTab:n,currentTabIndex:_,gallery:i,error:(null==o?void 0:o.message)||null,selectedGalleryId:a,isFirstTab:y,isLastTab:f,isLoading:d,setCurrentTab:h,goToNextTab:E,goToPreviousTab:w,goToTab:x,navigateTo:v,tabIds:p}}({onComplete:function(){i.showNotice("success",(0,g.__)("Gallery created successfully","nggallery"))},enableTabValidation:!1}),y=_.currentTab,f=_.gallery,h=_.error,v=_.selectedGalleryId,E=_.setCurrentTab,w=_.isLoading,x=_.goToNextTab,C=_.goToPreviousTab,A=_.isFirstTab,k=_.isLastTab,N=_.navigateTo,I=(0,u.useSelect)(function(e){return{currentId:e(c.E).getCurrentId()}},[]).currentId;if(w&&v)return d().createElement(l.A,{size:"xl",text:(0,g.__)("Loading gallery...","nggallery")});var O=I?(0,g.__)("Edit Gallery","nggallery"):(0,g.__)("Add New Gallery","nggallery");return d().createElement(S,{initialGallery:f},d().createElement(it,{currentTab:y,setCurrentTab:E,error:h,selectedGalleryId:v,gallery:null!=f?f:null,previewMode:n,handlePreviewModeChange:function(e){r(e)},handleCreateNewGallery:function(){(0,s.HN)()?i.setActiveModal("imageUploader",{}):i.setActiveModal("licenseRequired",{action:"create new galleries"})},handleNext:function(){var e=Number(v||(null==f?void 0:f.gid)||(null==f?void 0:f.id));if(k){if(p.isEmbed&&p.onInsertGallery){if(Number.isFinite(e)&&e>0)try{p.onInsertGallery(e)}catch(e){console.error("Failed to insert gallery:",e)}return}var t=v||(null==f?void 0:f.gid)||(null==f?void 0:f.id),n=(null==f?void 0:f.name)||"",a=(null==f?void 0:f.pageid)||null;i.setActiveModal("gallerySuccess",{galleryId:t,galleryName:n,pageId:a})}else x()},handleCancel:function(){if(A)if(p.isEmbed&&p.onClose)try{p.onClose()}catch(e){console.error("Failed to close embed:",e)}else i.navigateTo("imagely","galleryList");else C()},nextButtonText:k?(0,g.__)("Update","nggallery"):(0,g.__)("Next step","nggallery"),navigateTo:N,isFirstTab:A,pageTitle:O,isEmbed:p.isEmbed}))}}}]);