"use strict";(self.webpackChunk_envira_imagely_admin_app=self.webpackChunk_envira_imagely_admin_app||[]).push([[81],{9081:(e,t,a)=>{a.r(t),a.d(t,{default:()=>Ze});var n=a(3453),r=a(5760),l=a(9292),i=a(6106),o=a(2329),c=a(2549),s=a(1648),g=a(7143),u=a(7723),m=a(1609),d=a.n(m);const p=function(e){var t=e.onNext,a=e.onCancel,r=e.nextButtonText,l=void 0===r?(0,u.__)("Next step","nggallery"):r,i=e.showNextButton,c=void 0===i||i,s=e.showCancelButton,g=void 0===s||s,p=e.isFirstTab,_=void 0===p||p,y=(0,o.X)(),h=(null==y?void 0:y.isEmbed)||!1,f=(0,m.useState)(160),v=(0,n.A)(f,2),b=v[0],E=v[1];return(0,m.useEffect)(function(){if(!h){var e=function(){var e=document.body,t=window.innerWidth;t<=782?E(0):t<=960||e.classList.contains("folded")?E(36):E(160)};e(),window.addEventListener("resize",e);var t=new MutationObserver(e);return t.observe(document.body,{attributes:!0,attributeFilter:["class"]}),function(){window.removeEventListener("resize",e),t.disconnect()}}E(0)},[h]),d().createElement("div",{className:"fixed bottom-0 right-0 bg-white border-t border-gray-200 z-10",style:{left:"".concat(b,"px"),maxWidth:"calc(100vw - ".concat(b,"px)")}},d().createElement("div",{className:"px-2 sm:px-4 py-3 sm:px-6"},d().createElement("div",{className:"flex justify-end items-center space-x-1 sm:space-x-3"},g&&d().createElement("button",{onClick:a,className:"px-2 sm:px-4 py-2 text-xs sm:text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"},_?(0,u.__)("Cancel","nggallery"):(0,u.__)("Back","nggallery")),c&&d().createElement("button",{onClick:t,className:"px-2 sm:px-4 py-2 text-xs sm:text-sm font-medium text-white bg-green-500 border border-green-500 rounded-md hover:bg-green-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition-colors"},l))))};var _=a(8168),y=a(467),h=a(4980),f=a(9280),v=a.n(f),b=a(1966),E=a(2724),x=a(2416),w=a(9667);function C(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function k(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?C(Object(a),!0).forEach(function(t){(0,h.A)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):C(Object(a)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}var A=function(e){return e?{title:e.title||"",description:e.galdesc||"",display_type:e.display_type||"",display_type_settings:e.display_type_settings||{},settings:{gallery_display_type:e.display_type,gallery_override_global_settings:!1},imageSettings:{sortBy:"sortorder",sortOrder:"asc",selectedImages:[],searchQuery:""},isDirty:!1,lastSaved:new Date,dirtyFields:new Set}:{title:"",description:"",display_type:"",display_type_settings:{},settings:{},imageSettings:{sortBy:"sortorder",sortOrder:"asc",selectedImages:[],searchQuery:""},isDirty:!1,lastSaved:null,dirtyFields:new Set}},N=function(e,t){switch(t.type){case"INIT_FROM_GALLERY":case"RESET_TO_SAVED":return A(t.payload);case"UPDATE_FIELD":var a=t.payload,n=a.path,r=function(e,t,a){for(var n=t.split("."),r=k({},e),l=r,i=0;i<n.length-1;i++){var o=n[i];l[o]=l[o]?k({},l[o]):{},l=l[o]}return l[n[n.length-1]]=a,r}(e,n,a.value),l=new Set(e.dirtyFields);return l.add(n),k(k({},r),{},{isDirty:!0,dirtyFields:l});case"UPDATE_FIELDS":var i=new Set(e.dirtyFields);return Object.keys(t.payload).forEach(function(e){return i.add(e)}),k(k(k({},e),t.payload),{},{isDirty:!0,dirtyFields:i});case"UPDATE_DISPLAY_TYPE_SETTINGS":var o=t.payload,c=o.displayType,s=o.settings,g=k(k({},e.display_type_settings),{},(0,h.A)({},c,k(k({},e.display_type_settings[c]),s))),u=new Set(e.dirtyFields);return u.add("display_type_settings.".concat(c)),k(k({},e),{},{display_type_settings:g,isDirty:!0,dirtyFields:u});case"UPDATE_GALLERY_SETTINGS":var m=new Set(e.dirtyFields);return Object.keys(t.payload).forEach(function(e){return m.add("settings.".concat(e))}),k(k({},e),{},{settings:k(k({},e.settings),t.payload),isDirty:!0,dirtyFields:m});case"UPDATE_IMAGE_SETTINGS":return k(k({},e),{},{imageSettings:k(k({},e.imageSettings),t.payload)});case"MARK_CLEAN":return k(k({},e),{},{isDirty:!1,lastSaved:new Date,dirtyFields:new Set});default:return e}},S=(0,m.createContext)(null),I=function(e){var t=e.children,a=e.initialGallery,r=void 0===a?null:a,l=(0,m.useReducer)(N,null,function(){return A(r)}),i=(0,n.A)(l,2),o=i[0],c=i[1],s=(0,m.useRef)(new Map);(0,m.useEffect)(function(){r&&r.gid&&!o.lastSaved&&c({type:"INIT_FROM_GALLERY",payload:r})},[r,o.lastSaved]);var g=(0,m.useCallback)(function(e,t){c({type:"UPDATE_FIELD",payload:{path:e,value:t}})},[]),u=(0,m.useCallback)(function(e){c({type:"UPDATE_FIELDS",payload:e})},[]),p=(0,m.useCallback)(function(e,t){c({type:"UPDATE_DISPLAY_TYPE_SETTINGS",payload:{displayType:e,settings:t}})},[]),_=(0,m.useCallback)(function(e){c({type:"UPDATE_GALLERY_SETTINGS",payload:e})},[]),y=(0,m.useCallback)(function(e){c({type:"UPDATE_IMAGE_SETTINGS",payload:e})},[]),h=(0,m.useCallback)(function(e){c({type:"INIT_FROM_GALLERY",payload:e})},[]),f=(0,m.useCallback)(function(){c({type:"MARK_CLEAN"})},[]),v=(0,m.useCallback)(function(e){c({type:"RESET_TO_SAVED",payload:e})},[]),b=(0,m.useCallback)(function(){return Array.from(o.dirtyFields)},[o.dirtyFields]),E=(0,m.useCallback)(function(e){var t=e||o.display_type;return o.display_type_settings[t]||{}},[o.display_type_settings,o.display_type]),x=(0,m.useCallback)(function(){return E()},[E]),w=(0,m.useCallback)(function(e,t){s.current.set(e,t)},[]),C=(0,m.useCallback)(function(e){s.current.delete(e)},[]),k=(0,m.useCallback)(function(){s.current.forEach(function(e){try{e()}catch(e){console.error("Error flushing pending save:",e)}})},[]),I=(0,m.useMemo)(function(){return{state:o,updateField:g,updateFields:u,updateDisplayTypeSettings:p,updateGallerySettings:_,updateImageSettings:y,initFromGallery:h,markClean:f,resetToSaved:v,getDirtyFields:b,getDisplayTypeSettings:E,getCurrentDisplayTypeSettings:x,registerFlushCallback:w,unregisterFlushCallback:C,flushAllPendingSaves:k}},[o,g,u,p,_,y,h,f,v,b,E,x,w,C,k]);return d().createElement(S.Provider,{value:I},t)},T=function(){var e=(0,m.useContext)(S);if(!e)throw new Error("useGalleryForm must be used within a GalleryFormProvider. This indicates a component structure issue that should be fixed.");return e},D=a(8376),P=a(4707),O=a(9836),F=["photocrati-nextgen_basic_slideshow","photocrati-nextgen_basic_thumbnails","photocrati-nextgen_basic_imagebrowser","photocrati-nextgen_basic_tagcloud"],M=[].concat(F,["photocrati-nextgen_pro_film","photocrati-nextgen_pro_mosaic"]),j=a(5258),G=a(6629),z=a(1552),L=a(7899),R=a(5909),B=a(6415),Y=a(1548),q=function(e){var t=e.formState,a=e.handleInputChange;return d().createElement(d().Fragment,null,d().createElement(G.A,{htmlFor:"maximum_dimensions",help:(0,u.__)("Certain themes may allow images to flow over their container if this setting is too large","nggallery")},(0,u.__)("Maximum dimensions","nggallery")),d().createElement("div",{className:"flex gap-2 items-center"},d().createElement("span",null,"w"),d().createElement(R.A,{type:"number",name:"gallery_width",value:t.gallery_width,onChange:a}),d().createElement("span",null,"/"),d().createElement(R.A,{type:"number",name:"gallery_height",value:t.gallery_height,onChange:a}),d().createElement("span",null,"h")),d().createElement(B.A,{id:"autoplay",name:"autoplay",checked:t.autoplay,onChange:a,label:(0,u.__)("Autoplay","nggallery")}),d().createElement(B.A,{id:"pauseonhover",name:"pauseonhover",checked:t.pauseonhover,onChange:a,label:(0,u.__)("Pause on Hover","nggallery")}),d().createElement(B.A,{id:"arrows",name:"arrows",checked:t.arrows,onChange:a,label:(0,u.__)("Show Arrows","nggallery")}),d().createElement(L.A,{id:"transition_style",name:"transition_style",value:t.transition_style,onChange:a,label:(0,u.__)("Transition Style","nggallery")},d().createElement("option",{value:"fade"},(0,u.__)("Fade","nggallery")),d().createElement("option",{value:"slide"},(0,u.__)("Slide","nggallery"))),d().createElement(R.A,{type:"number",name:"interval",value:t.interval,onChange:a,label:(0,u.__)("Interval","nggallery")}),d().createElement(R.A,{type:"number",name:"transition_speed",value:t.transition_speed,onChange:a,label:(0,u.__)("Transition Speed","nggallery")}),d().createElement(B.A,{id:"show_thumbnail_link",name:"show_thumbnail_link",checked:t.show_thumbnail_link,onChange:a,label:(0,u.__)("Show thumbnail link","nggallery")}),(0,O._w)(t.show_thumbnail_link)&&d().createElement("div",{className:"ml-6 space-y-4"},d().createElement(R.A,{type:"text",name:"thumbnail_link_text",value:t.thumbnail_link_text,onChange:a,label:(0,u.__)("Thumbnail link text","nggallery")})),d().createElement(z.A,{prefix:"gallery",value:t.template,onChange:a}),d().createElement(Y.Y,{formState:t,handleInputChange:a,hidePagination:!0}))},K=function(e){var t=e.formState,a=e.handleInputChange;return d().createElement(B.A,{id:"ajax_pagination",name:"ajax_pagination",checked:t.ajax_pagination,onChange:a,label:(0,u.__)("Enable AJAX pagination","nggallery"),help:(0,u.__)("Browse images without reloading the page.","nggallery")})},U=function(e){var t=e.formState,a=e.handleInputChange;return d().createElement(L.A,{id:"ngg_triggers_display",name:"ngg_triggers_display",value:t.ngg_triggers_display,onChange:a,label:(0,u.__)("Display Triggers","nggallery")},d().createElement("option",{value:"never"},(0,u.__)("Never","nggallery")),d().createElement("option",{value:"always"},(0,u.__)("Always","nggallery")),d().createElement("option",{value:"exclude_mobile"},(0,u.__)("Exclude Mobile","nggallery")))},W=function(e){var t=e.formState,a=e.handleInputChange;return d().createElement(d().Fragment,null,d().createElement(B.A,{id:"override_thumbnail_settings",name:"override_thumbnail_settings",checked:t.override_thumbnail_settings,onChange:a,label:(0,u.__)("Override thumbnail settings","nggallery"),help:(0,u.__)("This does not affect existing thumbnails; overriding the thumbnail settings will create an additional set of thumbnails. To change the size of existing thumbnails please visit 'Manage Galleries' and choose 'Create new thumbnails' for all images in the gallery.","nggallery")}),(0,O._w)(t.override_thumbnail_settings)&&d().createElement("div",{className:"ml-6 space-y-4"},d().createElement(G.A,{htmlFor:"thumbnail_dimensions",help:(0,u.__)("These are maximum values","nggallery")},(0,u.__)("Thumbnail dimensions","nggallery")),d().createElement("div",{className:"flex gap-4"},d().createElement(R.A,{type:"number",name:"thumbnail_width",value:t.thumbnail_width,onChange:a}),d().createElement(R.A,{type:"number",name:"thumbnail_height",value:t.thumbnail_height,onChange:a})),d().createElement(B.A,{id:"thumbnail_crop",name:"thumbnail_crop",checked:t.thumbnail_crop,onChange:a,label:(0,u.__)("Thumbnail crop","nggallery")})),d().createElement(R.A,{type:"number",name:"images_per_page",value:t.images_per_page,onChange:a,label:(0,u.__)("Images per page","nggallery")}))},X=function(e){var t=e.formState,a=e.handleInputChange,n=(0,g.useDispatch)(c.E);return"pro"===c.W?d().createElement(B.A,{id:"ngg_proofing_display",name:"ngg_proofing_display",checked:t.ngg_proofing_display,onChange:a,label:(0,u.__)("Enable proofing","nggallery"),help:(0,u.__)("Trigger buttons or hover captions need to be enabled for proofing to work","nggallery")}):d().createElement("div",{className:"relative"},d().createElement("div",{className:"opacity-50 pointer-events-none"},d().createElement(B.A,{id:"ngg_proofing_display",name:"ngg_proofing_display",checked:!1,onChange:function(){},label:(0,u.__)("Enable proofing","nggallery"),help:(0,u.__)("Trigger buttons or hover captions need to be enabled for proofing to work","nggallery")})),d().createElement("div",{className:"absolute inset-0 cursor-pointer",onClick:function(){n.setActiveModal("upgrade",{feature:"proofing features"})},title:(0,u.__)("Requires NextGEN Gallery Pro","nggallery")}))},Q=function(e){var t=e.formState,a=e.handleInputChange;return d().createElement(d().Fragment,null,d().createElement(W,{formState:t,handleInputChange:a}),d().createElement(R.A,{type:"number",name:"number_of_columns",value:t.number_of_columns,onChange:a,label:(0,u.__)("Number of columns to display","nggallery"),help:(0,u.__)("An empty or zero in this field will use a responsive layout","nggallery")}),d().createElement(B.A,{id:"show_all_in_lightbox",name:"show_all_in_lightbox",checked:t.show_all_in_lightbox,onChange:a,label:(0,u.__)("Add hidden images","nggallery"),help:(0,u.__)("If pagination is used this option will show all images in the modal window (Thickbox, Lightbox etc.) This increases page load.","nggallery")}),d().createElement(B.A,{id:"use_imagebrowser_effect",name:"use_imagebrowser_effect",checked:t.use_imagebrowser_effect,onChange:a,label:(0,u.__)("Use imagebrowser effect","nggallery"),help:(0,u.__)("When active each image in the gallery will link to an imagebrowser display and lightbox effects will not be applied.","nggallery")}),d().createElement(B.A,{id:"show_slideshow_link",name:"show_slideshow_link",checked:t.show_slideshow_link,onChange:a,label:(0,u.__)("Show slideshow link","nggallery")}),(0,O._w)(t.show_slideshow_link)&&d().createElement("div",{className:"ml-6 space-y-4"},d().createElement(R.A,{type:"text",name:"slideshow_link_text",value:t.slideshow_link_text,onChange:a,label:(0,u.__)("Slideshow link text","nggallery")})),d().createElement("input",{type:"hidden",name:"display_view",value:"default"}),d().createElement(z.A,{prefix:"gallery",value:t.template,onChange:a}),d().createElement(X,{formState:t,handleInputChange:a}),d().createElement(Y.Y,{formState:t,handleInputChange:a}),d().createElement(U,{formState:t,handleInputChange:a}),d().createElement(K,{formState:t,handleInputChange:a}))},V=a(5316),H=function(e){var t=e.formState,a=e.handleInputChange;return d().createElement(d().Fragment,null,d().createElement(B.A,{id:"captions_enabled",name:"captions_enabled",checked:t.captions_enabled,onChange:a,label:(0,u.__)("Enable caption overlay","nggallery")}),(0,O._w)(t.captions_enabled)&&d().createElement("div",{className:"ml-6 space-y-4"},d().createElement(B.A,{id:"captions_display_sharing",name:"captions_display_sharing",checked:t.captions_display_sharing,onChange:a,label:(0,u.__)("Display share icons","nggallery")}),d().createElement(B.A,{id:"captions_display_title",name:"captions_display_title",checked:t.captions_display_title,onChange:a,label:(0,u.__)("Display image title","nggallery")}),d().createElement(B.A,{id:"captions_display_description",name:"captions_display_description",checked:t.captions_display_description,onChange:a,label:(0,u.__)("Display image description","nggallery")}),d().createElement(L.A,{id:"captions_animation",name:"captions_animation",value:t.captions_animation,onChange:a,label:(0,u.__)("Animation type","nggallery")},d().createElement("option",{value:"fade"},(0,u.__)("Fade in","nggallery")),d().createElement("option",{value:"slideup"},(0,u.__)("Slide up","nggallery")),d().createElement("option",{value:"slidedown"},(0,u.__)("Slide down","nggallery")),d().createElement("option",{value:"slideleft"},(0,u.__)("Slide left","nggallery")),d().createElement("option",{value:"titlebar"},(0,u.__)("Titlebar","nggallery")),d().createElement("option",{value:"plain"},(0,u.__)("Plain","nggallery")))))},J=function(e){var t=e.formState,a=e.handleInputChange;return d().createElement(d().Fragment,null,d().createElement(W,{formState:t,handleInputChange:a}),d().createElement(R.A,{type:"number",name:"number_of_columns",value:t.number_of_columns,onChange:a,label:(0,u.__)("Number of columns to display","nggallery"),help:(0,u.__)("An empty or zero in this field will use a responsive layout","nggallery")}),d().createElement(R.A,{type:"number",name:"border_size",value:t.border_size,onChange:a,label:(0,u.__)("Border size","nggallery")}),d().createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},(0,u.__)("Border color","nggallery")),d().createElement(V.e,{color:t.border_color,onChange:function(e){return a({target:{name:"border_color",value:e}})}}),d().createElement(R.A,{type:"number",name:"spacing",value:t.spacing,onChange:a,label:(0,u.__)("Spacing","nggallery")}),d().createElement(L.A,{id:"display_type_view",name:"display_type_view",value:t.display_type_view,onChange:a,label:(0,u.__)("Select View","nggallery")},d().createElement("option",{value:"default"},(0,u.__)("Default","nggallery")),d().createElement("option",{value:"pro-thumbnail-border-template.php"},(0,u.__)("pro-thumbnail-border-template.php","nggallery")),d().createElement("option",{value:"pro-thumbnail-caption-template.php"},(0,u.__)("pro-thumbnail-caption-template.php","nggallery")),d().createElement("option",{value:"pro-thumbnail-caption2-template.php"},(0,u.__)("pro-thumbnail-caption2-template.php","nggallery"))),d().createElement(H,{formState:t,handleInputChange:a}),d().createElement(Y.Y,{formState:t,handleInputChange:a}),d().createElement(U,{formState:t,handleInputChange:a}))},$=function(e){var t=e.formState,a=e.handleInputChange;return d().createElement(d().Fragment,null,d().createElement("input",{type:"hidden",name:"display_view",value:"default_view"}),d().createElement(z.A,{prefix:"imagebrowser",value:t.template,onChange:a}),d().createElement(Y.Y,{formState:t,handleInputChange:a}),d().createElement(K,{formState:t,handleInputChange:a}))},Z=function(e){var t=e.formState,a=e.handleInputChange,n=(0,D.a)().map(function(e){return{value:e.id,label:e.name}});return d().createElement("div",{className:"space-y-4"},d().createElement("h3",{className:"text-sm font-medium text-gray-900"},(0,u.__)("Gallery Display Settings","nggallery")),d().createElement(L.A,{id:"gallery_display_type",name:"gallery_display_type",value:t.gallery_display_type||"",onChange:a,label:(0,u.__)("Display Type","nggallery")},n.map(function(e){return d().createElement("option",{key:e.value,value:e.value},e.label)})),d().createElement(B.A,{id:"gallery_override_global_settings",name:"gallery_override_global_settings",checked:t.gallery_override_global_settings||!1,onChange:a,label:(0,u.__)("Override Global Settings","nggallery")}),t.gallery_override_global_settings&&d().createElement("div",{className:"pl-4 border-l-2 border-gray-200 space-y-4"},d().createElement("p",{className:"text-sm text-gray-600"},(0,u.__)("Custom settings for this gallery will override the global display type settings.","nggallery"))))},ee=function(e){var t=e.formState,a=e.handleInputChange;return d().createElement(d().Fragment,null,d().createElement(R.A,{type:"number",name:"number",value:t.number,onChange:a,label:(0,u.__)("Number of tags to display","nggallery"),help:(0,u.__)("Enter the maximum number of tags to display in the cloud","nggallery")}),d().createElement(Z,{formState:t,handleInputChange:a}),d().createElement(Y.Y,{formState:t,handleInputChange:a}))},te=function(e){var t=e.formState,a=e.handleInputChange;return d().createElement(d().Fragment,null,d().createElement(B.A,{id:"override_image_settings",name:"override_image_settings",checked:t.override_image_settings,onChange:a,label:(0,u.__)("Override image settings","nggallery"),help:(0,u.__)("Overriding the image settings will create an additional set of images","nggallery")}),(0,O._w)(t.override_image_settings)&&d().createElement("div",{className:"ml-6 space-y-4"},d().createElement(L.A,{id:"image_quality",name:"image_quality",value:t.image_quality,onChange:a,label:(0,u.__)("Image quality","nggallery")},Array.from({length:12},function(e,t){return 45+5*t}).map(function(e){return d().createElement("option",{key:e,value:e.toString()},e,"%")})),d().createElement(B.A,{id:"image_watermark",name:"image_watermark",checked:t.image_watermark,onChange:a,label:(0,u.__)("Image watermark","nggallery")})),d().createElement(R.A,{type:"number",name:"image_display_size",value:t.image_display_size,onChange:a,label:(0,u.__)("Image display size","nggallery"),help:(0,u.__)("Measured in pixels","nggallery")}),d().createElement(R.A,{type:"number",name:"image_max_height",value:t.image_max_height,onChange:a,label:(0,u.__)("Image maximum height","nggallery"),help:(0,u.__)("Measured in pixels. Empty or 0 will not impose a limit.","nggallery")}),d().createElement(R.A,{type:"number",name:"image_spacing",value:t.image_spacing,onChange:a,label:(0,u.__)("Image spacing","nggallery"),help:(0,u.__)("Measured in pixels","nggallery")}),d().createElement(R.A,{type:"number",name:"border_size",value:t.border_size,onChange:a,label:(0,u.__)("Border size","nggallery")}),d().createElement("div",{className:"mb-4"},d().createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},(0,u.__)("Border color","nggallery")),d().createElement(V.e,{color:t.border_color,onChange:function(e){a({target:{name:"border_color",value:e}})}})),d().createElement(L.A,{id:"display_type_view",name:"display_type_view",value:t.display_type_view,onChange:a,label:(0,u.__)("Select View","nggallery")},d().createElement("option",{value:"default"},(0,u.__)("Default","nggallery"))),d().createElement(B.A,{id:"display_captions",name:"display_captions",checked:t.display_captions,onChange:a,label:(0,u.__)("Display captions","nggallery")}),(0,O._w)(t.display_captions)&&d().createElement("div",{className:"ml-6 space-y-4"},d().createElement(L.A,{id:"caption_location",name:"caption_location",value:t.caption_location,onChange:a,label:(0,u.__)("Caption location","nggallery")},d().createElement("option",{value:"above"},(0,u.__)("Above","nggallery")),d().createElement("option",{value:"below"},(0,u.__)("Below","nggallery")))),d().createElement(H,{formState:t,handleInputChange:a}),d().createElement(X,{formState:t,handleInputChange:a}),d().createElement(Y.Y,{formState:t,handleInputChange:a,hidePagination:!0}),d().createElement(U,{formState:t,handleInputChange:a}))},ae=function(e){var t=e.formState,a=e.handleInputChange;return d().createElement(d().Fragment,null,d().createElement("input",{type:"hidden",name:"display_type_view",value:"default"}),d().createElement(z.A,{prefix:"imagebrowser",value:t.template,onChange:a}),d().createElement(Y.Y,{formState:t,handleInputChange:a}),d().createElement(K,{formState:t,handleInputChange:a}))},ne=function(e){var t=e.formState,a=e.handleInputChange;return d().createElement(d().Fragment,null,d().createElement(R.A,{type:"number",name:"height",value:t.height,onChange:a,label:(0,u.__)("Gallery Height","nggallery")}),d().createElement(H,{formState:t,handleInputChange:a}),d().createElement(Y.Y,{formState:t,handleInputChange:a,hidePagination:!0}))},re=function(e){var t=e.formState,a=e.handleInputChange,n=function(e,t){a({target:{name:t,value:e}})},r=function(e){return function(t){var n=""===t.target.value?"":String(parseInt(t.target.value,10)||0);a({target:{name:e,value:n}})}};return d().createElement(d().Fragment,null,d().createElement(W,{formState:t,handleInputChange:a}),d().createElement(R.A,{type:"number",name:"image_spacing",value:t.image_spacing,onChange:a,label:(0,u.__)("Image spacing","nggallery")}),d().createElement(R.A,{type:"number",name:"border_size",value:t.border_size,onChange:a,label:(0,u.__)("Border size","nggallery")}),d().createElement(R.A,{type:"number",name:"frame_size",value:t.frame_size,onChange:a,label:(0,u.__)("Frame size","nggallery")}),d().createElement("div",{className:"mb-4"},d().createElement(G.A,null,(0,u.__)("Border color","nggallery")),d().createElement(V.e,{color:t.border_color,onChange:function(e){return n(e,"border_color")}})),d().createElement("div",{className:"mb-4"},d().createElement(G.A,null,(0,u.__)("Frame color","nggallery")),d().createElement(V.e,{color:t.frame_color,onChange:function(e){return n(e,"frame_color")}})),d().createElement(B.A,{id:"alttext_display",name:"alttext_display",checked:t.alttext_display,onChange:a,label:(0,u.__)("Display image title","nggallery")}),(0,O._w)(t.alttext_display)&&d().createElement("div",{className:"ml-6 space-y-4"},d().createElement("div",{className:"mb-4"},d().createElement(G.A,null,(0,u.__)("Title font color","nggallery")),d().createElement(V.e,{color:t.alttext_font_color,onChange:function(e){return n(e,"alttext_font_color")}}),d().createElement("p",{className:"mt-1 text-sm text-gray-500"},(0,u.__)("An empty color setting will use your theme colors","nggallery"))),d().createElement(R.A,{type:"number",name:"alttext_font_size",value:t.alttext_font_size,onChange:r("alttext_font_size"),label:(0,u.__)("Title font size","nggallery"),help:(0,u.__)("Measured in pixels. An empty or zero setting will use your theme font size","nggallery"),placeholder:(0,u.__)("# of pixels","nggallery"),min:0,max:200})),d().createElement(B.A,{id:"description_display",name:"description_display",checked:t.description_display,onChange:a,label:(0,u.__)("Display image description","nggallery")}),(0,O._w)(t.description_display)&&d().createElement("div",{className:"ml-6 space-y-4"},d().createElement("div",{className:"mb-4"},d().createElement(G.A,{help:(0,u.__)("An empty color setting will use your theme colors","nggallery")},(0,u.__)("Description font color","nggallery")),d().createElement(V.e,{color:t.description_font_color,onChange:function(e){return n(e,"description_font_color")}})),d().createElement(R.A,{type:"number",name:"description_font_size",value:t.description_font_size,onChange:r("description_font_size"),label:(0,u.__)("Description font size","nggallery"),help:(0,u.__)("Measured in pixels. An empty or zero setting will use your theme font size","nggallery"),placeholder:(0,u.__)("# of pixels","nggallery"),min:0,max:200})),d().createElement(H,{formState:t,handleInputChange:a}),d().createElement(X,{formState:t,handleInputChange:a}),d().createElement(U,{formState:t,handleInputChange:a}))},le=function(e){var t=e.formState,a=e.handleInputChange;return d().createElement(d().Fragment,null,d().createElement(B.A,{id:"override_gallery_width",name:"override_gallery_width",checked:t.override_gallery_width,onChange:a,label:(0,u.__)("Override maximum gallery width","nggallery"),help:(0,u.__)("Gallery width is set to your theme's content width but this can be overridden to create smaller galleries. If your theme does not provide the $content_width feature the default will fallback to 2000px.","nggallery")}),(0,O._w)(t.override_gallery_width)&&d().createElement("div",{className:"ml-6 space-y-4"},d().createElement(R.A,{type:"number",name:"maximum_gallery_width",value:t.maximum_gallery_width,onChange:a,label:(0,u.__)("Maximum gallery width","nggallery"),help:(0,u.__)("Measured in pixels","nggallery")})),d().createElement(H,{formState:t,handleInputChange:a}),d().createElement(Y.Y,{formState:t,handleInputChange:a,hidePagination:!0}))},ie=function(e){var t=e.formState,a=e.handleInputChange;return d().createElement(d().Fragment,null,d().createElement(L.A,{id:"justify_last_row",name:"justify_last_row",value:t.justify_last_row,onChange:a,label:(0,u.__)("Justify last row","nggallery"),help:(0,u.__)('When aligning the last row some images may appear cropped. Select "Do not justify" to allow the last row to appear flush but "unfinished". "Hide" will omit any images that can not be justified without cropping.',"nggallery")},d().createElement("option",{value:"justify"},(0,u.__)("Justify","nggallery")),d().createElement("option",{value:"nojustify"},(0,u.__)("Do not justify","nggallery")),d().createElement("option",{value:"hide"},(0,u.__)("Hide","nggallery"))),d().createElement(B.A,{id:"enable_lazy_loading",name:"enable_lazy_loading",checked:t.enable_lazy_loading,onChange:a,label:(0,u.__)('Enable "lazy" image loading',"nggallery")}),t.enable_lazy_loading&&d().createElement("div",{className:"ml-6 space-y-4"},d().createElement(R.A,{type:"number",name:"images_to_load_on_scroll",value:t.images_to_load_on_scroll,onChange:a,label:(0,u.__)("Images to load when scrolling","nggallery")}),d().createElement(R.A,{type:"number",name:"images_to_display_at_start",value:t.images_to_display_at_start,onChange:a,label:(0,u.__)("Images to display at start","nggallery")})),d().createElement(R.A,{type:"number",name:"margins",value:t.margins,onChange:a,label:(0,u.__)("Margins","nggallery")}),d().createElement(R.A,{type:"number",name:"row_height",value:t.row_height,onChange:a,label:(0,u.__)("Row height","nggallery")}),d().createElement(H,{formState:t,handleInputChange:a}),d().createElement(X,{formState:t,handleInputChange:a}),d().createElement(Y.Y,{formState:t,handleInputChange:a}))},oe=function(e){var t=e.formState,a=e.handleInputChange;return d().createElement(d().Fragment,null,d().createElement(R.A,{type:"number",name:"maximum_image_width",value:t.maximum_image_width,onChange:a,label:(0,u.__)("Maximum image width","nggallery"),help:(0,u.__)("Measured in pixels","nggallery")}),d().createElement(R.A,{type:"number",name:"image_padding",value:t.image_padding,onChange:a,label:(0,u.__)("Image padding","nggallery"),help:(0,u.__)("Measured in pixels","nggallery")}),d().createElement(B.A,{id:"center_gallery",name:"center_gallery",checked:t.center_gallery,onChange:a,label:(0,u.__)("Center the gallery","nggallery")}),d().createElement(H,{formState:t,handleInputChange:a}),d().createElement(Y.Y,{formState:t,handleInputChange:a,hidePagination:!0}),d().createElement(U,{formState:t,handleInputChange:a}))},ce=function(e){var t=e.formState,a=e.handleInputChange;return d().createElement(d().Fragment,null,d().createElement(B.A,{id:"enable_tag_filter",name:"enable_tag_filter",checked:t.enable_tag_filter,onChange:a,label:(0,u.__)("Enable filtering results by tag","nggallery")}),d().createElement(B.A,{id:"search_alttext",name:"search_alttext",checked:t.search_alttext,onChange:a,label:(0,u.__)("Search image alttext","nggallery")}),d().createElement(B.A,{id:"search_description",name:"search_description",checked:t.search_description,onChange:a,label:(0,u.__)("Search image description","nggallery")}),d().createElement(B.A,{id:"search_tags",name:"search_tags",checked:t.search_tags,onChange:a,label:(0,u.__)("Search image tags","nggallery")}),d().createElement(L.A,{id:"search_mode",name:"search_mode",value:t.search_mode,onChange:a,label:(0,u.__)("Database search mode","nggallery"),help:(0,u.__)("A natural language search treats the requested string as a phrase in text without any operators except for quotation marks. A boolean search uses special rules and operators such as the plus and minus symbols.","nggallery")},d().createElement("option",{value:"natural"},(0,u.__)("Natural language","nggallery")),d().createElement("option",{value:"boolean"},(0,u.__)("Boolean","nggallery"))),d().createElement(R.A,{type:"number",name:"minimum_relevance",value:t.minimum_relevance,onChange:a,label:(0,u.__)("Minimum relevance","nggallery"),help:(0,u.__)("The database server assigns a relevance score to each possible image based on a number of factors with zero being not at all relevant. Users with smaller databases or images whose alttext or description only holds a few words will need a lower number here; possibly as low as 0.05. It is unlikely many users will need to raise this beyond one.","nggallery")}),d().createElement(R.A,{type:"number",name:"limit",value:t.limit,onChange:a,label:(0,u.__)("Limit search results","nggallery"),help:(0,u.__)("Limit search results to this amount. A setting of zero means no limitations are applied","nggallery")}),d().createElement(B.A,{id:"order_by_relevance",name:"order_by_relevance",checked:t.order_by_relevance,onChange:a,label:(0,u.__)("Order by relevance first","nggallery"),help:(0,u.__)("When enabled search results will be ordered by their relevance first, then by the secondary order setting","nggallery")}),d().createElement(L.A,{id:"order_by",name:"order_by",value:t.order_by,onChange:a,label:(0,u.__)("Order search results by","nggallery")},d().createElement("option",{value:"pid"},(0,u.__)("Image ID","nggallery")),d().createElement("option",{value:"galleryid"},(0,u.__)("Gallery ID","nggallery")),d().createElement("option",{value:"filename"},(0,u.__)("Image filename","nggallery"))),d().createElement(L.A,{id:"order_direction",name:"order_direction",value:t.order_direction,onChange:a,label:(0,u.__)("Order direction of search results","nggallery")},d().createElement("option",{value:"ASC"},(0,u.__)("Ascending","nggallery")),d().createElement("option",{value:"DESC"},(0,u.__)("Descending","nggallery"))),d().createElement(L.A,{id:"gallery_display_type",name:"gallery_display_type",value:t.gallery_display_type,onChange:a,label:(0,u.__)("Gallery display type","nggallery"),help:(0,u.__)("The display type used to render search results","nggallery")},d().createElement("option",{value:"photocrati-nextgen_basic_thumbnails"},(0,u.__)("Basic Thumbnails","nggallery")),d().createElement("option",{value:"photocrati-nextgen_basic_slideshow"},(0,u.__)("Basic Slideshow","nggallery")),d().createElement("option",{value:"photocrati-nextgen_basic_imagebrowser"},(0,u.__)("Basic ImageBrowser","nggallery")),d().createElement("option",{value:"photocrati-nextgen_pro_thumbnail_grid"},(0,u.__)("Pro Thumbnail Grid","nggallery")),d().createElement("option",{value:"photocrati-nextgen_pro_blog_gallery"},(0,u.__)("Pro Blog Gallery","nggallery")),d().createElement("option",{value:"photocrati-nextgen_pro_imagebrowser"},(0,u.__)("Pro ImageBrowser","nggallery")),d().createElement("option",{value:"photocrati-nextgen_pro_slideshow"},(0,u.__)("Pro Slideshow","nggallery"))))},se=function(e){var t=e.formState,a=e.handleInputChange;return d().createElement(d().Fragment,null,d().createElement(B.A,{id:"crop_images",name:"crop_images",checked:t.crop_images,onChange:a,label:(0,u.__)("Crop images","nggallery")}),d().createElement("div",{className:"ml-6 space-y-4"},t.crop_images&&d().createElement(B.A,{id:"pan_images",name:"pan_images",checked:t.pan_images,onChange:a,label:(0,u.__)("Pan images","nggallery")}),!t.crop_images&&d().createElement(d().Fragment,null,d().createElement(R.A,{type:"number",name:"border_size",value:t.border_size,onChange:a,label:(0,u.__)("Border size","nggallery"),help:(0,u.__)('Borders will not be applied if "Crop Images" is enabled',"nggallery")}),d().createElement(G.A,null,(0,u.__)("Border color","nggallery")),d().createElement(V.e,{color:t.border_color,onChange:function(e){a({target:{name:"border_color",value:e}})}}))),d().createElement(B.A,{id:"show_play_controls",name:"show_play_controls",checked:t.show_play_controls,onChange:a,label:(0,u.__)("Show play controls","nggallery")}),d().createElement(B.A,{id:"show_captions",name:"show_captions",checked:t.show_captions,onChange:a,label:(0,u.__)("Show captions","nggallery")}),(0,O._w)(t.show_captions)&&d().createElement("div",{className:"ml-4 space-y-4"},d().createElement(L.A,{id:"caption_class",name:"caption_class",value:t.caption_class,onChange:a,label:(0,u.__)("Caption location","nggallery")},d().createElement("option",{value:"caption_above_stage"},(0,u.__)("Top","nggallery")),d().createElement("option",{value:"caption_below_stage"},(0,u.__)("Bottom","nggallery")),d().createElement("option",{value:"caption_overlay_top"},(0,u.__)("Top (Overlay)","nggallery")),d().createElement("option",{value:"caption_overlay_bottom"},(0,u.__)("Bottom (Overlay)","nggallery"))),d().createElement(R.A,{type:"number",name:"caption_height",value:t.caption_height,onChange:a,label:(0,u.__)("Caption height","nggallery"),help:(0,u.__)("Measured in pixels","nggallery")})),d().createElement(L.A,{id:"stage_aspect_ratio",name:"stage_aspect_ratio",value:t.stage_aspect_ratio,onChange:a,label:(0,u.__)("Stage aspect ratio","nggallery")},d().createElement("option",{value:"first_image"},(0,u.__)("First Image","nggallery")),d().createElement("option",{value:"image_average"},(0,u.__)("Average","nggallery")),d().createElement("option",{value:"1.5"},(0,u.__)("3:2 [1.5]","nggallery")),d().createElement("option",{value:"1.333"},(0,u.__)("4:3 [1.333]","nggallery")),d().createElement("option",{value:"1.777"},(0,u.__)("16:9 [1.777]","nggallery")),d().createElement("option",{value:"1.6"},(0,u.__)("16:10 [1.6]","nggallery")),d().createElement("option",{value:"1.85"},(0,u.__)("1.85:1 [1.85]","nggallery")),d().createElement("option",{value:"2.39"},(0,u.__)("2.39:1 [2.39]","nggallery")),d().createElement("option",{value:"1.81"},(0,u.__)("1.81:1 [1.81]","nggallery")),d().createElement("option",{value:"1"},(0,u.__)("1:1 (Square) [1]","nggallery"))),d().createElement(G.A,null,(0,u.__)("Gallery width","nggallery")),d().createElement("div",{className:"flex items-end gap-2"},d().createElement(R.A,{type:"number",name:"gallery_width",value:t.gallery_width,onChange:a}),d().createElement(L.A,{id:"gallery_width_unit",name:"gallery_width_unit",value:t.gallery_width_unit,onChange:a},d().createElement("option",{value:"percent"},(0,u.__)("Percent","nggallery")),d().createElement("option",{value:"pixels"},(0,u.__)("Pixels","nggallery")))),d().createElement(L.A,{id:"transition_effect",name:"transition_effect",value:t.transition_effect,onChange:a,label:(0,u.__)("Transition effect","nggallery")},d().createElement("option",{value:"fade"},(0,u.__)("Crossfade between images","nggallery")),d().createElement("option",{value:"flash"},(0,u.__)("Fades into background color between images","nggallery")),d().createElement("option",{value:"pulse"},(0,u.__)("Quickly move the image into the background color, then fade into the next image","nggallery")),d().createElement("option",{value:"slide"},(0,u.__)("Slide images depending on image position","nggallery")),d().createElement("option",{value:"fadeslide"},(0,u.__)("Fade between images and slide slightly at the same time","nggallery"))),d().createElement(R.A,{type:"number",name:"transition_speed",value:t.transition_speed,onChange:a,label:(0,u.__)("Transition speed","nggallery"),help:(0,u.__)("Measured in seconds","nggallery")}),d().createElement(R.A,{type:"number",name:"slideshow_speed",value:t.slideshow_speed,onChange:a,label:(0,u.__)("Slideshow speed","nggallery"),help:(0,u.__)("Measured in seconds","nggallery")}),d().createElement(B.A,{id:"override_thumbnail_settings",name:"override_thumbnail_settings",checked:t.override_thumbnail_settings,onChange:a,label:(0,u.__)("Override thumbnail settings","nggallery"),help:(0,u.__)("This does not affect existing thumbnails; overriding the thumbnail settings will create an additional set of thumbnails. To change the size of existing thumbnails please visit 'Manage Galleries' and choose 'Create new thumbnails' for all images in the gallery.","nggallery")}),t.override_thumbnail_settings&&d().createElement("div",{className:"ml-6 space-y-4"},d().createElement(L.A,{id:"thumbnail_dimensions",name:"thumbnail_dimensions",value:t.thumbnail_dimensions,onChange:a,label:(0,u.__)("Thumbnail dimensions","nggallery"),help:(0,u.__)("These are maximum values","nggallery")},d().createElement("option",{value:"240x160"},"240x160"),d().createElement("option",{value:"custom"},(0,u.__)("Custom","nggallery"))),"custom"===t.thumbnail_dimensions&&d().createElement("div",{className:"flex gap-4"},d().createElement(R.A,{type:"number",name:"thumbnail_width",value:t.thumbnail_width,onChange:a}),d().createElement(R.A,{type:"number",name:"thumbnail_height",value:t.thumbnail_height,onChange:a}))),d().createElement(U,{formState:t,handleInputChange:a}))},ge=function(e){var t=e.formState,a=e.handleInputChange;return d().createElement(d().Fragment,null,d().createElement(B.A,{id:"crop_images",name:"crop_images",checked:t.crop_images,onChange:a,label:(0,u.__)("Crop images","nggallery")}),d().createElement("div",{className:"ml-6 space-y-4"},t.crop_images&&d().createElement(B.A,{id:"pan_images",name:"pan_images",checked:t.pan_images,onChange:a,label:(0,u.__)("Pan images","nggallery")}),!t.crop_images&&d().createElement(d().Fragment,null,d().createElement(R.A,{type:"number",name:"border_size",value:t.border_size,onChange:a,label:(0,u.__)("Border size","nggallery"),help:(0,u.__)('Borders will not be applied if "Crop Images" is enabled',"nggallery")}),d().createElement(G.A,null,(0,u.__)("Border color","nggallery")),d().createElement(V.e,{color:t.border_color,onChange:function(e){a({target:{name:"border_color",value:e}})}}))),d().createElement(B.A,{id:"show_play_controls",name:"show_play_controls",checked:t.show_play_controls,onChange:a,label:(0,u.__)("Show play controls","nggallery")}),d().createElement(B.A,{id:"show_captions",name:"show_captions",checked:t.show_captions,onChange:a,label:(0,u.__)("Show captions","nggallery")}),(0,O._w)(t.show_captions)&&d().createElement("div",{className:"ml-4 space-y-4"},d().createElement(L.A,{id:"caption_class",name:"caption_class",value:t.caption_class,onChange:a,label:(0,u.__)("Caption location","nggallery")},d().createElement("option",{value:"caption_above_stage"},(0,u.__)("Top","nggallery")),d().createElement("option",{value:"caption_below_stage"},(0,u.__)("Bottom","nggallery")),d().createElement("option",{value:"caption_overlay_top"},(0,u.__)("Top (Overlay)","nggallery")),d().createElement("option",{value:"caption_overlay_bottom"},(0,u.__)("Bottom (Overlay)","nggallery"))),d().createElement(R.A,{type:"number",name:"caption_height",value:t.caption_height,onChange:a,label:(0,u.__)("Caption height","nggallery"),help:(0,u.__)("Measured in pixels","nggallery")})),d().createElement(L.A,{id:"stage_aspect_ratio",name:"stage_aspect_ratio",value:t.stage_aspect_ratio,onChange:a,label:(0,u.__)("Stage aspect ratio","nggallery")},d().createElement("option",{value:"first_image"},(0,u.__)("First Image","nggallery")),d().createElement("option",{value:"image_average"},(0,u.__)("Average","nggallery")),d().createElement("option",{value:"1.5"},(0,u.__)("3:2 [1.5]","nggallery")),d().createElement("option",{value:"1.333"},(0,u.__)("4:3 [1.333]","nggallery")),d().createElement("option",{value:"1.777"},(0,u.__)("16:9 [1.777]","nggallery")),d().createElement("option",{value:"1.6"},(0,u.__)("16:10 [1.6]","nggallery")),d().createElement("option",{value:"1.85"},(0,u.__)("1.85:1 [1.85]","nggallery")),d().createElement("option",{value:"2.39"},(0,u.__)("2.39:1 [2.39]","nggallery")),d().createElement("option",{value:"1.81"},(0,u.__)("1.81:1 [1.81]","nggallery")),d().createElement("option",{value:"1"},(0,u.__)("1:1 (Square) [1]","nggallery"))),d().createElement(G.A,null,(0,u.__)("Gallery width","nggallery")),d().createElement("div",{className:"flex items-end gap-2"},d().createElement(R.A,{type:"number",name:"gallery_width",value:t.gallery_width,onChange:a}),d().createElement(L.A,{id:"gallery_width_unit",name:"gallery_width_unit",value:t.gallery_width_unit,onChange:a},d().createElement("option",{value:"percent"},(0,u.__)("Percent","nggallery")),d().createElement("option",{value:"pixels"},(0,u.__)("Pixels","nggallery")))),d().createElement(L.A,{id:"transition_effect",name:"transition_effect",value:t.transition_effect,onChange:a,label:(0,u.__)("Transition effect","nggallery")},d().createElement("option",{value:"fade"},(0,u.__)("Crossfade between images","nggallery")),d().createElement("option",{value:"flash"},(0,u.__)("Fades into background color between images","nggallery")),d().createElement("option",{value:"pulse"},(0,u.__)("Quickly move the image into the background color, then fade into the next image","nggallery")),d().createElement("option",{value:"slide"},(0,u.__)("Slide images depending on image position","nggallery")),d().createElement("option",{value:"fadeslide"},(0,u.__)("Fade between images and slide slightly at the same time","nggallery"))),d().createElement(R.A,{type:"number",name:"transition_speed",value:t.transition_speed,onChange:a,label:(0,u.__)("Transition speed","nggallery"),help:(0,u.__)("Measured in seconds","nggallery")}),d().createElement(R.A,{type:"number",name:"slideshow_speed",value:t.slideshow_speed,onChange:a,label:(0,u.__)("Slideshow speed","nggallery"),help:(0,u.__)("Measured in seconds","nggallery")}),d().createElement(B.A,{id:"override_thumbnail_settings",name:"override_thumbnail_settings",checked:t.override_thumbnail_settings,onChange:a,label:(0,u.__)("Override thumbnail settings","nggallery"),help:(0,u.__)("This does not affect existing thumbnails; overriding the thumbnail settings will create an additional set of thumbnails. To change the size of existing thumbnails please visit 'Manage Galleries' and choose 'Create new thumbnails' for all images in the gallery.","nggallery")}),t.override_thumbnail_settings&&d().createElement("div",{className:"ml-6 space-y-4"},d().createElement(L.A,{id:"thumbnail_dimensions",name:"thumbnail_dimensions",value:t.thumbnail_dimensions,onChange:a,label:(0,u.__)("Thumbnail dimensions","nggallery"),help:(0,u.__)("These are maximum values","nggallery")},d().createElement("option",{value:"240x160"},"240x160"),d().createElement("option",{value:"custom"},(0,u.__)("Custom","nggallery"))),"custom"===t.thumbnail_dimensions&&d().createElement("div",{className:"flex gap-4"},d().createElement(R.A,{type:"number",name:"thumbnail_width",value:t.thumbnail_width,onChange:a}),d().createElement(R.A,{type:"number",name:"thumbnail_height",value:t.thumbnail_height,onChange:a}))),d().createElement(U,{formState:t,handleInputChange:a}))};function ue(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function me(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ue(Object(a),!0).forEach(function(t){(0,h.A)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ue(Object(a)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}const de=function(e){var t,a=e.gallery,r=e.previewMode,l=e.onPreviewModeChange,i=(0,g.useSelect)(function(e){return e(c.E).getCurrentId()},[]),o=(0,E.iX)(i).data,s=(null===(t=window.imagelyApp)||void 0===t?void 0:t.proTypeInstalled)||"lite",p=(0,m.useMemo)(function(){return function(e){switch(e){case"lite":default:return F;case"starter":return M;case"pro":case"plus":return(0,D.a)().map(function(e){return e.id})}}(s)},[s]),_=(0,m.useState)(null),f=(0,n.A)(_,2),C=f[0],k=f[1],A=(0,w.b)({type:"gallery",item:o,includeEcommerce:!1}),N=(null==a?void 0:a.display_type)||"photocrati-nextgen_basic_thumbnails",S=T(),I=S.getCurrentDisplayTypeSettings,G=S.updateDisplayTypeSettings,z=S.updateField,L=S.registerFlushCallback,R=S.unregisterFlushCallback,B=(0,E.hW)(),Y=(0,x.E)(),K=Y.showSuccess,U=Y.showError,W=(0,m.useRef)(null),X=(0,m.useRef)(null),V=(0,m.useCallback)(function(){W.current&&(clearTimeout(W.current),W.current=null),X.current&&(X.current(),X.current=null)},[]);(0,m.useEffect)(function(){return L("customizeTab",V),V(),function(){V(),R("customizeTab")}},[N,V,L,R]),(0,m.useEffect)(function(){if(N&&a){var e=(null==a?void 0:a.display_type_settings)||{},t=(0,O.bT)(e[N]||{}),n=me(me({},(l={},["photocrati-nextgen_basic_imagebrowser","photocrati-nextgen_basic_singlepic","photocrati-nextgen_basic_thumbnails","photocrati-nextgen_basic_slideshow","photocrati-nextgen_basic_compact_album","photocrati-nextgen_basic_extended_album","photocrati-nextgen_pro_thumbnail_grid","photocrati-nextgen_pro_blog_gallery","photocrati-nextgen_pro_imagebrowser","photocrati-nextgen_pro_sidescroll","photocrati-nextgen_pro_film","photocrati-nextgen_pro_tile","photocrati-nextgen_pro_mosaic","photocrati-nextgen_pro_masonry","photocrati-nextgen_pro_grid_album","photocrati-nextgen_pro_list_album"].includes(r=N)&&(l.animate_images_duration="1500",l.animate_images_delay="250",l.animate_pagination_duration="1500",l.animate_pagination_delay="250"),"imagely-pro-search"===r&&(l.search_alttext=!0,l.search_description=!0,l.search_tags=!0,l.enable_tag_filter=!0,l.search_mode="natural",l.limit="0",l.order_by="pid",l.order_direction="ASC",l.order_by_relevance=!0,l.minimum_relevance="1",l.gallery_display_type="photocrati-nextgen_basic_thumbnails",l.use_lightbox_effect=!0),["photocrati-nextgen_pro_thumbnail_grid","photocrati-nextgen_pro_blog_gallery","photocrati-nextgen_pro_imagebrowser"].includes(r)&&(l.display_type_view="default"),"photocrati-nextgen_pro_mosaic"===r&&(l.images_to_load_on_scroll="15",l.images_to_display_at_start="15"),"photocrati-nextgen_pro_slideshow"===r&&(l.stage_aspect_ratio="1.5",l.gallery_width="100",l.gallery_width_unit="percent"),l)),t);G(N,n)}var r,l},[N,null==a?void 0:a.display_type_settings,a,G]);var H=function(){var e=(0,y.A)(v().mark(function e(t){return v().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a){e.next=2;break}return e.abrupt("return");case 2:if(k(t),p.includes(t)){e.next=5;break}return e.abrupt("return");case 5:return z("display_type",t),e.prev=6,e.next=9,B.mutateAsync({id:a.gid,data:{display_type:t}});case 9:K((0,u.__)("Layout changed successfully!","nggallery")),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(6),U((0,u.__)("Failed to change layout. Please try again.","nggallery")),console.error("Error changing layout:",e.t0);case 16:case"end":return e.stop()}},e,null,[[6,12]])}));return function(t){return e.apply(this,arguments)}}(),Z=(0,m.useCallback)(function(){var e=(0,y.A)(v().mark(function e(t,a,n){return v().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,B.mutateAsync({id:t,data:{display_type:a,display_type_settings:n}});case 3:e.next=9;break;case 5:e.prev=5,e.t0=e.catch(0),U((0,u.__)("Failed to update display settings. Changes have been reverted.","nggallery")),console.error("Error updating display settings:",e.t0);case 9:case"end":return e.stop()}},e,null,[[0,5]])}));return function(t,a,n){return e.apply(this,arguments)}}(),[B,U]),ue=(0,m.useCallback)(function(e){var t=e.target,n=t.name,r=t.value,l=t.type,i="checkbox"===l?e.target.checked:r;if(N&&(G(N,(0,h.A)({},n,i)),a)){W.current&&clearTimeout(W.current);var o=N,c=a.gid,s=a.display_type_settings,g="checkbox"===l?(0,O.xZ)(i):i,u=function(){var e=me(me({},s),{},(0,h.A)({},o,me(me({},(null==s?void 0:s[o])||{}),{},(0,h.A)({},n,g))));Z(c,o,e)};X.current=u,W.current=window.setTimeout(function(){u(),X.current=null},1e3)}},[N,a,G,Z]),de=I(),pe=C&&!p.includes(C);return d().createElement("div",{className:"bg-white rounded-lg shadow lg:grid lg:grid-cols-2 lg:items-start"},d().createElement("div",{className:"px-6 py-6 lg:px-8 lg:py-8 border-b lg:border-b-0 lg:border-r"},d().createElement("div",{className:"space-y-4"},d().createElement("h1",{className:"text-lg font-medium"},(0,u.__)("Customize","nggallery")),d().createElement(b.A,{title:(0,u.__)("Choose Layout","nggallery"),defaultExpanded:!0,className:"mb-4"},d().createElement("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-5 gap-2 sm:gap-4"},(0,D.a)().map(function(e){var t=p.includes(e.id),a=(C||N)===e.id;return d().createElement("div",{key:e.id,className:"flex flex-col items-center text-center"},d().createElement("div",{className:"relative p-1 border rounded-md cursor-pointer transition-all duration-200 w-full ".concat(a?"border-green-500":t?"border-gray-600 hover:border-green-500":"border-gray-200 hover:border-green-500"),onClick:function(){return H(e.id)}},d().createElement("div",{className:"flex items-center justify-center ".concat(a?"text-gray-600":"text-gray-200 hover:text-gray-600")},d().createElement("div",{className:"w-12 h-8 sm:w-16 sm:h-12 flex items-center justify-center"},e.icon))),d().createElement("h3",{className:"text-xs sm:text-xs font-medium mt-1 sm:mt-2 ".concat(t?"text-gray-300":"text-gray-400")},e.name))}))),de&&d().createElement("div",{className:pe?"opacity-50 pointer-events-none":""},d().createElement(b.A,{title:(0,u.__)("Customize Gallery Look","nggallery"),defaultExpanded:!0,className:"mb-4"},d().createElement("div",{className:"space-y-4"},"photocrati-nextgen_basic_slideshow"===N&&d().createElement(q,{formState:de,handleInputChange:ue}),"photocrati-nextgen_basic_thumbnails"===N&&d().createElement(Q,{formState:de,handleInputChange:ue}),"photocrati-nextgen_pro_thumbnail_grid"===N&&d().createElement(J,{formState:de,handleInputChange:ue}),"photocrati-nextgen_basic_imagebrowser"===N&&d().createElement($,{formState:de,handleInputChange:ue}),"photocrati-nextgen_basic_tagcloud"===N&&d().createElement(ee,{formState:de,handleInputChange:ue}),"photocrati-nextgen_pro_blog_gallery"===N&&d().createElement(te,{formState:de,handleInputChange:ue}),"photocrati-nextgen_pro_imagebrowser"===N&&d().createElement(ae,{formState:de,handleInputChange:ue}),"photocrati-nextgen_pro_sidescroll"===N&&d().createElement(ne,{formState:de,handleInputChange:ue}),"photocrati-nextgen_pro_film"===N&&d().createElement(re,{formState:de,handleInputChange:ue}),"photocrati-nextgen_pro_tile"===N&&d().createElement(le,{formState:de,handleInputChange:ue}),"photocrati-nextgen_pro_mosaic"===N&&d().createElement(ie,{formState:de,handleInputChange:ue}),"photocrati-nextgen_pro_masonry"===N&&d().createElement(oe,{formState:de,handleInputChange:ue}),"imagely-pro-search"===N&&d().createElement(ce,{formState:de,handleInputChange:ue}),"photocrati-nextgen_pro_horizontal_filmstrip"===N&&d().createElement(se,{formState:de,handleInputChange:ue}),"photocrati-nextgen_pro_slideshow"===N&&d().createElement(ge,{formState:de,handleInputChange:ue})))))),d().createElement("div",{className:"px-6 py-6 lg:px-8 lg:py-8 lg:sticky lg:top-8 lg:max-h-screen"},pe?d().createElement(j.A,null):d().createElement(P.A,{previewMode:r,onPreviewModeChange:l,url:A,title:(0,u.__)("Gallery Preview","nggallery")})))};var pe=a(5458),_e=a(3375),ye=a(3627),he=a(4848),fe=a(2935),ve=a(3717),be=a(7374),Ee=a(443),xe=a(4540),we=function(){var e=Ce();return null!==e&&e.enabled&&e.license_valid},Ce=function(){var e=window.imagelyApp;return(null==e?void 0:e.enviraCdnConfig)||null},ke=function(e){var t;return!(null===(t=e.meta_data)||void 0===t||!t._envira_cdn_id)},Ae=function(){var e=window.wpApiSettings;if(null!=e&&e.nonce)return e.nonce;var t=window.imagelyApp;return(null==t?void 0:t.nonce)||null},Ne=function(){var e=window.imagelyApp;return(null==e?void 0:e.restURL)||"/wp-json/"},Se=a(5300),Ie=a(7665),Te=a(1455),De=a.n(Te),Pe=a(4979),Oe=a(7196);const Fe=function(e){var t=e.isOpen,a=e.onClose,n=e.image;if(!n)return null;var r=n.meta_data||{},l=function(e){return null==e||""===e?"N/A":"boolean"==typeof e?e?"Yes":"No":String(e)},i=[{tag:"Image ID",value:n.pid},{tag:"Image Width",value:r.width},{tag:"Image Height",value:r.height},{tag:"md5",value:r.md5}],o=[{tag:"Orientation",value:r.Orientation},{tag:"Camera",value:r.camera},{tag:"Aperture",value:r.aperture},{tag:"Focal Length",value:r.focal_length},{tag:"ISO",value:r.iso},{tag:"Shutter Speed",value:r.shutter_speed},{tag:"Flash",value:r.flash},{tag:"Created",value:r.created_timestamp?new Date(1e3*r.created_timestamp).toLocaleString():null}].filter(function(e){return null!==e.value&&void 0!==e.value&&""!==e.value&&!1!==e.value});return d().createElement(Oe.A,{isOpen:t,onClose:a,title:(0,u.__)("Show meta data","nggallery")},d().createElement("div",{className:"space-y-6"},d().createElement("div",null,d().createElement("h3",{className:"text-lg font-semibold text-gray-900 mb-4"},(0,u.__)("Meta Data","nggallery")),d().createElement("div",{className:"bg-gray-50 rounded-lg overflow-hidden"},d().createElement("table",{className:"min-w-full"},d().createElement("thead",{className:"bg-gray-100"},d().createElement("tr",null,d().createElement("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 w-1/3"},(0,u.__)("Tag","nggallery")),d().createElement("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700"},(0,u.__)("Value","nggallery")))),d().createElement("tbody",{className:"divide-y divide-gray-200 bg-white"},i.map(function(e,t){return d().createElement("tr",{key:t,className:"bg-white"},d().createElement("td",{className:"px-4 py-3 text-sm text-gray-900 font-medium"},e.tag),d().createElement("td",{className:"px-4 py-3 text-sm text-gray-700"},l(e.value)))}))))),o.length>0&&d().createElement("div",null,d().createElement("h3",{className:"text-lg font-semibold text-gray-900 mb-4"},(0,u.__)("EXIF Data","nggallery")),d().createElement("div",{className:"bg-gray-50 rounded-lg overflow-hidden"},d().createElement("table",{className:"min-w-full"},d().createElement("thead",{className:"bg-gray-100"},d().createElement("tr",null,d().createElement("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 w-1/3"},(0,u.__)("Tag","nggallery")),d().createElement("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700"},(0,u.__)("Value","nggallery")))),d().createElement("tbody",{className:"divide-y divide-gray-200 bg-white"},o.map(function(e,t){return d().createElement("tr",{key:t,className:"bg-white"},d().createElement("td",{className:"px-4 py-3 text-sm text-gray-900 font-medium"},e.tag),d().createElement("td",{className:"px-4 py-3 text-sm text-gray-700"},l(e.value)))}))))),0===o.length&&d().createElement("div",null,d().createElement("h3",{className:"text-lg font-semibold text-gray-900 mb-4"},(0,u.__)("EXIF Data","nggallery")),d().createElement("div",{className:"bg-gray-50 rounded-lg p-4"},d().createElement("p",{className:"text-sm text-gray-600 text-center"},(0,u.__)("No EXIF data available for this image.","nggallery"))))))};function Me(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function je(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Me(Object(a),!0).forEach(function(t){(0,h.A)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Me(Object(a)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}var Ge=function(){return d().createElement("div",{className:"absolute inset-0 bg-white bg-opacity-60 flex items-center justify-center z-20"},d().createElement(i.Nl,{className:"animate-spin h-8 w-8 -mt-[48px] text-green-500"}))},ze=(0,m.memo)(function(e){var t,a=e.image,r=e.gallery,l=e.isSelected,o=e.onSelect,s=e.onDelete,p=e.onRecover,h=e.onGenerateThumbnail,f=e.isProcessing,b=e.onToggleVisibility,w=(0,m.useState)(!1),C=(0,n.A)(w,2),k=C[0],A=C[1],N=(0,m.useState)(!1),S=(0,n.A)(N,2),I=S[0],T=S[1],D=(0,m.useState)(!1),P=(0,n.A)(D,2),O=P[0],F=P[1],M=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:768,t=(0,m.useState)(!1),a=(0,n.A)(t,2),r=a[0],l=a[1];return(0,m.useEffect)(function(){var t=function(){l(window.innerWidth<e)};return t(),window.addEventListener("resize",t),function(){return window.removeEventListener("resize",t)}},[e]),r}(),j=(0,g.useDispatch)(c.E),G=(0,Ie.jE)(),z=(0,E.iX)((null==r?void 0:r.gid)||null).data,L=(0,E.Fv)(),R=(0,x.E)(),B=R.showSuccess,Y=R.showError,q=(0,m.useCallback)(function(){var e=function(e){var t,a=null===(t=e.meta_data)||void 0===t?void 0:t._envira_cdn_id;return a?"https://images.envira-cdn.com/cdn-cgi/imagedelivery/Fcmm2_rOlMVEVM7KyY_2rw/".concat(a,"/w=original"):null}(a);e&&window.open(e,"_blank"),A(!1)},[a]),K=(0,m.useCallback)((0,y.A)(v().mark(function e(){var t,n,l,i,o,c;return v().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==(t=a.meta_data)&&void 0!==t&&t._envira_cdn_id){e.next=2;break}return e.abrupt("return");case 2:if(n=Ae(),l=Ne(),n){e.next=8;break}return Y((0,u.__)("Authentication error","nggallery")),A(!1),e.abrupt("return");case 8:return A(!1),e.prev=9,e.next=12,fetch("".concat(l,"envira-cdn/v1/ngg-remove-image/").concat(a.pid),{method:"DELETE",headers:{"X-WP-Nonce":n}});case 12:if((i=e.sent).ok){e.next=20;break}return e.next=16,i.json().catch(function(){return{}});case 16:return o=e.sent,console.error("CDN removal error:",o),Y((0,u.__)("Failed to remove image from CDN","nggallery")),e.abrupt("return");case 20:return e.next=22,i.json();case 22:if(!(c=e.sent).success){e.next=30;break}if(B((0,u.__)("Image removed from CDN successfully","nggallery")),null==r||!r.gid){e.next=28;break}return e.next=28,G.invalidateQueries({queryKey:["gallery",r.gid,"images"]});case 28:e.next=31;break;case 30:Y(c.message||(0,u.__)("Failed to remove image from CDN","nggallery"));case 31:e.next=37;break;case 33:e.prev=33,e.t0=e.catch(9),console.error("CDN removal error:",e.t0),Y((0,u.__)("Error removing image from CDN","nggallery"));case 37:case"end":return e.stop()}},e,null,[[9,33]])})),[a,null==r?void 0:r.gid,G,B,Y]),U=(null==a?void 0:a.pid)||0,W=(0,ye.gl)({id:U,transition:{duration:150,easing:"cubic-bezier(0.25, 1, 0.5, 1)"}}),X=W.attributes,Q=W.listeners,V=W.setNodeRef,H=W.transform,J=W.transition,$=W.isDragging;if(!a||null==a||!a.pid||"number"!=typeof a.pid)return null;if(null==a||!a.filename||null==r||!r.path)return null;var Z={transform:Pe.Ks.Transform.toString(H),transition:J,opacity:$?.5:1,touchAction:"none",willChange:"transform, opacity",pointerEvents:f?"none":void 0},ee=function(){var e=(0,y.A)(v().mark(function e(){return v().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p(a.pid);case 2:A(!1);case 3:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),te=M||I||l,ae=function(){var e=(0,y.A)(v().mark(function e(){return v().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,L.mutateAsync({galleryId:r.gid,imageId:a.pid});case 3:B((0,u.__)("Gallery thumbnail updated successfully","nggallery")),e.next=10;break;case 6:e.prev=6,e.t0=e.catch(0),console.error("Error setting gallery thumbnail:",e.t0),Y((0,u.__)("Failed to update gallery thumbnail","nggallery"));case 10:A(!1);case 11:case"end":return e.stop()}},e,null,[[0,6]])}));return function(){return e.apply(this,arguments)}}(),ne=(null===(t=z||r)||void 0===t?void 0:t.previewpic)===a.pid;return d().createElement("div",{className:"relative w-full sm:w-full md:w-[130px] ".concat(f?"opacity-50":"")},d().createElement("div",{ref:V,style:Z,className:"relative bg-white rounded-lg will-change-transform ".concat($?"z-10 shadow-xl ring-2 ring-green-500":""),"data-testid":"sortable-image-".concat(a.pid),onMouseEnter:function(){return T(!0)},onMouseLeave:function(){M||(T(!1),A(!1))},onTouchStart:function(){T(!0)}},f&&d().createElement(Ge,null),d().createElement("div",{className:"absolute top-2 left-2 z-20"},d().createElement("input",{title:(0,u.__)("Select image","nggallery"),type:"checkbox",checked:l,onChange:function(){return o(a.pid)},onClick:function(e){return e.stopPropagation()},className:"rounded border-gray-300 ".concat(f?"cursor-not-allowed":"cursor-pointer"," w-5 h-5 md:w-4 md:h-4 text-green-600 focus:ring-green-500 focus:ring-2"),disabled:f})),d().createElement("div",{className:"absolute top-2 right-2 z-20 ".concat(f?"cursor-not-allowed":"cursor-pointer")},d().createElement(he.m,{isOpen:k,onClose:function(){A(!1)},onToggle:function(){A(!k)},trigger:d().createElement("button",{title:(0,u.__)("Actions","nggallery"),className:"bg-transparent p-2 md:p-1 hover:bg-opacity-80 focus:outline-none ".concat(f?"cursor-not-allowed":"cursor-pointer"),onClick:function(e){e.stopPropagation(),e.preventDefault(),A(!k)},disabled:f},d().createElement("svg",{className:"w-6 h-6 md:w-5 md:h-5 text-white hover:text-gray-300",viewBox:"0 0 20 20",fill:"currentColor"},d().createElement("path",{d:"M10 6a2 2 0 110-4 2 2 0 010 4zM10 12a2 2 0 110-4 2 2 0 010 4zM10 18a2 2 0 110-4 2 2 0 010 4z"})))},d().createElement("div",{className:"py-1"},d().createElement("button",{onClick:function(){j.setActiveModal("editImage",{image:a}),A(!1),T(!1)},className:"block w-full text-left px-4 py-1.5 text-sm text-gray-700 hover:bg-gray-100 ".concat(f?"cursor-not-allowed":"cursor-pointer"),disabled:f},(0,u.__)("Edit Details","nggallery")),d().createElement("button",{onClick:function(){j.setActiveModal("imageView",{image:{filename:a.filename,alttext:a.alttext,galleryPath:(null==r?void 0:r.path)||"",pid:a.pid,galleryid:a.galleryid,image_url:a.image_url}}),A(!1),T(!1)},className:"block w-full text-left px-4 py-1.5 text-sm text-gray-700 hover:bg-gray-100 ".concat(f?"cursor-not-allowed":"cursor-pointer"),disabled:f},(0,u.__)("Edit Image","nggallery")),d().createElement("button",{onClick:function(){F(!0),A(!1),T(!1)},className:"block w-full text-left px-4 py-1.5 text-sm text-gray-700 hover:bg-gray-100 ".concat(f?"cursor-not-allowed":"cursor-pointer"),disabled:f},(0,u.__)("View Meta","nggallery")),d().createElement("button",{onClick:function(){s(a),A(!1)},className:"block w-full text-left px-4 py-1.5 text-sm text-red-600 hover:bg-gray-100 ".concat(f?"cursor-not-allowed":"cursor-pointer"),disabled:f},(0,u.__)("Delete Image","nggallery")),d().createElement("button",{onClick:ee,className:"block w-full text-left px-4 py-1.5 text-sm text-gray-700 hover:bg-gray-100 ".concat(f?"cursor-not-allowed":"cursor-pointer"),disabled:f},(0,u.__)("Recover from Backup","nggallery")),d().createElement("button",{onClick:function(){h(a.pid),A(!1)},className:"block w-full text-left px-4 py-1.5 text-sm text-gray-700 hover:bg-gray-100 ".concat(f?"cursor-not-allowed":"cursor-pointer"),disabled:f},(0,u.__)("Generate Thumbnail","nggallery")),d().createElement("button",{onClick:ae,className:"block w-full text-left px-4 py-1.5 text-sm text-gray-700 hover:bg-gray-100  ".concat(f||ne?"cursor-not-allowed":"cursor-pointer"),disabled:f||ne},ne?(0,u.__)("Current Preview Thumbnail","nggallery"):(0,u.__)("Set as Preview Thumbnail","nggallery")),d().createElement("button",{onClick:function(e){e.stopPropagation(),b(a,!a.exclude),A(!1),T(!1)},className:"block w-full text-left px-4 py-1.5 text-sm ".concat(a.exclude?"text-blue-600":"text-gray-700"," hover:bg-gray-100 ").concat(f?"cursor-not-allowed":"cursor-pointer"),disabled:f},a.exclude?(0,u.__)("Show Image","nggallery"):(0,u.__)("Hide Image","nggallery")),we()&&ke(a)&&d().createElement(d().Fragment,null,d().createElement("button",{onClick:q,className:"block w-full text-left px-4 py-1.5 text-sm text-blue-600 hover:bg-gray-100 cursor-pointer"},(0,u.__)("View CDN URL","nggallery")),d().createElement("button",{onClick:K,className:"block w-full text-left px-4 py-1.5 text-sm text-orange-600 hover:bg-gray-100 cursor-pointer"},(0,u.__)("Remove from CDN","nggallery")))))),d().createElement("div",{className:"overflow-hidden rounded-lg bg-gray-100 flex items-center justify-center relative cursor-pointer w-full h-[100px] sm:h-[120px] md:w-[130px] md:h-[90px]",onClick:function(e){e.stopPropagation(),j.setActiveModal("galleryImageView",{image:{filename:a.filename,alttext:a.alttext,galleryPath:(null==r?void 0:r.path)||"",pid:a.pid},galleryId:null==r?void 0:r.gid})}},d().createElement("img",{src:"".concat(a.thumb_url||"").concat(a.reloadKey?"?t=".concat(a.reloadKey):""),alt:a.alttext||"",className:"w-full h-full object-cover cursor-pointer ".concat(a.exclude?"opacity-50 grayscale":""),loading:"lazy",draggable:!1}),a.exclude&&d().createElement("div",{className:"absolute inset-0 flex items-center justify-center bg-black bg-opacity-30"},d().createElement("div",{className:"bg-gray-600 text-white text-xs px-2 py-1 rounded font-medium shadow-lg"},(0,u.__)("Hidden","nggallery"))),te&&d().createElement("div",{className:"absolute inset-0 bg-black bg-opacity-60 flex items-center justify-center z-10 transition-opacity"})),d().createElement("div",{className:"mt-2 px-1"},d().createElement("div",{className:"flex items-center justify-between"},d().createElement("p",{className:"text-sm text-gray-900 truncate flex-1 mr-2",title:a.alttext||a.filename},a.alttext||a.filename),d().createElement("button",(0,_.A)({},f?{}:je(je({},X),Q),{className:"flex-shrink-0 text-gray-100 p-1 rounded hover:bg-gray-100 ".concat(f?"cursor-not-allowed opacity-50":"cursor-move"),disabled:f,title:(0,u.__)("Drag to reorder","nggallery")}),d().createElement(i.GG,{className:"text-gray-500"}))),a.tags&&a.tags.length>0&&d().createElement("div",{className:"mt-1 flex flex-nowrap gap-1 overflow-hidden"},function(){for(var e=0,t=[],n=0;n<a.tags.length;n++){var r=a.tags[n],l=r.length+2;if(e+l>15)break;t.push(r),e+=l}var i=a.tags.length-t.length;return d().createElement(d().Fragment,null,t.map(function(e,t){return d().createElement("span",{key:t,className:"inline-flex items-center px-1.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-700 flex-shrink-0",title:e},e)}),i>0&&d().createElement("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-700 flex-shrink-0"},"+",i))}()))),d().createElement(Fe,{isOpen:O,onClose:function(){return F(!1)},image:a}))});ze.displayName="SortableImage";const Le=ze;function Re(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function Be(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Re(Object(a),!0).forEach(function(t){(0,h.A)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Re(Object(a)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}function Ye(e,t){var a="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=function(e,t){if(e){if("string"==typeof e)return qe(e,t);var a={}.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?qe(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){a&&(e=a);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,i=!0,o=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return i=e.done,e},e:function(e){o=!0,l=e},f:function(){try{i||null==a.return||a.return()}finally{if(o)throw l}}}}function qe(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=Array(t);a<t;a++)n[a]=e[a];return n}var Ke=function(e){var t=e.onClick;return d().createElement("div",{className:"relative w-full"},d().createElement("div",{className:"relative bg-gray-100 rounded-lg border-2 border-dashed border-gray-300 hover:border-gray-400 cursor-pointer transition-colors w-full h-[90px] sm:h-[100px] md:w-[130px] md:h-[90px]",onClick:t},d().createElement("div",{className:"absolute inset-0 flex flex-col items-center justify-center"},d().createElement(i.c1,{className:"w-6 h-6 sm:w-8 sm:h-8 text-gray-400 mb-1 sm:mb-2"}),d().createElement("span",{className:"text-xs sm:text-sm text-gray-500 font-medium"},(0,u.__)("Add Images","nggallery")))))};const Ue=function(e){var t=e.gallery,a=e.error,r=(0,g.useDispatch)(c.E),l=T(),o=l.state,s=l.updateImageSettings,p=(0,Ee.r)(),_=p.navigateTo,h=p.currentId,f=(0,x.E)(),b=f.showSuccess,w=f.showError,C=(0,be.UG)().data,k=(null==C?void 0:C.item_details_per_page)||50,A=(null==t?void 0:t.gid)||h,N=(0,Ie.jE)(),S=(0,E.TG)(),I=(0,ve.yr)(),D=(0,E.sr)(),P=(0,E.fZ)(),O=(0,E.Hh)(),F=(0,E.CD)(),M=(0,E.cX)(),j=(0,E.NK)(),G=(0,m.useState)([]),z=(0,n.A)(G,2),L=z[0],R=z[1],B=(0,m.useState)(null),Y=(0,n.A)(B,2),q=Y[0],K=Y[1],U=(0,m.useState)(!1),W=(0,n.A)(U,2),X=W[0],Q=W[1],V=(0,m.useState)(!1),H=(0,n.A)(V,2),J=H[0],$=H[1],Z=(0,m.useState)(new Set),ee=(0,n.A)(Z,2),te=ee[0],ae=ee[1],ne=(0,m.useState)(!1),re=(0,n.A)(ne,2),le=re[0],ie=re[1],oe=new Set(o.imageSettings.selectedImages||[]),ce=function(e){try{s({selectedImages:Array.from(e)})}catch(e){console.error("Error updating image settings:",e)}},se=(0,_e.FR)((0,_e.MS)(_e.AN,{activationConstraint:{distance:8,delay:100,tolerance:10}}),(0,_e.MS)(_e.uN,{coordinateGetter:ye.JR})),ge=(0,E.iX)(null!=A?A:0),ue=ge.data,me=ge.isLoading,de=ge.error,Ce=ge.isError,Te=(0,m.useState)(1),Pe=(0,n.A)(Te,2),Oe=Pe[0],Fe=Pe[1],Me=(0,E.gj)(null!=A?A:0,{per_page:k,page:Oe}),je=Me.data,Ge=Me.isLoading,ze=Me.error,Re=(null==je?void 0:je.images)||[],qe=(null==je?void 0:je.pagination)||{total:0,total_pages:1,per_page:k,current_page:Oe};(0,m.useEffect)(function(){Fe(1)},[A]);var Ue=qe.total,We=qe.total_pages,Xe=(0,m.useCallback)(function(e){Fe(e),window.scrollTo({top:0,behavior:"smooth"})},[]),Qe=(0,m.useRef)(!1);(0,m.useEffect)(function(){de&&A&&!Qe.current&&(Qe.current=!0,w((0,u.__)("Gallery not found.","nggallery")),_("imagely-galleries","galleries"))},[de,A,w,_]),(0,m.useEffect)(function(){Ce&&A&&!de&&!Qe.current&&(Qe.current=!0,w((0,u.__)("Gallery not found.","nggallery")),_("imagely-galleries","galleries"))},[Ce,A,de,w,_]);var Ve=ue||t;(0,m.useEffect)(function(){Re.length>0&&R(Re)},[Re]);var He=(0,m.useCallback)(function(){var e=(0,y.A)(v().mark(function e(t){var a,n,r,l,i,o,c,s,g,m,d,p,_,y;return v().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.active,n=t.over,K(null),!n||a.id===n.id||!A){e.next=30;break}return r=L.findIndex(function(e){return e.pid===a.id}),l=L.findIndex(function(e){return e.pid===n.id}),i=(0,ye.be)(L,r,l),R(i),e.prev=7,o=(0,xe.m9)(),e.next=11,De()({path:"/imagely/v1/images?gallery_id=".concat(A,"&per_page=-1&orderby=sortorder&order=asc"),method:"GET",headers:{"X-WP-Nonce":o}});case 11:if(c=e.sent,Array.isArray(c)&&0!==c.length){e.next=14;break}return e.abrupt("return");case 14:s=new Set(i.map(function(e){return e.pid})),g=[],m=0,d=Ye(c);try{for(d.s();!(p=d.n()).done;)_=p.value,s.has(_.pid)?(g.push(i[m]),m++):g.push(_)}catch(e){d.e(e)}finally{d.f()}return y=g.map(function(e,t){return{id:e.pid,sortorder:t+1}}),e.next=22,S.mutateAsync({images:y});case 22:e.next=29;break;case 24:e.prev=24,e.t0=e.catch(7),console.error("Error reordering images:",e.t0),w((0,u.__)("Failed to reorder images","nggallery")),N.invalidateQueries({queryKey:["gallery",A,"images"]});case 29:window.navigator.vibrate&&window.navigator.vibrate([50,50,50]);case 30:case"end":return e.stop()}},e,null,[[7,24]])}));return function(t){return e.apply(this,arguments)}}(),[S,A,L,N,w]),Je=(0,m.useMemo)(function(){return L.map(function(e){return e.pid})},[L]),$e=function(){var e=(0,y.A)(v().mark(function e(a){var n,r,l,i;return v().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&A){e.next=3;break}return w((0,u.__)("Cannot sort: Gallery not loaded","nggallery")),e.abrupt("return");case 3:return e.prev=3,s({sortBy:a,sortOrder:"asc"}),b((0,u.__)("Sorting images...","nggallery")),n=(0,xe.m9)(),e.next=9,De()({path:"/imagely/v1/images?gallery_id=".concat(A,"&per_page=-1&orderby=sortorder&order=asc"),method:"GET",headers:{"X-WP-Nonce":n}});case 9:if(r=e.sent,Array.isArray(r)&&0!==r.length){e.next=13;break}return w((0,u.__)("No images found to sort","nggallery")),e.abrupt("return");case 13:return l=(0,pe.A)(r),"invert"===a?l.reverse():l.sort(function(e,t){switch(a){case"pid":return e.pid-t.pid;case"filename":return(e.filename||"").localeCompare(t.filename||"");case"alttext":return(e.alttext||"").localeCompare(t.alttext||"");case"imagedate":return new Date(t.imagedate||0).getTime()-new Date(e.imagedate||0).getTime();default:return 0}}),i=l.map(function(e,t){return{id:e.pid,sortorder:t+1}}),e.next=18,S.mutateAsync({images:i});case 18:return e.next=20,N.invalidateQueries({queryKey:["galleryImages",A]});case 20:b((0,u.__)("Images sorted successfully!","nggallery")),e.next=26;break;case 23:e.prev=23,e.t0=e.catch(3),w((0,u.__)("Failed to sort images: ","nggallery")+(e.t0 instanceof Error?e.t0.message:String(e.t0)));case 26:case"end":return e.stop()}},e,null,[[3,23]])}));return function(t){return e.apply(this,arguments)}}(),Ze=function(e){var t=new Set(oe);t.has(e)?t.delete(e):t.add(e),ce(t)},et=function(e){var t;r.setActiveModal("deleteImages",{images:[e],onClose:function(){return r.setActiveModal(null)},onConfirm:(t=(0,y.A)(v().mark(function t(){return v().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return R(function(t){return t.filter(function(t){return t.pid!==e.pid})}),t.next=3,r.deleteItem("images",e.pid);case 3:r.setActiveModal(null);case 4:case"end":return t.stop()}},t)})),function(){return t.apply(this,arguments)})})},tt=function(){var e=(0,y.A)(v().mark(function e(t){var a,n,r;return v().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return ae(function(e){return new Set(e).add(t)}),e.prev=1,e.next=4,P.mutateAsync(t);case 4:a=Date.now(),A&&N.setQueriesData({queryKey:["gallery",A,"images"]},function(e){return null!=e&&e.images?Be(Be({},e),{},{images:e.images.map(function(e){return e.pid===t?Be(Be({},e),{},{reloadKey:a}):e})}):e}),Ve&&Ve.previewpic===t&&(r="".concat((null===(n=Ve.previewpic_url)||void 0===n?void 0:n.split("?")[0])||"","?t=").concat(a),N.setQueryData(["gallery",Ve.gid],function(e){return e?Be(Be({},e),{},{previewpic_url:r}):e}),N.setQueriesData({queryKey:["galleries"]},function(e){return null!=e&&e.galleries?Be(Be({},e),{},{galleries:e.galleries.map(function(e){return e.gid===Ve.gid?Be(Be({},e),{},{previewpic_url:r}):e})}):e})),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.error("Error recovering image",e.t0);case 12:return e.prev=12,ae(function(e){var a=new Set(e);return a.delete(t),a}),e.finish(12);case 15:case"end":return e.stop()}},e,null,[[1,9,12,15]])}));return function(t){return e.apply(this,arguments)}}(),at=function(){var e=(0,y.A)(v().mark(function e(t){var a,n,r;return v().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return ae(function(e){return new Set(e).add(t)}),e.prev=1,e.next=4,O.mutateAsync(t);case 4:a=Date.now(),A&&N.setQueriesData({queryKey:["gallery",A,"images"]},function(e){return null!=e&&e.images?Be(Be({},e),{},{images:e.images.map(function(e){return e.pid===t?Be(Be({},e),{},{reloadKey:a}):e})}):e}),Ve&&Ve.previewpic===t&&(r="".concat((null===(n=Ve.previewpic_url)||void 0===n?void 0:n.split("?")[0])||"","?t=").concat(a),N.setQueryData(["gallery",Ve.gid],function(e){return e?Be(Be({},e),{},{previewpic_url:r}):e}),N.setQueriesData({queryKey:["galleries"]},function(e){return null!=e&&e.galleries?Be(Be({},e),{},{galleries:e.galleries.map(function(e){return e.gid===Ve.gid?Be(Be({},e),{},{previewpic_url:r}):e})}):e})),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.error("Error generating thumbnail",e.t0);case 12:return e.prev=12,ae(function(e){var a=new Set(e);return a.delete(t),a}),e.finish(12);case 15:case"end":return e.stop()}},e,null,[[1,9,12,15]])}));return function(t){return e.apply(this,arguments)}}(),nt=function(){var e=(0,y.A)(v().mark(function e(t,a){var n,r,l;return v().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return ae(function(e){return new Set(e).add(t)}),e.prev=1,e.next=4,D.mutateAsync({pid:t,rotation:a});case 4:n=Date.now(),A&&N.setQueriesData({queryKey:["gallery",A,"images"]},function(e){return null!=e&&e.images?Be(Be({},e),{},{images:e.images.map(function(e){return e.pid===t?Be(Be({},e),{},{reloadKey:n}):e})}):e}),Ve&&Ve.previewpic===t&&(l="".concat((null===(r=Ve.previewpic_url)||void 0===r?void 0:r.split("?")[0])||"","?t=").concat(n),N.setQueryData(["gallery",Ve.gid],function(e){return e?Be(Be({},e),{},{previewpic_url:l}):e}),N.setQueriesData({queryKey:["galleries"]},function(e){return null!=e&&e.galleries?Be(Be({},e),{},{galleries:e.galleries.map(function(e){return e.gid===Ve.gid?Be(Be({},e),{},{previewpic_url:l}):e})}):e})),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.error("Error rotating image",e.t0);case 12:return e.prev=12,ae(function(e){var a=new Set(e);return a.delete(t),a}),e.finish(12);case 15:case"end":return e.stop()}},e,null,[[1,9,12,15]])}));return function(t,a){return e.apply(this,arguments)}}(),rt=function(){var e=(0,y.A)(v().mark(function e(){var t,a,n,r;return v().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=L.filter(function(e){return oe.has(e.pid)}),ae(function(e){var a=new Set(e);return t.forEach(function(e){return a.add(e.pid)}),a}),a=Ye(t),e.prev=3,a.s();case 5:if((n=a.n()).done){e.next=11;break}return r=n.value,e.next=9,tt(r.pid);case 9:e.next=5;break;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(3),a.e(e.t0);case 16:return e.prev=16,a.f(),e.finish(16);case 19:$(!1),ce(new Set);case 21:case"end":return e.stop()}},e,null,[[3,13,16,19]])}));return function(){return e.apply(this,arguments)}}(),lt=function(){var e=(0,y.A)(v().mark(function e(){var t,a,n,r,l,i,o,c,s;return v().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=L.filter(function(e){return oe.has(e.pid)}),0!==(a=t.filter(function(e){return ke(e)})).length){e.next=6;break}return w((0,u.__)("No selected images are on CDN","nggallery")),$(!1),e.abrupt("return");case 6:if(n=Ae(),r=Ne(),n){e.next=12;break}return w((0,u.__)("Authentication error","nggallery")),$(!1),e.abrupt("return");case 12:ae(function(e){var t=new Set(e);return a.forEach(function(e){return t.add(e.pid)}),t}),$(!1),l=0,i=0,o=Ye(a),e.prev=17,s=v().mark(function e(){var t,a;return v().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=c.value,e.prev=1,e.next=4,fetch("".concat(r,"envira-cdn/v1/ngg-remove-image/").concat(t.pid),{method:"DELETE",headers:{"X-WP-Nonce":n}});case 4:if(!(a=e.sent).ok){e.next=12;break}return e.next=8,a.json();case 8:e.sent.success?l++:i++,e.next=13;break;case 12:i++;case 13:e.next=19;break;case 15:e.prev=15,e.t0=e.catch(1),console.error("CDN removal error:",e.t0),i++;case 19:return e.prev=19,ae(function(e){var a=new Set(e);return a.delete(t.pid),a}),e.finish(19);case 22:case"end":return e.stop()}},e,null,[[1,15,19,22]])}),o.s();case 20:if((c=o.n()).done){e.next=24;break}return e.delegateYield(s(),"t0",22);case 22:e.next=20;break;case 24:e.next=29;break;case 26:e.prev=26,e.t1=e.catch(17),o.e(e.t1);case 29:return e.prev=29,o.f(),e.finish(29);case 32:if(l>0&&0===i?b((0,u.__)("Successfully removed ".concat(l," image(s) from CDN"),"nggallery")):l>0&&i>0?b((0,u.__)("Removed ".concat(l," image(s) from CDN. ").concat(i," failed."),"nggallery")):w((0,u.__)("Failed to remove images from CDN","nggallery")),!A){e.next=36;break}return e.next=36,N.invalidateQueries({queryKey:["gallery",A,"images"]});case 36:ce(new Set);case 37:case"end":return e.stop()}},e,null,[[17,26,29,32]])}));return function(){return e.apply(this,arguments)}}(),it=function(){var e=(0,y.A)(v().mark(function e(t){var a,n,r,l;return v().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a=L.filter(function(e){return oe.has(e.pid)}),ae(function(e){var t=new Set(e);return a.forEach(function(e){return t.add(e.pid)}),t}),n=Ye(a),e.prev=3,n.s();case 5:if((r=n.n()).done){e.next=11;break}return l=r.value,e.next=9,nt(l.pid,t);case 9:e.next=5;break;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(3),n.e(e.t0);case 16:return e.prev=16,n.f(),e.finish(16);case 19:$(!1),ce(new Set);case 21:case"end":return e.stop()}},e,null,[[3,13,16,19]])}));return function(t){return e.apply(this,arguments)}}(),ot=function(){var e=(0,y.A)(v().mark(function e(){var t,a,n,r;return v().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=L.filter(function(e){return oe.has(e.pid)}),ae(function(e){var a=new Set(e);return t.forEach(function(e){return a.add(e.pid)}),a}),a=Ye(t),e.prev=3,r=v().mark(function e(){var t,a;return v().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.value,a=Date.now(),e.prev=2,e.next=5,F.mutateAsync(t.pid);case 5:A&&N.setQueriesData({queryKey:["gallery",A,"images"]},function(e){return null!=e&&e.images?Be(Be({},e),{},{images:e.images.map(function(e){return e.pid===t.pid?Be(Be({},e),{},{reloadKey:a}):e})}):e}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),console.error("Error setting watermark",e.t0);case 11:case"end":return e.stop()}},e,null,[[2,8]])}),a.s();case 6:if((n=a.n()).done){e.next=10;break}return e.delegateYield(r(),"t0",8);case 8:e.next=6;break;case 10:e.next=15;break;case 12:e.prev=12,e.t1=e.catch(3),a.e(e.t1);case 15:return e.prev=15,a.f(),e.finish(15);case 18:$(!1),ce(new Set),ae(function(e){var a=new Set(e);return t.forEach(function(e){return a.delete(e.pid)}),a});case 21:case"end":return e.stop()}},e,null,[[3,12,15,18]])}));return function(){return e.apply(this,arguments)}}(),ct=function(){var e=(0,y.A)(v().mark(function e(){var t,a;return v().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=L.filter(function(e){return oe.has(e.pid)}),a=t.map(function(e){return e.pid}),r.setActiveModal("bulkResize",{imageIds:a,galleryId:A,onConfirm:function(){ce(new Set)}});case 3:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),st=function(){var e=(0,y.A)(v().mark(function e(){var t,a,n;return v().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=L.filter(function(e){return oe.has(e.pid)}),a=t.map(function(e){return e.pid}),ae(function(e){var a=new Set(e);return t.forEach(function(e){return a.add(e.pid)}),a}),e.prev=3,e.next=6,M.mutateAsync(a);case 6:(n=e.sent).success_count>0&&r.showNotice("success","Successfully imported metadata for ".concat(n.success_count," of ").concat(n.processed," images")),n.failure_count>0&&r.showNotice("warning","Failed to import metadata for ".concat(n.failure_count," images")),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(3),console.error("Error bulk importing metadata:",e.t0),r.showNotice("error","Failed to import metadata for selected images");case 15:return e.prev=15,ae(function(e){var a=new Set(e);return t.forEach(function(e){return a.delete(e.pid)}),a}),$(!1),ce(new Set),e.finish(15);case 20:case"end":return e.stop()}},e,null,[[3,11,15,20]])}));return function(){return e.apply(this,arguments)}}(),gt=function(){var e=(0,y.A)(v().mark(function e(t,a){return v().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,I.mutateAsync({imageId:t.pid,data:{exclude:a}});case 3:R(function(e){return e.map(function(e){return e.pid===t.pid?Be(Be({},e),{},{exclude:a}):e})}),b((0,u.__)("Image visibility updated successfully!","nggallery")),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),w((0,u.__)("Failed to update image visibility","nggallery"));case 10:case"end":return e.stop()}},e,null,[[0,7]])}));return function(t,a){return e.apply(this,arguments)}}(),ut=function(){var e=(0,y.A)(v().mark(function e(){var t;return v().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(A){e.next=2;break}return e.abrupt("return");case 2:return ie(!0),e.prev=3,e.next=6,j.mutateAsync(A);case 6:(t=e.sent).images_added>0?b(t.message):r.showNotice("info",t.message),t.errors&&t.errors.length>0&&t.errors.forEach(function(e){w(e)}),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(3),w((null===e.t0||void 0===e.t0?void 0:e.t0.message)||(0,u.__)("Failed to scan folder for new images.","nggallery"));case 14:return e.prev=14,ie(!1),e.finish(14);case 17:case"end":return e.stop()}},e,null,[[3,11,14,17]])}));return function(){return e.apply(this,arguments)}}();if(a)return d().createElement("div",{className:"text-red-600"},(0,u.__)("Error:","nggallery")," ",a);if(ze)return d().createElement("div",{className:"text-red-600"},(0,u.__)("Error loading images:","nggallery")," ",ze.message);var mt=q?L.find(function(e){return e.pid===q}):null,dt=((null==Ve?void 0:Ve.title)||"").replace(/<\/?[^>]+(>|$)/g,""),pt=((null==Ve?void 0:Ve.galdesc)||"").replace(/<\/?[^>]+(>|$)/g,""),_t=pt.length>100?pt.slice(0,100)+"...":pt,yt=dt.length>50?dt.slice(0,50)+"...":dt;return d().createElement("div",{className:""},d().createElement("div",{className:"p-6 lg:p-8 space-y-6"},d().createElement("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3 sm:gap-0"},d().createElement("div",{className:"flex items-center space-x-3 sm:space-x-4 ".concat(me?"opacity-50":"")},d().createElement("img",{src:null!=Ve&&Ve.previewpic_url?null==Ve?void 0:Ve.previewpic_url:(0,Se.B)({text:"NO IMAGE"}),alt:yt,className:"w-10 h-10 sm:w-12 sm:h-12 object-cover rounded flex-shrink-0"}),d().createElement("div",{className:"flex flex-col min-w-0 flex-1"},d().createElement("div",{className:"flex flex-col sm:flex-row sm:items-center space-y-1 sm:space-y-0 sm:space-x-2"},d().createElement("h1",{className:"text-lg sm:text-xl font-semibold truncate"},yt," (",Ue,")"),d().createElement("button",{className:"px-2 py-1 bg-gray-100 rounded hover:bg-gray-200 text-xs sm:text-sm flex items-center self-start sm:self-auto",onClick:function(){return r.setActiveModal("galleryEdit",{galleryId:null==Ve?void 0:Ve.gid})}},d().createElement("svg",{width:"8",height:"8",viewBox:"0 0 10 10",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"mr-1 sm:w-2.5 sm:h-2.5"},d().createElement("path",{d:"M7.5 0.500151C7.63132 0.368829 7.78722 0.264659 7.9588 0.193588C8.13038 0.122517 8.31428 0.0859375 8.5 0.0859375C8.68572 0.0859375 8.86962 0.122517 9.0412 0.193588C9.21278 0.264659 9.36868 0.36883 9.5 0.500151C9.63132 0.631473 9.73549 0.787375 9.80656 0.958955C9.87763 1.13054 9.91421 1.31443 9.91421 1.50015C9.91421 1.68587 9.87763 1.86977 9.80656 2.04135C9.73549 2.21293 9.63132 2.36883 9.5 2.50015L2.75 9.25015L0 10.0002L0.75 7.25015L7.5 0.500151Z",fill:"currentColor"})),(0,u.__)("Edit Details","nggallery"))),_t&&d().createElement("p",{className:"text-gray-500 text-xs sm:text-sm"},_t)))),d().createElement("hr",null),d().createElement("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3 sm:gap-0"},d().createElement("div",{className:"flex items-center space-x-2"},L.length>0&&d().createElement("input",{type:"checkbox",checked:oe.size===L.length,onChange:function(e){return t=e.target.checked,void ce(t?new Set(L.map(function(e){return e.pid})):new Set);var t},className:"rounded border-gray-300"}),d().createElement("h2",{className:"text-base sm:text-lg font-medium"},(0,u.__)("All Images","nggallery"))),d().createElement("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center space-y-2 sm:space-y-0 sm:space-x-4"},oe.size>0&&d().createElement(he.m,{isOpen:J,onClose:function(){return $(!1)},onToggle:function(){return $(!J)},trigger:d().createElement("button",{className:"appearance-none bg-white border rounded px-3 sm:px-4 py-2 pr-6 sm:pr-8 flex items-center justify-center space-x-2 text-sm sm:text-base w-full sm:w-auto"},d().createElement("span",null,(0,u.__)("Bulk Actions","nggallery")),d().createElement("svg",{className:"w-3 h-3 sm:w-4 sm:h-4",viewBox:"0 0 20 20",fill:"currentColor"},d().createElement("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})))},d().createElement("div",{className:"py-1"},d().createElement("button",{onClick:function(){ot(),$(!1)},className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100"},(0,u.__)("Set Watermark","nggallery")),d().createElement("button",{onClick:function(){var e,t;t=L.filter(function(e){return oe.has(e.pid)}),r.setActiveModal("deleteImages",{images:t,onClose:function(){return r.setActiveModal(null)},onConfirm:(e=(0,y.A)(v().mark(function e(){return v().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return R(function(e){return e.filter(function(e){return!oe.has(e.pid)})}),ce(new Set),e.next=4,Promise.all(t.map(function(e){return r.deleteItem("images",e.pid)}));case 4:r.setActiveModal(null);case 5:case"end":return e.stop()}},e)})),function(){return e.apply(this,arguments)})}),$(!1)},className:"block w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-gray-100"},(0,u.__)("Delete Selected","nggallery")),d().createElement("button",{onClick:function(){rt(),$(!1)},className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100"},(0,u.__)("Recover Selected","nggallery")),d().createElement("button",{onClick:function(){var e;e=L.filter(function(e){return oe.has(e.pid)}).map(function(e){return e.pid}),r.setActiveModal("bulkGenerateThumbnails",{imageIds:e,galleryId:A,onConfirm:function(){ce(new Set)}}),$(!1)},className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100"},(0,u.__)("Generate Thumbnails","nggallery")),d().createElement("button",{onClick:function(){it("cw"),$(!1)},className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100"},(0,u.__)("Rotate Clockwise","nggallery")),d().createElement("button",{onClick:function(){it("ccw"),$(!1)},className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100"},(0,u.__)("Rotate Counter-Clockwise","nggallery")),d().createElement("button",{onClick:function(){ct(),$(!1)},className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100"},(0,u.__)("Resize Selected","nggallery")),d().createElement("button",{onClick:function(){st(),$(!1)},className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100"},(0,u.__)("Import Metadata","nggallery")),d().createElement("button",{onClick:function(){var e;e=L.filter(function(e){return oe.has(e.pid)}).map(function(e){return e.pid}),r.setActiveModal("gallerySelect",{imageIds:e,operation:"copy",excludeGalleryId:null==t?void 0:t.gid,onConfirm:function(){ce(new Set)}}),$(!1)},className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100"},(0,u.__)("Copy to...","nggallery")),d().createElement("button",{onClick:function(){var e;e=L.filter(function(e){return oe.has(e.pid)}).map(function(e){return e.pid}),r.setActiveModal("gallerySelect",{imageIds:e,operation:"move",excludeGalleryId:null==t?void 0:t.gid,onConfirm:function(){R(function(e){return e.filter(function(e){return!oe.has(e.pid)})}),ce(new Set)}}),$(!1)},className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100"},(0,u.__)("Move to...","nggallery")),d().createElement("button",{onClick:function(){var e;e=L.filter(function(e){return oe.has(e.pid)}).map(function(e){return e.pid}),r.setActiveModal("tags",{imageIds:e,onConfirm:function(){ce(new Set)}}),$(!1)},className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100"},(0,u.__)("Edit Tags","nggallery")),we()&&L.some(function(e){return oe.has(e.pid)&&ke(e)})&&d().createElement("button",{onClick:function(){lt(),$(!1)},className:"block w-full text-left px-4 py-2 text-sm text-orange-600 hover:bg-gray-100"},(0,u.__)("Remove from CDN","nggallery")))),d().createElement(he.m,{isOpen:X,onClose:function(){return Q(!1)},onToggle:function(){return Q(!X)},trigger:d().createElement("button",{className:"appearance-none bg-white border rounded px-3 sm:px-4 py-2 pr-6 sm:pr-8 flex items-center justify-center space-x-2 text-sm sm:text-base w-full sm:w-auto"},d().createElement("span",null,(0,u.__)("Sort Images","nggallery")),d().createElement("svg",{className:"w-3 h-3 sm:w-4 sm:h-4",viewBox:"0 0 20 20",fill:"currentColor"},d().createElement("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})))},d().createElement("div",{className:"py-2"},d().createElement("button",{onClick:function(){$e("pid"),Q(!1)},className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 w-full text-left"},(0,u.__)("Sort by ID","nggallery")),d().createElement("button",{onClick:function(){$e("filename"),Q(!1)},className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 w-full text-left"},(0,u.__)("Sort by Filename","nggallery")),d().createElement("button",{onClick:function(){$e("alttext"),Q(!1)},className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 w-full text-left"},(0,u.__)("Sort by Alt Text","nggallery")),d().createElement("button",{onClick:function(){$e("imagedate"),Q(!1)},className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 w-full text-left"},(0,u.__)("Sort by Date","nggallery")),d().createElement("hr",{className:"my-2"}),d().createElement("button",{onClick:function(){$e("invert"),Q(!1)},className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 w-full text-left"},(0,u.__)("Invert Order","nggallery")))),A&&d().createElement("button",{onClick:ut,disabled:le,className:"appearance-none bg-white border rounded px-3 sm:px-4 py-2 flex items-center justify-center space-x-2 text-sm sm:text-base w-full sm:w-auto hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",title:(0,u.__)("Scan the gallery folder for new images added via FTP or file manager","nggallery")},d().createElement(i.B8,{className:"w-4 h-4"}),d().createElement("span",null,le?(0,u.__)("Scanning...","nggallery"):(0,u.__)("Scan Folder","nggallery"))))),d().createElement("div",{className:"relative ".concat(Ge?"opacity-50":"")},d().createElement(_e.Mp,{sensors:se,collisionDetection:_e.fp,onDragStart:function(e){K(e.active.id),window.navigator.vibrate&&window.navigator.vibrate(50)},onDragEnd:He,measuring:{droppable:{strategy:_e.Pf.Always}}},d().createElement(ye.gB,{items:Je,strategy:ye.kL},d().createElement(d().Fragment,null,d().createElement("div",{className:"grid gap-4 sm:gap-6 grid-cols-2 sm:grid-cols-3 md:grid-cols-[repeat(auto-fill,_130px)]"},d().createElement(Ke,{onClick:function(){return r.setActiveModal("imageUploader",{galleryId:null==Ve?void 0:Ve.gid})}}),L.map(function(e){return d().createElement(Le,{key:"".concat(e.pid,"-").concat(e.reloadKey||""),image:e,gallery:Ve,isSelected:oe.has(e.pid),onSelect:Ze,onDelete:et,onRecover:tt,onGenerateThumbnail:at,isProcessing:te.has(e.pid),onToggleVisibility:gt})})))),d().createElement(_e.Hd,null,mt&&d().createElement("div",{className:"transform scale-105 opacity-90 pointer-events-none"},d().createElement(Le,{image:mt,gallery:Ve,isSelected:oe.has(mt.pid),onSelect:Ze,onDelete:et,onRecover:tt,onGenerateThumbnail:at,isProcessing:te.has(mt.pid),onToggleVisibility:gt})))),!Ge&&We>1&&d().createElement(fe.A,{currentPage:Oe,totalPages:We,perPage:k,total:Ue,onPageChange:Xe,itemLabel:(0,u.__)("images","nggallery"),showItemCount:!0}))))};var We=a(3633);function Xe(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function Qe(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Xe(Object(a),!0).forEach(function(t){(0,h.A)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Xe(Object(a)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}const Ve=function(e){var t,a,r,l=e.gallery,o=e.previewMode,s=e.onPreviewModeChange,p=T(),_=p.updateField,f=p.registerFlushCallback,b=p.unregisterFlushCallback,C=(0,E.hW)(),k=(0,x.E)(),A=k.showSuccess,N=k.showError,S=(0,g.useDispatch)(c.E),I=(0,be.UG)().data,D=(0,be.h5)(),O=(0,m.useState)({title:(null==l?void 0:l.title)||"",description:(null==l?void 0:l.galdesc)||"",is_ecommerce_enabled:"1"===(null==l?void 0:l.is_ecommerce_enabled),pricelist_id:(null==l||null===(t=l.pricelist_id)||void 0===t?void 0:t.toString())||"0",pageid:(null==l||null===(a=l.pageid)||void 0===a?void 0:a.toString())||""}),F=(0,n.A)(O,2),M=F[0],j=F[1],G=(0,m.useRef)(null),z=(0,m.useRef)(null),Y=(0,m.useCallback)(function(){G.current&&(clearTimeout(G.current),G.current=null),z.current&&(z.current(),z.current=null)},[]),q=(0,We.Eq)({enabled:"pro"===c.W,per_page:-1}),K=q.data,U=q.isLoading,W=(0,m.useState)([]),X=(0,n.A)(W,2),Q=X[0],V=X[1],H=(0,m.useState)(!0),J=(0,n.A)(H,2),$=J[0],Z=J[1],ee=(0,m.useState)([]),te=(0,n.A)(ee,2),ae=te[0],ne=te[1],re=(0,m.useState)({open:!1,title:"",isCreating:!1}),le=(0,n.A)(re,2),ie=le[0],oe=le[1];(0,m.useEffect)(function(){if(l){var e,t,a,n=(null===(e=l.extras_post_meta)||void 0===e?void 0:e.pricelist_id)||(null===(t=l.pricelist_id)||void 0===t?void 0:t.toString())||"0",r="1"===String(l.is_ecommerce_enabled);if(r&&("0"===n||!n)){var i,o=null==K||null===(i=K.pricelists)||void 0===i?void 0:i[0];o&&(n=o.id.toString())}j({title:l.title||"",description:l.galdesc||"",is_ecommerce_enabled:r,pricelist_id:n,pageid:(null===(a=l.pageid)||void 0===a?void 0:a.toString())||""})}},[null==l?void 0:l.gid,K]),(0,m.useEffect)(function(){return f("settingsTab",Y),function(){Y(),b("settingsTab")}},[Y,f,b]),(0,m.useEffect)(function(){var e=!0,t=function(){var t=(0,y.A)(v().mark(function t(){var a;return v().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,De()({path:"/wp/v2/pages?per_page=-1&status=publish"});case 3:a=t.sent,e&&V(a),t.next=11;break;case 7:t.prev=7,t.t0=t.catch(0),console.error("Error fetching pages:",t.t0),e&&V([]);case 11:return t.prev=11,e&&Z(!1),t.finish(11);case 14:case"end":return t.stop()}},t,null,[[0,7,11,14]])}));return function(){return t.apply(this,arguments)}}();return t(),function(){e=!1}},[]);var ce=(0,m.useCallback)(function(){var e=(0,y.A)(v().mark(function e(t,a){var n,r,l,i,o,c,s,g,m,d;return v().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,l=null===(n=window.imagelyApp)||void 0===n?void 0:n.nonce,e.next=4,De()({path:"/wp/v2/pages/".concat(t,"?context=edit"),method:"GET",headers:{"X-WP-Nonce":l}});case 4:if(i=e.sent,o=(null===(r=i.content)||void 0===r?void 0:r.raw)||"",c=new RegExp("\\[imagely[^\\]]*id=[\"']?".concat(a,"[\"']?[^\\]]*\\]"),"i"),s=new RegExp("\\[ngg[^\\]]*id=[\"']?".concat(a,"[\"']?[^\\]]*\\]"),"i"),!c.test(o)&&!s.test(o)){e.next=10;break}return e.abrupt("return");case 10:return g='[imagely id="'.concat(a,'"]'),m=""===o.trim()?g:"".concat(o,"\n\n").concat(g),e.next=14,De()({path:"/wp/v2/pages/".concat(t),method:"POST",headers:{"X-WP-Nonce":l,"Content-Type":"application/json"},data:{content:m}});case 14:e.next=21;break;case 16:e.prev=16,e.t0=e.catch(0),console.error("Error inserting gallery into page:",e.t0),d=(null===e.t0||void 0===e.t0?void 0:e.t0.message)||(0,u.__)("Unknown error occurred","nggallery"),N((0,u.__)("Failed to insert gallery shortcode into page: ","nggallery")+d);case 21:case"end":return e.stop()}},e,null,[[0,16]])}));return function(t,a){return e.apply(this,arguments)}}(),[N]),se=(0,m.useCallback)(function(){var e=(0,y.A)(v().mark(function e(t,a,n){var r,i;return v().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!l){e.next=35;break}if(e.prev=1,r={},"title"!==t){e.next=7;break}r.title=a,e.next=26;break;case 7:if("description"!==t){e.next=11;break}r.galdesc=a,e.next=26;break;case 11:if("is_ecommerce_enabled"!==t){e.next=16;break}r.is_ecommerce_enabled=a?"1":"0",a&&(r.pricelist_id=parseInt(n.pricelist_id,10)),e.next=26;break;case 16:if("pricelist_id"!==t){e.next=20;break}r.pricelist_id=parseInt(a,10),e.next=26;break;case 20:if("pageid"!==t){e.next=26;break}if(r.pageid=a?parseInt(a,10):null,!a||""===a){e.next=26;break}return i=parseInt(a,10),e.next=26,ce(i,l.gid);case 26:return e.next=28,C.mutateAsync({id:l.gid,data:r});case 28:A((0,u.__)("Settings updated successfully!","nggallery")),e.next=35;break;case 31:e.prev=31,e.t0=e.catch(1),console.error("Error updating settings:",e.t0),N((0,u.__)("Failed to update settings. Please try again.","nggallery"));case 35:case"end":return e.stop()}},e,null,[[1,31]])}));return function(t,a,n){return e.apply(this,arguments)}}(),[l,C,A,N]),ge=function(e){var t=e.target,a=t.name,n=t.value,r="checkbox"===t.type?e.target.checked:n;if("pageid"!==a||"__create__"!==n){var l=Qe(Qe({},M),{},(0,h.A)({},a,r));if("is_ecommerce_enabled"===a&&r&&("0"===M.pricelist_id||!M.pricelist_id)){var i,o=null==K||null===(i=K.pricelists)||void 0===i?void 0:i[0];o&&(l.pricelist_id=o.id.toString())}j(l),_(a,r),"is_ecommerce_enabled"===a&&l.pricelist_id!==M.pricelist_id&&_("pricelist_id",l.pricelist_id),G.current&&clearTimeout(G.current);var c=function(){se(a,r,l)};z.current=c,G.current=window.setTimeout(function(){c(),z.current=null},1e3)}else ue()},ue=function(){oe({open:!0,title:"".concat((null==l?void 0:l.title)||"Gallery"," Page"),isCreating:!1})},me=function(){var e=(0,y.A)(v().mark(function e(){var t,a,n,r,l,i;return v().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(ie.title.trim()){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,oe(function(e){return Qe(Qe({},e),{},{isCreating:!0})}),a=null===(t=window.imagelyApp)||void 0===t?void 0:t.nonce,e.next=7,De()({path:"/wp/v2/pages",method:"POST",headers:{"X-WP-Nonce":a,"Content-Type":"application/json"},data:{title:ie.title,content:"",status:"publish"}});case 7:n=e.sent,(r=String((null==n?void 0:n.id)||""))&&(l=Qe(Qe({},M),{},{pageid:r}),j(l),_("pageid",r),i=null!=n&&n.title&&n.title.rendered?n.title.rendered:ie.title,ne(function(e){return[{id:Number(r),title:{rendered:i}}].concat((0,pe.A)(e))}),se("pageid",r,l),A((0,u.__)("Page created and linked successfully!","nggallery"))),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(2),console.error("Error creating page:",e.t0),N((0,u.__)("Failed to create page. Please try again.","nggallery"));case 16:return e.prev=16,oe({open:!1,title:"",isCreating:!1}),e.finish(16);case 19:case"end":return e.stop()}},e,null,[[2,12,16,19]])}));return function(){return e.apply(this,arguments)}}(),de=(0,m.useMemo)(function(){return[].concat((0,pe.A)(ae),(0,pe.A)(Q)).reduce(function(e,t){return e.find(function(e){return e.id===t.id})||e.push(t),e},[]).map(function(e){var t;return{value:String(e.id),label:(null===(t=e.title)||void 0===t?void 0:t.rendered)||"Page #".concat(e.id)}})},[Q,ae]),_e=(0,m.useMemo)(function(){var e=(null==K?void 0:K.pricelists)||[],t=[];return t.push({value:"0",label:(0,u.__)("None","nggallery")}),Array.isArray(e)&&e.length>0&&e.forEach(function(e){t.push({value:e.id.toString(),label:e.title})}),t},[K]),ye="pro"===c.W||"plus"===c.W,he="pro"===(null===(r=window.imagelyApp)||void 0===r?void 0:r.proTypeInstalled),fe=[].concat((0,pe.A)(ye?[{value:"photocrati-nextgen_pro_lightbox",label:(0,u.__)("Pro Lightbox","nggallery")}]:[]),[{value:"simplelightbox",label:(0,u.__)("Simplelightbox","nggallery")},{value:"fancybox",label:(0,u.__)("Fancybox","nggallery")},{value:"thickbox",label:(0,u.__)("Thickbox","nggallery")},{value:"shutter",label:(0,u.__)("Shutter","nggallery")},{value:"shutter2",label:(0,u.__)("Shutter Reloaded","nggallery")},{value:"custom_lightbox",label:(0,u.__)("Custom Lightbox","nggallery")},{value:"none",label:(0,u.__)("None","nggallery")}]),ve=(0,m.useCallback)(function(){var e=(0,y.A)(v().mark(function e(t){var a;return v().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.target.value,e.prev=1,e.next=4,D.mutateAsync({thumbEffect:a});case 4:A((0,u.__)("Lightbox setting updated successfully!","nggallery")),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(1),console.error("Error updating lightbox setting:",e.t0),N((0,u.__)("Failed to update lightbox setting. Please try again.","nggallery"));case 11:case"end":return e.stop()}},e,null,[[1,7]])}));return function(t){return e.apply(this,arguments)}}(),[D,A,N]),Ee=(0,g.useSelect)(function(e){return e(c.E).getCurrentId()},[]),xe=(0,E.iX)(Ee).data,we=(0,w.b)({type:"gallery",item:xe,includeEcommerce:M.is_ecommerce_enabled});return d().createElement(d().Fragment,null,d().createElement("div",{className:"bg-white rounded-lg shadow lg:grid lg:grid-cols-2 lg:items-start"},d().createElement("div",{className:"px-6 py-6 lg:px-8 lg:py-8 border-b lg:border-b-0 lg:border-r"},d().createElement("h1",{className:"text-lg font-medium"},(0,u.__)("Settings","nggallery")),d().createElement("div",{className:"space-y-4 mt-6"},d().createElement(R.A,{type:"text",name:"title",value:M.title,onChange:ge,label:(0,u.__)("Gallery Title","nggallery"),placeholder:(0,u.__)("Enter gallery title","nggallery")}),d().createElement("div",null,d().createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},(0,u.__)("Gallery Description","nggallery")),d().createElement("textarea",{name:"description",value:M.description,onChange:ge,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:3,placeholder:(0,u.__)("Enter gallery description","nggallery")})),d().createElement(L.A,{id:"pageid",name:"pageid",value:M.pageid,onChange:ge,label:(0,u.__)("Link to page:","nggallery"),help:(0,u.__)("Select a page to link this gallery to, or create a new page with the gallery content","nggallery")},$?d().createElement("option",{value:""},(0,u.__)("Loading pages...","nggallery")):d().createElement(d().Fragment,null,d().createElement("option",{value:""},(0,u.__)("Not linked","nggallery")),d().createElement("option",{value:"__create__",className:"text-green-600"},(0,u.__)("Create new page","nggallery")),de.map(function(e){return d().createElement("option",{key:e.value,value:e.value},e.label)}))),d().createElement("div",null,d().createElement("h3",{className:"text-sm font-medium text-gray-900 mb-4"},(0,u.__)("eCommerce Settings","nggallery")),he?d().createElement("div",{className:"space-y-4"},d().createElement(B.A,{id:"is_ecommerce_enabled",name:"is_ecommerce_enabled",checked:M.is_ecommerce_enabled,onChange:ge,label:(0,u.__)("Enable eCommerce","nggallery"),help:(0,u.__)("Enable eCommerce functionality for this gallery","nggallery")}),M.is_ecommerce_enabled&&d().createElement("div",{className:"pl-4 border-l-2 border-gray-200"},d().createElement(L.A,{id:"pricelist_id",name:"pricelist_id",value:M.pricelist_id,onChange:ge,label:(0,u.__)("Pricelist","nggallery"),help:(0,u.__)("Select a pricelist for this gallery","nggallery")},U?d().createElement("option",{value:"0",disabled:!0},(0,u.__)("Loading...","nggallery")):_e.map(function(e){return d().createElement("option",{key:e.value,value:e.value},e.label)})))):d().createElement("div",{className:"relative"},d().createElement("div",{className:"opacity-50 pointer-events-none"},d().createElement(B.A,{id:"is_ecommerce_enabled",name:"is_ecommerce_enabled",checked:!1,onChange:function(){},label:(0,u.__)("Enable eCommerce","nggallery"),help:(0,u.__)("Enable eCommerce functionality for this gallery","nggallery")})),d().createElement("div",{className:"absolute inset-0 cursor-pointer",onClick:function(){he||S.setActiveModal("upgrade",{feature:"eCommerce features"})},title:(0,u.__)("Requires NextGEN Gallery Pro","nggallery")}))),d().createElement("div",{className:"space-y-4"},d().createElement(L.A,{id:"thumbEffect",name:"thumbEffect",value:(null==I?void 0:I.thumbEffect)||"",onChange:ve,label:(0,u.__)("Lightbox Library","nggallery"),help:(0,u.__)("What lightbox would you like to use?","nggallery")},fe.map(function(e){return d().createElement("option",{key:e.value,value:e.value},e.label)})),d().createElement("div",{className:"bg-info-bg border border-info-border rounded-md p-3"},d().createElement("div",{className:"flex items-start"},d().createElement("div",{className:"flex-shrink-0"},d().createElement(i.F,{className:"h-4 w-4 text-gray-400 mt-0.5"})),d().createElement("div",{className:"ml-2"},d().createElement("p",{className:"text-xs text-gray-700"},(0,u.__)("This lightbox setting affects all galleries on your site, not just this one. To configure additional lightbox options, visit the Settings page.","nggallery")))))))),d().createElement("div",{className:"px-6 py-6 lg:px-8 lg:py-8 lg:sticky lg:top-8 lg:max-h-screen"},d().createElement(P.A,{previewMode:o,onPreviewModeChange:s,url:we,title:(0,u.__)("Gallery Preview","nggallery")}))),d().createElement(Oe.A,{isOpen:ie.open,onClose:function(){return oe({open:!1,title:"",isCreating:!1})},title:(0,u.__)("Create New Page","nggallery")},d().createElement("div",{className:"space-y-4"},d().createElement(R.A,{type:"text",id:"new_page_title",name:"new_page_title",value:ie.title,onChange:function(e){return oe(function(t){return Qe(Qe({},t),{},{title:e.target.value})})},label:(0,u.__)("Page Title","nggallery"),placeholder:(0,u.__)("Enter page title...","nggallery")}),d().createElement("div",{className:"bg-info-bg border border-info-border rounded-md p-3"},d().createElement("div",{className:"flex items-start"},d().createElement("div",{className:"py-0.5 flex-shrink-0"},d().createElement(i.F,{className:"h-4 w-4 text-gray-500 mt-0.5"})),d().createElement("div",{className:"py-1 ml-2"},d().createElement("p",{className:"text-xs text-gray-500"},(0,u.__)("A new page will be created with the gallery added immediately.","nggallery"))))),d().createElement("div",{className:"flex gap-2 justify-end"},d().createElement("button",{type:"button",className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-50",onClick:function(){return oe({open:!1,title:"",isCreating:!1})},disabled:ie.isCreating},(0,u.__)("Cancel","nggallery")),d().createElement("button",{type:"button",className:"px-4 py-2 text-sm font-medium text-white bg-green-500 border border-transparent rounded-md hover:bg-green-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-50 disabled:cursor-not-allowed inline-flex items-center",onClick:me,disabled:ie.isCreating||!ie.title.trim()},ie.isCreating?(0,u.__)("Creating...","nggallery"):(0,u.__)("Create Page","nggallery"))))))},He=function(e){var t=e.onCreateNewGallery;return d().createElement("div",{className:"bg-white rounded-lg shadow p-8 text-center"},d().createElement("div",{className:"space-y-4"},d().createElement("button",{onClick:t,className:"px-6 py-3 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors inline-flex items-center"},d().createElement("span",{className:"mr-2"},"+"),(0,u.__)("Create New Gallery","nggallery"))))},Je=function(e){var t=e.currentTab,a=e.selectedGalleryId,n=e.gallery,r=e.error,l=e.previewMode,i=e.onPreviewModeChange,o=e.onCreateNewGallery;if(!a)return d().createElement(He,{onCreateNewGallery:o});var c={previewMode:l,onPreviewModeChange:i};switch(t){case"images":return d().createElement(Ue,{gallery:n,error:r});case"customize":return d().createElement(de,(0,_.A)({gallery:n},c));case"settings":return d().createElement(Ve,(0,_.A)({gallery:n},c));default:return d().createElement("div",{className:"bg-white rounded-lg shadow p-8 text-center text-gray-500"},(0,u.__)("Please select a tab to continue.","nggallery"))}};var $e=function(e){var t=e.currentTab,a=e.setCurrentTab,n=e.error,l=e.selectedGalleryId,o=e.gallery,c=e.previewMode,s=e.handlePreviewModeChange,g=e.handleCreateNewGallery,u=e.handleNext,m=e.handleCancel,_=e.nextButtonText,y=e.navigateTo,h=e.isFirstTab,f=e.pageTitle,v=e.isEmbed,b=T().flushAllPendingSaves;return d().createElement("div",{className:"px-4 md:px-6 lg:px-8 py-4 md:py-6 pb-24"},!v&&d().createElement("div",{className:"mb-6 flex items-center gap-3"},d().createElement("button",{onClick:function(){return y("imagely","galleryList")},className:"flex items-center justify-center w-8 h-8 rounded-md hover:bg-gray-100 transition-colors"},d().createElement(i.Kj,{className:"w-5 h-5"})),d().createElement("h1",{className:"text-2xl font-semibold text-gray-900"},f)),d().createElement("div",{className:"bg-white shadow rounded-md pt-4 md:pt-6 lg:pt-8"},d().createElement(r.A,{currentTab:t,onTabChange:a,error:n,containerClassName:"",contentClassName:""},d().createElement(Je,{currentTab:t,selectedGalleryId:(null==l?void 0:l.toString())||null,gallery:o||null,error:n,previewMode:c,onPreviewModeChange:s,onCreateNewGallery:g}))),l&&d().createElement(p,{onNext:function(){b(),u()},onCancel:m,nextButtonText:_,isFirstTab:h}))};const Ze=function(){var e=(0,m.useState)("desktop"),t=(0,n.A)(e,2),a=t[0],r=t[1],i=(0,g.useDispatch)(c.E),p=(0,o.X)(),_=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).onComplete,t=(0,g.useSelect)(function(e){var t=e(c.E);return{currentTab:t.getCurrentTab(),selectedGalleryId:t.getCurrentId()}},[]),a=t.currentTab,n=t.selectedGalleryId,r=(0,g.useDispatch)(c.E),l=(0,E.iX)(n),i=l.data,o=l.error,d=l.isLoading;(0,m.useEffect)(function(){o&&n&&(403===(null==o?void 0:o.status)||"gallery_forbidden"===(null==o?void 0:o.code))&&(r.showNotice("error",(0,u.__)("You do not have permission to access this gallery","nggallery")),r.navigateTo("imagely","galleryList"))},[o,n,r]);var p=(0,m.useMemo)(function(){return(0,D.B)().map(function(e){return e.id})},[]),_=(0,m.useMemo)(function(){return p.indexOf(a)},[p,a]),y=0===_,h=_===p.length-1,f=(0,m.useCallback)(function(e){p.includes(e)&&r.setCurrentTab(e)},[r.setCurrentTab,p]),v=(0,m.useCallback)(function(e,t,a){r.navigateTo(e,t,a)},[r.navigateTo]),b=(0,m.useCallback)(function(){h?e&&e():f(p[_+1])},[h,_,p,f,e]),x=(0,m.useCallback)(function(){y||f(p[_-1])},[y,_,p,f]),w=(0,m.useCallback)(function(e){f(e)},[f]);return(0,m.useEffect)(function(){p.includes(a)||f("images")},[a,f,p]),(0,m.useEffect)(function(){var e=new URLSearchParams(window.location.search).get("id");if(!n&&!e){if(!(0,s.HN)())return void r.setActiveModal("licenseRequired",{action:"create new galleries"});r.setActiveModal("imageUploader",{})}},[n,r.setActiveModal]),{currentTab:a,currentTabIndex:_,gallery:i,error:(null==o?void 0:o.message)||null,selectedGalleryId:n,isFirstTab:y,isLastTab:h,isLoading:d,setCurrentTab:f,goToNextTab:b,goToPreviousTab:x,goToTab:w,navigateTo:v,tabIds:p}}({onComplete:function(){i.showNotice("success",(0,u.__)("Gallery created successfully","nggallery"))},enableTabValidation:!1}),y=_.currentTab,h=_.gallery,f=_.error,v=_.selectedGalleryId,b=_.setCurrentTab,x=_.isLoading,w=_.goToNextTab,C=_.goToPreviousTab,k=_.isFirstTab,A=_.isLastTab,N=_.navigateTo,S=(0,g.useSelect)(function(e){return{currentId:e(c.E).getCurrentId()}},[]).currentId;if(x&&v)return d().createElement(l.A,{size:"xl",text:(0,u.__)("Loading gallery...","nggallery")});var T=S?(0,u.__)("Edit Gallery","nggallery"):(0,u.__)("Add New Gallery","nggallery");return d().createElement(I,{initialGallery:h},d().createElement($e,{currentTab:y,setCurrentTab:b,error:f,selectedGalleryId:v,gallery:null!=h?h:null,previewMode:a,handlePreviewModeChange:function(e){r(e)},handleCreateNewGallery:function(){(0,s.HN)()?i.setActiveModal("imageUploader",{}):i.setActiveModal("licenseRequired",{action:"create new galleries"})},handleNext:function(){var e=Number(v||(null==h?void 0:h.gid)||(null==h?void 0:h.id));if(A){if(p.isEmbed&&p.onInsertGallery){if(Number.isFinite(e)&&e>0)try{p.onInsertGallery(e)}catch(e){console.error("Failed to insert gallery:",e)}return}var t=v||(null==h?void 0:h.gid)||(null==h?void 0:h.id),a=(null==h?void 0:h.name)||"",n=(null==h?void 0:h.pageid)||null;i.setActiveModal("gallerySuccess",{galleryId:t,galleryName:a,pageId:n})}else w()},handleCancel:function(){if(k)if(p.isEmbed&&p.onClose)try{p.onClose()}catch(e){console.error("Failed to close embed:",e)}else i.navigateTo("imagely","galleryList");else C()},nextButtonText:A?(0,u.__)("Update","nggallery"):(0,u.__)("Next step","nggallery"),navigateTo:N,isFirstTab:k,pageTitle:T,isEmbed:p.isEmbed}))}}}]);